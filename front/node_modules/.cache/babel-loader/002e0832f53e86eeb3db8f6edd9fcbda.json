{"ast":null,"code":"var _jsxFileName = \"C:\\\\SSAFY\\\\2nd semester\\\\S07P12D106\\\\front\\\\src\\\\components\\\\GatherRoomPageCom\\\\PlayMap.js\";\nimport React, { useRef, useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { SavePosX, selectPosX } from \"../../redux/slice/MapPosXSlice\";\nimport { SavePosY, selectPosY } from \"../../redux/slice/MapPosYSlice\";\nimport { selectUser } from \"../../redux/slice/UserSlice\";\nimport { useBeforeunload } from \"react-beforeunload\"; //라우터 이동 위한 클래스\n\nimport { useNavigate } from \"react-router-dom\"; //현재 방 정보 업데이트 함수\n\nimport { selectCntCivil } from \"../../redux/slice/CntCivilSlice\";\nimport { selectCntCop } from \"../../redux/slice/CntCopSlice\";\nimport { selectCntDoc } from \"../../redux/slice/CntDocSlice\";\nimport { selectCntLimit } from \"../../redux/slice/CntLimitSlice\";\nimport { selectCntMaf } from \"../../redux/slice/CntMafSlice\";\nimport { selectRoomTitle } from \"../../redux/slice/RoomTitleSlice\"; //리로딩되었는지 검사\n\nimport { selectChkRL, setChkRL } from \"../../redux/slice/CheckReloadSlice\";\nimport { selectCntCon, increCon, decreCon, setCon } from \"../../redux/slice/CntConSlice\"; //방 번호 필요\n//socktjs\n\nimport SockJS from \"sockjs-client\";\nimport { Client, Message } from \"@stomp/stompjs\"; //memo : 값을 메모이\n//callback : 함수를 메모이\n\nexport default function PlayMap() {\n  var _this = this;\n\n  //useNavigate 객체 생성\n  var navigate = useNavigate(); //redux 액션 호출\n\n  var dispatch = useDispatch(); //새로고침되었는지 확인\n\n  var reloadV = useSelector(function (state) {\n    return state.chkRL.value;\n  });\n  console.log(\"first place reloadV: \", reloadV); //시작 지점\n\n  var startYX = {\n    y: 650,\n    x: 300\n  }; //소켓 연결 시 구독한 주소 반환 저장\n\n  var subGatherRoom = null; //내 아이디\n\n  var myNickName = useSelector(selectUser).nickname; //처음 랜더링될 때 내 색을 지정\n\n  var myColor = \"#\" + Math.round(Math.random() * 0xffffff).toString(16); //현재 입장한 방 번호\n\n  var roooNum = 0; //구독할 주소\n\n  var sockADR = \"/sub/room/\".concat(roooNum);\n  var seatNum, seatChange, seatCnt, seatNothing; //게임 맵 크기\n\n  var mapSize = 700;\n  var charSize = 50;\n  var chairSize = 20; //맵 출력 테이블 위치, 사이즈\n\n  var table = {\n    tbTop: 100,\n    tbLeft: 200,\n    width: 300,\n    height: 300\n  }; //맵에 출력할 의자 위치 (top, left)\n\n  var chairs = [[40, 300], [40, 400], [160, 100], [300, 100], [450, 300], [450, 400], [160, 550], [300, 550]]; //포커싱 지정을 위한 변수\n\n  var mapFocus = useRef(); //div태그를 아바타 객체로 지정\n\n  var myChar; //키 입력 시 값 저장 배열, 움직였을 때 위치 저장, 속도\n\n  var keyPress = {},\n      pX = useRef(startYX.x),\n      pY = useRef(startYX.y),\n      speed = 5; //타 유저의 데이터 저장\n\n  var otherUserData = {},\n      //현재 몇번에 유저가 저장되어있는지 확인\n  remainNum = {\n    1: false,\n    2: false,\n    3: false,\n    4: false,\n    5: false,\n    6: false,\n    7: false\n  }; //웹소켓 선언 및 초기화\n  //SockJs + StompJs\n\n  var StompJs = require(\"@stomp/stompjs\");\n\n  var client2 = new StompJs.Client({\n    //websocket 주소만 입력 가능 * ws://, wss:// 로 시작\n    // brokerURL: \"https://i7d106.p.ssafy.io:8080/ws\",\n    connectHeaders: {},\n    // debug: function (str) {\n    //   console.log(str);\n    // },\n    reconnectDelay: 5000,\n    heartbeatIncoming: 4000,\n    heartbeatOutgoing: 4000\n  }); //**************************** */\n  //새로고침 시 페이지 전환\n  //**************************** */\n\n  var beforeReunloadValue = \"\";\n  useBeforeunload(function (e) {\n    if (beforeReunloadValue !== \"AlwaysCheck\") {\n      e.preventDefault();\n    }\n  }); //화면 호출 완료 시 새로고침된 상태라면 페이지 이동\n  //완전히 페이지를 떠날 때 실행\n\n  window.addEventListener(\"unload\", function () {\n    console.log(\"starting unload sequence\"); //새로고침 상태 저장\n    //저장된 데이터를 직접 수정\n\n    var SS = JSON.parse(sessionStorage.getItem(\"persist:root\"));\n    SS.chkRL = JSON.stringify({\n      value: true\n    });\n    sessionStorage.setItem(\"persist:root\", JSON.stringify(SS));\n    console.log(\"in unload: \", reloadV);\n    console.log(\"ended unload sequence\");\n    console.log(useSelector(function (state) {\n      return state.chkRL.value;\n    }));\n    navigate(\"/\");\n  });\n\n  client2.webSocketFactory = function () {\n    return new SockJS(\"https://i7d106.p.ssafy.io:8080/ws\");\n  };\n\n  client2.onConnect = function (frame) {\n    console.log(\"client2.onConnected start\"); //구독하는 곳\n\n    subGatherRoom = client2.subscribe(\"/sub/room/0\", onMessageReceived); //유저 방 입장, 새로고침 되지 않았을 때만 전송\n\n    console.log(\"before userJoin, reloadV: \", reloadV);\n\n    if (!reloadV) {\n      userJoin();\n    }\n\n    console.log(\"client2.onConnected ended\");\n  }; //소켓통신이 종료되었을 때 실행되는 코드\n\n\n  client2.onWebSocketClose = function () {}; //에러 발생시 실행되는 코드\n\n\n  client2.onStompError = function (frame) {\n    // Will be invoked in case of error encountered at Broker\n    // Bad login/passcode typically will cause an error\n    // Complaint brokers will set `message` header with a brief message. Body may contain details.\n    // Compliant brokers will terminate the connection after any error\n    console.log(\"Broker reported error: \" + frame.headers[\"message\"]);\n    console.log(\"Additional details: \" + frame.body);\n  }; //웹 소켓 코드 끝\n\n\n  var userJoin = function userJoin() {\n    console.log(\"userJoin start\");\n    if (document.getElementById(\"myCharacter\") == null) return;\n    document.getElementById(\"myCharacter\").style.background = myColor;\n    document.getElementById(\"myCharacter\").style.display = \"block\";\n    client2.publish({\n      destination: sockADR,\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        header: {\n          type: \"join\"\n        },\n        data: {\n          nickname: myNickName,\n          color: myColor\n        }\n      }),\n      skipContentLengthHeader: true\n    });\n    console.log(\"userJoin end\");\n  };\n\n  var onMessageReceived = function onMessageReceived(payload) {\n    var payloadData = JSON.parse(payload.body);\n    console.log(payloadData); //내가 송신한 정보는 처리 X\n\n    if (payloadData.data.nickname === myNickName) return; //타 유저 정보 처리\n\n    if (payloadData.header.type === \"join\") {\n      for (var i in remainNum) {\n        //빈 자리에 넣기\n        if (!remainNum[i]) {\n          remainNum[i] = true; //색변경 => 보이기\n\n          otherUserData[payloadData.data.nickname] = {\n            color: payloadData.data.color,\n            num: i\n          };\n          document.getElementById(\"char\".concat(i)).style.left = startYX.x;\n          document.getElementById(\"char\".concat(i)).style.top = startYX.y;\n          document.getElementById(\"char\".concat(i)).style.background = payloadData.data.color;\n          document.getElementById(\"char\".concat(i)).style.display = \"block\";\n          document.getElementById(\"char\".concat(i, \"Name\")).innerText = payloadData.data.nickname;\n          break;\n        }\n      }\n    } else if (payloadData.header.type === \"leave\") {\n      var userNum = otherUserData[payloadData.data.nickname].num;\n      remainNum[userNum] = false;\n      document.getElementById(\"char\".concat(userNum)).style.display = \"none\";\n      document.getElementById(\"char\".concat(userNum, \"Name\")).innerText = \"\";\n    } //캐릭터 움직일 때\n    else if (payloadData.header.type === \"interact\") {\n      //위치 변경\n      document.getElementById(\"char\".concat(otherUserData[payloadData.data.nickname].num)).style.left = payloadData.data.x + \"px\";\n      document.getElementById(\"char\".concat(otherUserData[payloadData.data.nickname].num)).style.top = payloadData.data.y + \"px\";\n      otherUserData[payloadData.data.nickname][\"y\"] = payloadData.data.y;\n      otherUserData[payloadData.data.nickname][\"x\"] = payloadData.data.x; //의자에 앉았을 때 해당 의자 비활성화\n\n      if (payloadData.data.status === \"ready\") {} //의자 일어섰을 때 해당 의자 활성화\n      else if (payloadData.data.status === \"stand\") {}\n    } else if (payloadData.header.type === \"start\") {\n      console.log(payloadData.data);\n    } else if (payloadData.header.type === \"setting\") {\n      console.log(payloadData.data);\n    }\n  }; //웹소켓 코드 끝\n  //첫 렌더링될 때만 입력받는 input태그로 focus\n\n\n  useEffect(function () {\n    console.log(\"myChar rendered\");\n    myChar = document.getElementById(\"myCharacter\");\n    console.log(\"check reloadV before client2.activate(): \", reloadV);\n    mapFocus.current.focus();\n    client2.activate(); //만약 새로고침이 되었다면\n\n    console.log(\"before navigate, reloadV :\", reloadV);\n\n    if (reloadV) {\n      // dispatch(setChkRL(false));\n      // client2.publish({\n      //   destination: \"/sub/room/0\",\n      //   headers: { \"content-type\": \"application/json\" },\n      //   body: JSON.stringify({\n      //     header: {\n      //       type: \"leave\",\n      //     },\n      //     data: {\n      //       nickname: myNickName,\n      //     },\n      //   }),\n      //   skipContentLengthHeader: true,\n      // });\n      // client2.deactivate();\n      navigate(\"/\");\n    } //랜더링 종료 시 인터벌 종료\n\n\n    return function () {\n      console.log(\"returned\");\n      clearInterval(inputCheck);\n      clearInterval(sendMyPos); //랜더링 종료될 때 leave 신호 전송\n    };\n  }, []); //약 60fps로 위치 정보 전송, 움직일 때만 전송\n\n  var sendMyPos = setInterval(function () {\n    if (client2) {\n      if (keyPress[87] || keyPress[83] || keyPress[65] || keyPress[68]) {\n        client2.publish({\n          destination: sockADR,\n          headers: {\n            \"content-type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            header: {\n              type: \"interact\"\n            },\n            data: {\n              nickname: myNickName,\n              status: \"move\",\n              chairNum: null,\n              x: pX.current,\n              y: pY.current\n            }\n          }),\n          skipContentLengthHeader: true\n        });\n      }\n    }\n  }, 16); //부드러운 움직임을 위한 변수 선언\n  //일정 초마다 키 입력 확인\n\n  var inputCheck = setInterval(function () {\n    if (keyPress[87]) pY.current -= speed;\n    if (keyPress[83]) pY.current += speed; // down - s\n\n    if (keyPress[65]) pX.current -= speed; // left - a\n\n    if (keyPress[68]) pX.current += speed; //테이블 충돌 감지\n\n    if (pX.current < table.tbLeft + table.width && pX.current + charSize > table.tbLeft && pY.current < table.tbTop + table.height && charSize + pY.current > table.tbTop) {\n      if (keyPress[87]) pY.current += speed;\n      if (keyPress[83]) pY.current -= speed; // down - s\n\n      if (keyPress[65]) pX.current += speed; // left - a\n\n      if (keyPress[68]) pX.current -= speed;\n    }\n\n    seatNum = -1; //의자 충돌 감지\n\n    for (var i = 0; i < 8; i++) {\n      if (chairs[i][1] < pX.current + charSize && chairs[i][1] + chairSize > pX.current && chairs[i][0] < charSize + pY.current && chairs[i][0] + chairSize > pY.current) {\n        seatNum = i; //자리에 앉았을 시 소켓으로 준비 완료 전송\n\n        if (seatNum !== seatChange) {\n          seatNothing = true;\n          document.getElementById(\"inputTag\").value = \"준비 완료\";\n          console.log(\"SeatNum: \", seatNum);\n          console.log(\"send ready\");\n          seatChange = i;\n          client2.publish({\n            destination: \"/sub/room/0\",\n            headers: {\n              \"content-type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              header: {\n                type: \"interact\"\n              },\n              data: {\n                nickname: myNickName,\n                status: \"ready\",\n                chairNum: seatChange,\n                y: pY.current,\n                x: pX.current\n              }\n            }),\n            skipContentLengthHeader: true\n          });\n        } //자리와 이전 자리가 같을 시\n\n      }\n    } //자리에서 벗어났을 시 소켓으로 준비 완료 해제 전송\n\n\n    if (seatNum === -1 && seatNothing === true) {\n      console.log(\"send not ready\");\n      document.getElementById(\"inputTag\").value = \"준비 중\";\n      seatCnt = 0;\n      seatNothing = false;\n      client2.publish({\n        destination: \"/sub/room/0\",\n        headers: {\n          \"content-type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          header: {\n            type: \"interact\"\n          },\n          data: {\n            nickname: myNickName,\n            status: \"stand\",\n            chairNum: -1,\n            y: pY.current,\n            x: pX.current\n          }\n        }),\n        skipContentLengthHeader: true\n      });\n    }\n\n    if (pY.current < 0) //외부 벽 충돌 감지\n      pY.current = 0;\n    if (pY.current >= mapSize - charSize) pY.current = mapSize - charSize;\n    if (pX.current < 0) pX.current = 0;\n    if (pX.current >= mapSize - charSize) pX.current = mapSize - charSize; //캐릭터 좌표 최신화\n\n    myChar.style.left = pX.current + \"px\";\n    myChar.style.top = pY.current + \"px\";\n  }, 16); //맵 클릭 시 입력 포커싱 지정\n\n  var changeFocus = function changeFocus() {\n    mapFocus.current.focus();\n  }; //키 눌렀을 때 해당 값 true로 변환\n\n\n  var handleKeyDown = function handleKeyDown(e) {\n    keyPress[e.keyCode.toString()] = true;\n  }; //키 땠을 때 해당 값 false로 변환\n\n\n  var handleKeyUp = function handleKeyUp(e) {\n    if (keyPress[87] || keyPress[83] || keyPress[65] || keyPress[68]) {\n      client2.publish({\n        destination: sockADR,\n        headers: {\n          \"content-type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          header: {\n            type: \"interact2\"\n          },\n          data: {\n            nickname: myNickName,\n            status: \"move\",\n            chairNum: null,\n            x: pX.current,\n            y: pY.current\n          }\n        }),\n        skipContentLengthHeader: true\n      });\n    }\n\n    keyPress[e.keyCode.toString()] = false;\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: \"relative\",\n      width: \"100%\",\n      height: \"100%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      console.log(reloadV);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 7\n    }\n  }, \"reLoadV\\uAC12 \\uD655\\uC778\"), /*#__PURE__*/React.createElement(\"input\", {\n    id: \"inputTag\",\n    value: \"\\uC900\\uBE44 \\uC911\",\n    type: \"text\",\n    ref: mapFocus,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    readOnly: true,\n    style: {\n      border: \"none\",\n      cursor: \"default\",\n      margin: \"0\",\n      position: \"absolute\",\n      top: 5,\n      left: 5\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"map\",\n    onClick: changeFocus,\n    style: {\n      width: mapSize,\n      height: mapSize,\n      background: \"orange\",\n      position: \"relative\",\n      left: 0,\n      top: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"table\",\n    style: {\n      width: table.width,\n      height: table.height,\n      left: table.tbLeft,\n      top: table.tbTop,\n      background: \"green\",\n      position: \"absolute\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 496,\n      columnNumber: 9\n    }\n  }), chairs.map(function (e, idx) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: idx,\n      id: \"chair\" + idx,\n      style: {\n        top: e[0],\n        left: e[1],\n        height: chairSize,\n        width: chairSize,\n        background: \"blue\",\n        position: \"absolute\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 13\n      }\n    });\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myCharacter\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      position: \"absolute\",\n      display: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 534,\n      columnNumber: 11\n    }\n  }, myNickName)), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char1\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      background: \"red\",\n      position: \"absolute\",\n      display: \"none\",\n      left: startYX.x,\n      top: startYX.y\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 540,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char1Name\",\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char2\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      background: \"red\",\n      position: \"absolute\",\n      display: \"none\",\n      left: startYX.x,\n      top: startYX.y\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char2Name\",\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 571,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char3\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      background: \"red\",\n      position: \"absolute\",\n      display: \"none\",\n      left: startYX.x,\n      top: startYX.y\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char3Name\",\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 589,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char4\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      background: \"red\",\n      position: \"absolute\",\n      display: \"none\",\n      left: startYX.x,\n      top: startYX.y\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char4Name\",\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 607,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char5\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      background: \"red\",\n      position: \"absolute\",\n      display: \"none\",\n      left: startYX.x,\n      top: startYX.y\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 612,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char5Name\",\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 625,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char6\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      background: \"red\",\n      position: \"absolute\",\n      display: \"none\",\n      left: startYX.x,\n      top: startYX.y\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 630,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char6Name\",\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 643,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char7\",\n    style: {\n      margin: \"0px\",\n      width: charSize,\n      height: charSize,\n      background: \"red\",\n      position: \"absolute\",\n      display: \"none\",\n      left: startYX.x,\n      top: startYX.y\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 648,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"char7Name\",\n    style: {\n      top: -20,\n      width: 200,\n      position: \"absolute\",\n      left: -100 + 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 661,\n      columnNumber: 11\n    }\n  }))));\n}","map":{"version":3,"names":["React","useRef","useEffect","useState","useSelector","useDispatch","SavePosX","selectPosX","SavePosY","selectPosY","selectUser","useBeforeunload","useNavigate","selectCntCivil","selectCntCop","selectCntDoc","selectCntLimit","selectCntMaf","selectRoomTitle","selectChkRL","setChkRL","selectCntCon","increCon","decreCon","setCon","SockJS","Client","Message","PlayMap","navigate","dispatch","reloadV","state","chkRL","value","console","log","startYX","y","x","subGatherRoom","myNickName","nickname","myColor","Math","round","random","toString","roooNum","sockADR","seatNum","seatChange","seatCnt","seatNothing","mapSize","charSize","chairSize","table","tbTop","tbLeft","width","height","chairs","mapFocus","myChar","keyPress","pX","pY","speed","otherUserData","remainNum","StompJs","require","client2","connectHeaders","reconnectDelay","heartbeatIncoming","heartbeatOutgoing","beforeReunloadValue","e","preventDefault","window","addEventListener","SS","JSON","parse","sessionStorage","getItem","stringify","setItem","webSocketFactory","onConnect","frame","subscribe","onMessageReceived","userJoin","onWebSocketClose","onStompError","headers","body","document","getElementById","style","background","display","publish","destination","header","type","data","color","skipContentLengthHeader","payload","payloadData","i","num","left","top","innerText","userNum","status","current","focus","activate","clearInterval","inputCheck","sendMyPos","setInterval","chairNum","changeFocus","handleKeyDown","keyCode","handleKeyUp","position","border","cursor","margin","map","idx"],"sources":["C:/SSAFY/2nd semester/S07P12D106/front/src/components/GatherRoomPageCom/PlayMap.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { SavePosX, selectPosX } from \"../../redux/slice/MapPosXSlice\";\r\nimport { SavePosY, selectPosY } from \"../../redux/slice/MapPosYSlice\";\r\nimport { selectUser } from \"../../redux/slice/UserSlice\";\r\nimport { useBeforeunload } from \"react-beforeunload\";\r\n\r\n//라우터 이동 위한 클래스\r\nimport { useNavigate } from \"react-router-dom\";\r\n//현재 방 정보 업데이트 함수\r\nimport { selectCntCivil } from \"../../redux/slice/CntCivilSlice\";\r\nimport { selectCntCop } from \"../../redux/slice/CntCopSlice\";\r\nimport { selectCntDoc } from \"../../redux/slice/CntDocSlice\";\r\nimport { selectCntLimit } from \"../../redux/slice/CntLimitSlice\";\r\nimport { selectCntMaf } from \"../../redux/slice/CntMafSlice\";\r\nimport { selectRoomTitle } from \"../../redux/slice/RoomTitleSlice\";\r\n\r\n//리로딩되었는지 검사\r\nimport { selectChkRL, setChkRL } from \"../../redux/slice/CheckReloadSlice\";\r\nimport { selectCntCon, increCon, decreCon, setCon } from \"../../redux/slice/CntConSlice\";\r\n//방 번호 필요\r\n\r\n//socktjs\r\nimport SockJS from \"sockjs-client\";\r\n\r\nimport { Client, Message } from \"@stomp/stompjs\";\r\n\r\n//memo : 값을 메모이\r\n//callback : 함수를 메모이\r\nexport default function PlayMap() {\r\n  //useNavigate 객체 생성\r\n  const navigate = useNavigate();\r\n\r\n  //redux 액션 호출\r\n  const dispatch = useDispatch();\r\n\r\n  //새로고침되었는지 확인\r\n  let reloadV = useSelector((state) => state.chkRL.value);\r\n  console.log(\"first place reloadV: \", reloadV);\r\n  //시작 지점\r\n  let startYX = { y: 650, x: 300 };\r\n\r\n  //소켓 연결 시 구독한 주소 반환 저장\r\n  let subGatherRoom = null;\r\n\r\n  //내 아이디\r\n  const myNickName = useSelector(selectUser).nickname;\r\n\r\n  //처음 랜더링될 때 내 색을 지정\r\n  const myColor = \"#\" + Math.round(Math.random() * 0xffffff).toString(16);\r\n\r\n  //현재 입장한 방 번호\r\n  const roooNum = 0;\r\n\r\n  //구독할 주소\r\n  const sockADR = `/sub/room/${roooNum}`;\r\n\r\n  let seatNum, seatChange, seatCnt, seatNothing;\r\n\r\n  //게임 맵 크기\r\n  const mapSize = 700;\r\n  const charSize = 50;\r\n  const chairSize = 20;\r\n\r\n  //맵 출력 테이블 위치, 사이즈\r\n  const table = {\r\n    tbTop: 100,\r\n    tbLeft: 200,\r\n    width: 300,\r\n    height: 300,\r\n  };\r\n\r\n  //맵에 출력할 의자 위치 (top, left)\r\n  const chairs = [\r\n    [40, 300],\r\n    [40, 400],\r\n    [160, 100],\r\n    [300, 100],\r\n    [450, 300],\r\n    [450, 400],\r\n    [160, 550],\r\n    [300, 550],\r\n  ];\r\n\r\n  //포커싱 지정을 위한 변수\r\n  const mapFocus = useRef();\r\n\r\n  //div태그를 아바타 객체로 지정\r\n  let myChar;\r\n\r\n  //키 입력 시 값 저장 배열, 움직였을 때 위치 저장, 속도\r\n  let keyPress = {},\r\n    pX = useRef(startYX.x),\r\n    pY = useRef(startYX.y),\r\n    speed = 5;\r\n\r\n  //타 유저의 데이터 저장\r\n  let otherUserData = {},\r\n    //현재 몇번에 유저가 저장되어있는지 확인\r\n    remainNum = { 1: false, 2: false, 3: false, 4: false, 5: false, 6: false, 7: false };\r\n\r\n  //웹소켓 선언 및 초기화\r\n  //SockJs + StompJs\r\n  var StompJs = require(\"@stomp/stompjs\");\r\n\r\n  const client2 = new StompJs.Client({\r\n    //websocket 주소만 입력 가능 * ws://, wss:// 로 시작\r\n    // brokerURL: \"https://i7d106.p.ssafy.io:8080/ws\",\r\n    connectHeaders: {},\r\n    // debug: function (str) {\r\n    //   console.log(str);\r\n    // },\r\n    reconnectDelay: 5000,\r\n    heartbeatIncoming: 4000,\r\n    heartbeatOutgoing: 4000,\r\n  });\r\n\r\n  //**************************** */\r\n  //새로고침 시 페이지 전환\r\n  //**************************** */\r\n  let beforeReunloadValue = \"\";\r\n  useBeforeunload((e) => {\r\n    if (beforeReunloadValue !== \"AlwaysCheck\") {\r\n      e.preventDefault();\r\n    }\r\n  });\r\n  //화면 호출 완료 시 새로고침된 상태라면 페이지 이동\r\n\r\n  //완전히 페이지를 떠날 때 실행\r\n  window.addEventListener(\"unload\", () => {\r\n    console.log(\"starting unload sequence\");\r\n    //새로고침 상태 저장\r\n\r\n    //저장된 데이터를 직접 수정\r\n    let SS = JSON.parse(sessionStorage.getItem(\"persist:root\"));\r\n    SS.chkRL = JSON.stringify({ value: true });\r\n    sessionStorage.setItem(\"persist:root\", JSON.stringify(SS));\r\n\r\n    console.log(\"in unload: \", reloadV);\r\n    console.log(\"ended unload sequence\");\r\n\r\n    console.log(useSelector((state) => state.chkRL.value));\r\n    navigate(\"/\");\r\n  });\r\n\r\n  client2.webSocketFactory = () => {\r\n    return new SockJS(\"https://i7d106.p.ssafy.io:8080/ws\");\r\n  };\r\n\r\n  client2.onConnect = (frame) => {\r\n    console.log(\"client2.onConnected start\");\r\n    //구독하는 곳\r\n    subGatherRoom = client2.subscribe(\"/sub/room/0\", onMessageReceived);\r\n\r\n    //유저 방 입장, 새로고침 되지 않았을 때만 전송\r\n    console.log(\"before userJoin, reloadV: \", reloadV);\r\n    if (!reloadV) {\r\n      userJoin();\r\n    }\r\n\r\n    console.log(\"client2.onConnected ended\");\r\n  };\r\n\r\n  //소켓통신이 종료되었을 때 실행되는 코드\r\n  client2.onWebSocketClose = () => {};\r\n\r\n  //에러 발생시 실행되는 코드\r\n  client2.onStompError = function (frame) {\r\n    // Will be invoked in case of error encountered at Broker\r\n    // Bad login/passcode typically will cause an error\r\n    // Complaint brokers will set `message` header with a brief message. Body may contain details.\r\n    // Compliant brokers will terminate the connection after any error\r\n    console.log(\"Broker reported error: \" + frame.headers[\"message\"]);\r\n    console.log(\"Additional details: \" + frame.body);\r\n  };\r\n\r\n  //웹 소켓 코드 끝\r\n\r\n  const userJoin = () => {\r\n    console.log(\"userJoin start\");\r\n    if (document.getElementById(\"myCharacter\") == null) return;\r\n\r\n    document.getElementById(\"myCharacter\").style.background = myColor;\r\n    document.getElementById(\"myCharacter\").style.display = \"block\";\r\n    client2.publish({\r\n      destination: sockADR,\r\n      headers: { \"content-type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        header: {\r\n          type: \"join\",\r\n        },\r\n        data: {\r\n          nickname: myNickName,\r\n          color: myColor,\r\n        },\r\n      }),\r\n      skipContentLengthHeader: true,\r\n    });\r\n    console.log(\"userJoin end\");\r\n  };\r\n\r\n  const onMessageReceived = (payload) => {\r\n    var payloadData = JSON.parse(payload.body);\r\n    console.log(payloadData);\r\n    //내가 송신한 정보는 처리 X\r\n    if (payloadData.data.nickname === myNickName) return;\r\n\r\n    //타 유저 정보 처리\r\n    if (payloadData.header.type === \"join\") {\r\n      for (let i in remainNum) {\r\n        //빈 자리에 넣기\r\n        if (!remainNum[i]) {\r\n          remainNum[i] = true;\r\n          //색변경 => 보이기\r\n          otherUserData[payloadData.data.nickname] = { color: payloadData.data.color, num: i };\r\n          document.getElementById(`char${i}`).style.left = startYX.x;\r\n          document.getElementById(`char${i}`).style.top = startYX.y;\r\n\r\n          document.getElementById(`char${i}`).style.background = payloadData.data.color;\r\n          document.getElementById(`char${i}`).style.display = \"block\";\r\n          document.getElementById(`char${i}Name`).innerText = payloadData.data.nickname;\r\n          break;\r\n        }\r\n      }\r\n    } else if (payloadData.header.type === \"leave\") {\r\n      let userNum = otherUserData[payloadData.data.nickname].num;\r\n      remainNum[userNum] = false;\r\n      document.getElementById(`char${userNum}`).style.display = \"none\";\r\n      document.getElementById(`char${userNum}Name`).innerText = \"\";\r\n    }\r\n    //캐릭터 움직일 때\r\n    else if (payloadData.header.type === \"interact\") {\r\n      //위치 변경\r\n      document.getElementById(`char${otherUserData[payloadData.data.nickname].num}`).style.left =\r\n        payloadData.data.x + \"px\";\r\n      document.getElementById(`char${otherUserData[payloadData.data.nickname].num}`).style.top =\r\n        payloadData.data.y + \"px\";\r\n      otherUserData[payloadData.data.nickname][\"y\"] = payloadData.data.y;\r\n      otherUserData[payloadData.data.nickname][\"x\"] = payloadData.data.x;\r\n\r\n      //의자에 앉았을 때 해당 의자 비활성화\r\n      if (payloadData.data.status === \"ready\") {\r\n      }\r\n      //의자 일어섰을 때 해당 의자 활성화\r\n      else if (payloadData.data.status === \"stand\") {\r\n      }\r\n    } else if (payloadData.header.type === \"start\") {\r\n      console.log(payloadData.data);\r\n    } else if (payloadData.header.type === \"setting\") {\r\n      console.log(payloadData.data);\r\n    }\r\n  };\r\n\r\n  //웹소켓 코드 끝\r\n\r\n  //첫 렌더링될 때만 입력받는 input태그로 focus\r\n  useEffect(() => {\r\n    console.log(\"myChar rendered\");\r\n    myChar = document.getElementById(\"myCharacter\");\r\n\r\n    console.log(\"check reloadV before client2.activate(): \", reloadV);\r\n    mapFocus.current.focus();\r\n\r\n    client2.activate();\r\n\r\n    //만약 새로고침이 되었다면\r\n    console.log(\"before navigate, reloadV :\", reloadV);\r\n    if (reloadV) {\r\n      // dispatch(setChkRL(false));\r\n      // client2.publish({\r\n      //   destination: \"/sub/room/0\",\r\n      //   headers: { \"content-type\": \"application/json\" },\r\n      //   body: JSON.stringify({\r\n      //     header: {\r\n      //       type: \"leave\",\r\n      //     },\r\n      //     data: {\r\n      //       nickname: myNickName,\r\n      //     },\r\n      //   }),\r\n\r\n      //   skipContentLengthHeader: true,\r\n      // });\r\n      // client2.deactivate();\r\n      navigate(\"/\");\r\n    }\r\n\r\n    //랜더링 종료 시 인터벌 종료\r\n    return () => {\r\n      console.log(\"returned\");\r\n      clearInterval(inputCheck);\r\n      clearInterval(sendMyPos);\r\n      //랜더링 종료될 때 leave 신호 전송\r\n    };\r\n  }, []);\r\n\r\n  //약 60fps로 위치 정보 전송, 움직일 때만 전송\r\n  const sendMyPos = setInterval(() => {\r\n    if (client2) {\r\n      if (keyPress[87] || keyPress[83] || keyPress[65] || keyPress[68]) {\r\n        client2.publish({\r\n          destination: sockADR,\r\n          headers: { \"content-type\": \"application/json\" },\r\n          body: JSON.stringify({\r\n            header: {\r\n              type: \"interact\",\r\n            },\r\n            data: {\r\n              nickname: myNickName,\r\n              status: \"move\",\r\n              chairNum: null,\r\n              x: pX.current,\r\n              y: pY.current,\r\n            },\r\n          }),\r\n          skipContentLengthHeader: true,\r\n        });\r\n      }\r\n    }\r\n  }, 16);\r\n\r\n  //부드러운 움직임을 위한 변수 선언\r\n  //일정 초마다 키 입력 확인\r\n  const inputCheck = setInterval(() => {\r\n    if (keyPress[87]) pY.current -= speed;\r\n    if (keyPress[83]) pY.current += speed; // down - s\r\n    if (keyPress[65]) pX.current -= speed; // left - a\r\n    if (keyPress[68]) pX.current += speed;\r\n\r\n    //테이블 충돌 감지\r\n    if (\r\n      pX.current < table.tbLeft + table.width &&\r\n      pX.current + charSize > table.tbLeft &&\r\n      pY.current < table.tbTop + table.height &&\r\n      charSize + pY.current > table.tbTop\r\n    ) {\r\n      if (keyPress[87]) pY.current += speed;\r\n      if (keyPress[83]) pY.current -= speed; // down - s\r\n      if (keyPress[65]) pX.current += speed; // left - a\r\n      if (keyPress[68]) pX.current -= speed;\r\n    }\r\n\r\n    seatNum = -1;\r\n    //의자 충돌 감지\r\n    for (let i = 0; i < 8; i++) {\r\n      if (\r\n        chairs[i][1] < pX.current + charSize &&\r\n        chairs[i][1] + chairSize > pX.current &&\r\n        chairs[i][0] < charSize + pY.current &&\r\n        chairs[i][0] + chairSize > pY.current\r\n      ) {\r\n        seatNum = i;\r\n        //자리에 앉았을 시 소켓으로 준비 완료 전송\r\n        if (seatNum !== seatChange) {\r\n          seatNothing = true;\r\n          document.getElementById(\"inputTag\").value = \"준비 완료\";\r\n          console.log(\"SeatNum: \", seatNum);\r\n          console.log(\"send ready\");\r\n          seatChange = i;\r\n\r\n          client2.publish({\r\n            destination: \"/sub/room/0\",\r\n            headers: { \"content-type\": \"application/json\" },\r\n            body: JSON.stringify({\r\n              header: {\r\n                type: \"interact\",\r\n              },\r\n              data: {\r\n                nickname: myNickName,\r\n                status: \"ready\",\r\n                chairNum: seatChange,\r\n                y: pY.current,\r\n                x: pX.current,\r\n              },\r\n            }),\r\n            skipContentLengthHeader: true,\r\n          });\r\n        }\r\n        //자리와 이전 자리가 같을 시\r\n      }\r\n    }\r\n    //자리에서 벗어났을 시 소켓으로 준비 완료 해제 전송\r\n    if (seatNum === -1 && seatNothing === true) {\r\n      console.log(\"send not ready\");\r\n      document.getElementById(\"inputTag\").value = \"준비 중\";\r\n      seatCnt = 0;\r\n      seatNothing = false;\r\n\r\n      client2.publish({\r\n        destination: \"/sub/room/0\",\r\n        headers: { \"content-type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          header: {\r\n            type: \"interact\",\r\n          },\r\n          data: {\r\n            nickname: myNickName,\r\n            status: \"stand\",\r\n            chairNum: -1,\r\n            y: pY.current,\r\n            x: pX.current,\r\n          },\r\n        }),\r\n        skipContentLengthHeader: true,\r\n      });\r\n    }\r\n    if (pY.current < 0)\r\n      //외부 벽 충돌 감지\r\n      pY.current = 0;\r\n    if (pY.current >= mapSize - charSize) pY.current = mapSize - charSize;\r\n    if (pX.current < 0) pX.current = 0;\r\n    if (pX.current >= mapSize - charSize) pX.current = mapSize - charSize;\r\n\r\n    //캐릭터 좌표 최신화\r\n    myChar.style.left = pX.current + \"px\";\r\n    myChar.style.top = pY.current + \"px\";\r\n  }, 16);\r\n\r\n  //맵 클릭 시 입력 포커싱 지정\r\n  const changeFocus = () => {\r\n    mapFocus.current.focus();\r\n  };\r\n\r\n  //키 눌렀을 때 해당 값 true로 변환\r\n  const handleKeyDown = (e) => {\r\n    keyPress[e.keyCode.toString()] = true;\r\n  };\r\n  //키 땠을 때 해당 값 false로 변환\r\n  const handleKeyUp = (e) => {\r\n    if (keyPress[87] || keyPress[83] || keyPress[65] || keyPress[68]) {\r\n      client2.publish({\r\n        destination: sockADR,\r\n        headers: { \"content-type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          header: {\r\n            type: \"interact2\",\r\n          },\r\n          data: {\r\n            nickname: myNickName,\r\n            status: \"move\",\r\n            chairNum: null,\r\n            x: pX.current,\r\n            y: pY.current,\r\n          },\r\n        }),\r\n        skipContentLengthHeader: true,\r\n      });\r\n    }\r\n    keyPress[e.keyCode.toString()] = false;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: \"relative\",\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n      }}\r\n    >\r\n      <button\r\n        onClick={() => {\r\n          console.log(reloadV);\r\n        }}\r\n      >\r\n        reLoadV값 확인\r\n      </button>\r\n      <input\r\n        id='inputTag'\r\n        value='준비 중'\r\n        type='text'\r\n        ref={mapFocus}\r\n        onKeyDown={handleKeyDown}\r\n        onKeyUp={handleKeyUp}\r\n        readOnly\r\n        style={{\r\n          border: \"none\",\r\n          cursor: \"default\",\r\n          margin: \"0\",\r\n          position: \"absolute\",\r\n          top: 5,\r\n          left: 5,\r\n        }}\r\n      />\r\n      <div\r\n        id='map'\r\n        onClick={changeFocus}\r\n        style={{\r\n          width: mapSize,\r\n          height: mapSize,\r\n          background: \"orange\",\r\n          position: \"relative\",\r\n          left: 0,\r\n          top: 0,\r\n        }}\r\n      >\r\n        <div\r\n          id='table'\r\n          style={{\r\n            width: table.width,\r\n            height: table.height,\r\n            left: table.tbLeft,\r\n            top: table.tbTop,\r\n            background: \"green\",\r\n            position: \"absolute\",\r\n          }}\r\n        ></div>\r\n\r\n        {chairs.map((e, idx) => {\r\n          return (\r\n            <div\r\n              key={idx}\r\n              id={\"chair\" + idx}\r\n              style={{\r\n                top: e[0],\r\n                left: e[1],\r\n                height: chairSize,\r\n                width: chairSize,\r\n                background: \"blue\",\r\n                position: \"absolute\",\r\n              }}\r\n            ></div>\r\n          );\r\n        })}\r\n        <div\r\n          id='myCharacter'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n          }}\r\n        >\r\n          <div style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}>\r\n            {myNickName}\r\n          </div>\r\n        </div>\r\n        {/* 다른 유저의 캐릭터 작성 */}\r\n\r\n        <div\r\n          id='char1'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char1Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char2'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char2Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char3'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char3Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char4'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char4Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char5'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char5Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char6'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char6Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char7'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char7Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}