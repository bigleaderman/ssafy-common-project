{"ast":null,"code":"var _jsxFileName = \"C:\\\\SSAFY\\\\2nd semester\\\\S07P12D106\\\\front\\\\src\\\\components\\\\GatherRoomPageCom\\\\PlayMap.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { selectColor, selectX, selectY, setColor, setX, setY } from \"../../redux/slice/CharSlice\";\nimport { selectUser } from \"../../redux/slice/UserSlice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PlayMap(props) {\n  _s();\n\n  //redux 액션 호출\n  const dispatch = useDispatch(); //시작 지점\n\n  let startYX = {\n    y: 600,\n    x: 300\n  }; //소켓 연결 시 구독한 주소 반환 저장\n\n  let subGatherRoom = null; //내 아이디\n\n  const myNickName = useSelector(selectUser).nickname; //처음 랜더링될 때 내 색을 지정\n\n  let myColor = useSelector(selectColor);\n\n  if (myColor == undefined) {\n    myColor = \"#\" + Math.round(Math.random() * 0xffffff).toString(16);\n    dispatch(setColor(myColor));\n  }\n\n  let seatNum, seatChange, seatCnt, seatNothing; //게임 맵 크기\n\n  const mapSize = 700; //맵 출력 테이블 위치, 사이즈\n\n  const table = {\n    tbTop: 100,\n    tbLeft: 200,\n    width: 300,\n    height: 300\n  }; //맵에 출력할 의자 위치 (top, left)\n\n  const chairs = [[40, 300], [40, 400], [160, 100], [300, 100], [450, 300], [450, 400], [160, 550], [300, 550]];\n  const charSize = 50;\n  const chairSize = 20;\n  let chairSeatState = {\n    1: false,\n    2: false,\n    3: false,\n    4: false,\n    5: false,\n    6: false,\n    7: false\n  }; //포커싱 지정을 위한 변수\n\n  const mapFocus = useRef(); //div태그를 아바타 객체로 지정\n\n  const myChar = useRef(document.getElementById(\"myCharacter\")); //키 입력 시 값 저장 배열, 움직였을 때 위치 저장, 속도\n\n  let keyPress = {},\n      pX = useRef(useSelector(selectX)),\n      pY = useRef(useSelector(selectY)),\n      speed = 5;\n  console.log(pX.current);\n  console.log(pY.current); //타 유저의 데이터 저장\n\n  let otherUserData = {},\n      //현재 몇번에 유저가 저장되어있는지 확인\n  remainNum = {\n    1: false,\n    2: false,\n    3: false,\n    4: false,\n    5: false,\n    6: false,\n    7: false\n  };\n  const sockADR = props.sockADR;\n  const client2 = props.client2;\n\n  const userJoin = () => {\n    console.log(\"userJoin start\");\n    if (document.getElementById(\"myCharacter\") == null) return;\n    client2.publish({\n      destination: sockADR,\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        header: {\n          type: \"join\"\n        },\n        data: {\n          nickname: myNickName,\n          color: myColor,\n          x: pX.current,\n          y: pY.current\n        }\n      }),\n      skipContentLengthHeader: true\n    });\n    console.log(\"userJoin end\");\n  }; //**************************************** */\n  //** 소켓으로 정보를 받았을 때 처리 함수 **\n  //**************************************** */\n\n\n  props.client.onConnect = frame => {\n    console.log(\"2. run onConnect in PlayMap\"); //구독 및 연결 시 join 소켓 전송\n\n    console.log(\"onMessageReceived: \", onMessageReceived);\n    subGatherRoom = props.client.subscribe(\"/sub/room/0\", onMessageReceived); //userJoin()\n\n    console.log(\"ended onConnect\");\n  };\n\n  const onMessageReceived = payload => {\n    console.log(\"payload: \", payload);\n    var payloadData = JSON.parse(payload.body);\n    console.log(payloadData); //내가 송신한 정보는 처리 X\n\n    if (payloadData.data.nickname === myNickName) return; //타 유저 정보 처리\n    //방 접속 신호 수신\n\n    if (payloadData.header.type === \"join\") {\n      console.log(payloadData); //이미 방에 접속해있는 유저인 경우 처리해주지 않음\n\n      if (otherUserData[payloadData.data.nickname]) return; //새로 들어왔으면 해당 유저에게 자신의 정보를 반환\n\n      client2.publish({\n        destination: sockADR,\n        headers: {\n          \"content-type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          header: {\n            type: \"list\"\n          },\n          data: {\n            nickname: myNickName,\n            color: myColor,\n            x: pX.current,\n            y: pY.current\n          }\n        }),\n        skipContentLengthHeader: true\n      }); //새로 접속해온 경우 남아있는 자리를 확인\n\n      for (let i in remainNum) {\n        //빈 자리에 넣기\n        if (!remainNum[i]) {\n          remainNum[i] = true; //색변경 => 보이기\n\n          otherUserData[payloadData.data.nickname] = {\n            color: payloadData.data.color,\n            num: i\n          };\n          document.getElementById(`char${i}`).style.left = startYX.x;\n          document.getElementById(`char${i}`).style.top = startYX.y;\n          document.getElementById(`char${i}`).style.background = payloadData.data.color;\n          document.getElementById(`char${i}`).style.display = \"block\";\n          document.getElementById(`char${i}Name`).innerText = payloadData.data.nickname;\n          break;\n        }\n      }\n    } //join 정보에\n    else if (payloadData.header.type === \"list\") {\n      console.log(\"list: \", payloadData);\n      if (otherUserData[payloadData.data.nickname]) return; //새로 접속해온 경우 남아있는 자리를 확인\n\n      for (let i in remainNum) {\n        //빈 자리에 넣기\n        if (!remainNum[i]) {\n          remainNum[i] = true; //색변경 => 보이기\n\n          otherUserData[payloadData.data.nickname] = {\n            color: payloadData.data.color,\n            num: i\n          };\n          document.getElementById(`char${i}`).style.left = payloadData.data.x + \"px\";\n          document.getElementById(`char${i}`).style.top = payloadData.data.y + \"px\";\n          document.getElementById(`char${i}`).style.background = payloadData.data.color;\n          document.getElementById(`char${i}`).style.display = \"block\";\n          document.getElementById(`char${i}Name`).innerText = payloadData.data.nickname;\n          break;\n        }\n      }\n    } //방을 떠나는 신호 수신\n    else if (payloadData.header.type === \"leave\") {\n      console.log(\"type: \", payloadData.header.type + \", body: \" + payloadData.body);\n      let userNum = otherUserData[payloadData.data.nickname].num;\n      remainNum[userNum] = false;\n      otherUserData[payloadData.data.nickname] = undefined;\n      document.getElementById(`char${userNum}`).style.display = \"none\";\n      document.getElementById(`char${userNum}Name`).innerText = \"\";\n    } //캐릭터 움직일 때\n    else if (payloadData.header.type === \"interact\") {\n      if (otherUserData[payloadData.data.nickname] === undefined) {\n        console.log(\"undefined error, otherUserData: \", otherUserData);\n      } //위치 변경\n\n\n      document.getElementById(`char${otherUserData[payloadData.data.nickname].num}`).style.left = payloadData.data.x + \"px\";\n      document.getElementById(`char${otherUserData[payloadData.data.nickname].num}`).style.top = payloadData.data.y + \"px\";\n      otherUserData[payloadData.data.nickname][\"y\"] = payloadData.data.y;\n      otherUserData[payloadData.data.nickname][\"x\"] = payloadData.data.x; //의자에 앉았을 때 해당 의자 비활성화\n\n      if (payloadData.data.status === \"ready\") {\n        console.log(\"레디 신호 수신, 이름 의자번호: \" + payloadData.data.nickname + \" \" + payloadData.data.chairNum);\n      } //의자 일어섰을 때 해당 의자 활성화\n      else if (payloadData.data.status === \"stand\") {}\n    } else if (payloadData.header.type === \"start\") {\n      console.log(payloadData.data);\n    } //게임 설정 변경 데이터 수신\n    else if (payloadData.header.type === \"setting\") {\n      console.log(\"type: \", payloadData.header.type + \", body: \" + payloadData.body); //방 제목 변경 추후\n\n      dispatch(setLimit(payloadData.data.capacity));\n      dispatch(setMaf(payloadData.data.mafia));\n      dispatch(setDoc(payloadData.data.doctor));\n      dispatch(setCop(payloadData.data.police));\n      dispatch(setMaf(payloadData.data.mafia));\n      dispatch(setTalkTime(payloadData.data.talkTime));\n      dispatch(setVoteTime(payloadData.data.voteTime));\n      dispatch(setNightTime(payloadData.data.nightTime));\n    } //해당 되지 않는 타입 출력\n    else {\n      console.log(\"else: \", payloadData);\n    }\n  }; //첫 렌더링될 때만 입력받는 input태그로 focus\n\n\n  useEffect(() => {\n    myChar.current = document.getElementById(\"myCharacter\");\n    myChar.current.style.background = myColor;\n    myChar.current.style.display = \"block\";\n    console.log(\"myColor: \", myColor);\n    console.log(\"myChar: \", myChar.current);\n    mapFocus.current.focus(); //랜더링 종료 시 인터벌 종료\n\n    return () => {\n      console.log(\"render return\"); //랜더링 종료될 때 leave 신호 전송\n\n      clearInterval(inputCheck);\n      clearInterval(sendMyPos);\n      dispatch(setX(pX.current));\n      dispatch(setY(pY.current)); // props.subGatherRoom.unsubscribed();\n    };\n  }, []); //약 60fps로 위치 정보 전송, 움직일 때만 전송\n\n  const sendMyPos = setInterval(() => {\n    if (client2) {\n      if (keyPress[87] || keyPress[83] || keyPress[65] || keyPress[68]) {\n        client2.publish({\n          destination: sockADR,\n          headers: {\n            \"content-type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            header: {\n              type: \"interact\"\n            },\n            data: {\n              nickname: myNickName,\n              status: \"move\",\n              chairNum: null,\n              x: pX.current,\n              y: pY.current\n            }\n          }),\n          skipContentLengthHeader: true\n        });\n      }\n    }\n  }, 2000); //부드러운 움직임을 위한 변수 선언\n  //일정 초마다 키 입력 확인\n\n  const inputCheck = setInterval(() => {\n    if (keyPress[87]) pY.current -= speed;\n    if (keyPress[83]) pY.current += speed; // down - s\n\n    if (keyPress[65]) pX.current -= speed; // left - a\n\n    if (keyPress[68]) pX.current += speed; //테이블 충돌 감지\n\n    if (pX.current < table.tbLeft + table.width && pX.current + charSize > table.tbLeft && pY.current < table.tbTop + table.height && charSize + pY.current > table.tbTop) {\n      if (keyPress[87]) pY.current += speed;\n      if (keyPress[83]) pY.current -= speed; // down - s\n\n      if (keyPress[65]) pX.current += speed; // left - a\n\n      if (keyPress[68]) pX.current -= speed;\n    }\n\n    seatNum = -1; //의자 충돌 감지\n\n    for (let i = 0; i < 8; i++) {\n      if (chairs[i][1] < pX.current + charSize && chairs[i][1] + chairSize > pX.current && chairs[i][0] < charSize + pY.current && chairs[i][0] + chairSize > pY.current) {\n        seatNum = i; //자리에 앉았을 시 소켓으로 준비 완료 전송\n\n        if (seatNum !== seatChange) {\n          seatNothing = true;\n          console.log(\"SeatNum: \", seatNum);\n          console.log(\"send ready\");\n          seatChange = i;\n          client2.publish({\n            destination: \"/sub/room/0\",\n            headers: {\n              \"content-type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              header: {\n                type: \"interact\"\n              },\n              data: {\n                nickname: myNickName,\n                status: \"ready\",\n                chairNum: seatChange,\n                y: pY.current,\n                x: pX.current\n              }\n            }),\n            skipContentLengthHeader: true\n          });\n        } //자리와 이전 자리가 같을 시\n\n      }\n    } //자리에서 벗어났을 시 소켓으로 준비 완료 해제 전송\n\n\n    if (seatNum === -1 && seatNothing === true) {\n      console.log(\"send not ready\");\n      seatCnt = 0;\n      seatNothing = false;\n      client2.publish({\n        destination: \"/sub/room/0\",\n        headers: {\n          \"content-type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          header: {\n            type: \"interact\"\n          },\n          data: {\n            nickname: myNickName,\n            status: \"stand\",\n            chairNum: -1,\n            y: pY.current,\n            x: pX.current\n          }\n        }),\n        skipContentLengthHeader: true\n      });\n    } //외부 벽 충돌 감지\n\n\n    if (pY.current < 0) pY.current = 0;\n    if (pY.current >= mapSize - charSize) pY.current = mapSize - charSize;\n    if (pX.current < 0) pX.current = 0;\n    if (pX.current >= mapSize - charSize) pX.current = mapSize - charSize; //캐릭터 좌표 최신화\n\n    myChar.current.style.left = pX.current + \"px\";\n    myChar.current.style.top = pY.current + \"px\";\n  }, 2000); //맵 클릭 시 입력 포커싱 지정\n\n  const changeFocus = () => {\n    mapFocus.current.focus();\n  }; //키 눌렀을 때 해당 값 true로 변환\n\n\n  const handleKeyDown = e => {\n    keyPress[e.keyCode.toString()] = true;\n  }; //키 땠을 때 해당 값 false로 변환\n\n\n  const handleKeyUp = e => {\n    keyPress[e.keyCode.toString()] = false;\n    client2.publish({\n      destination: sockADR,\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        header: {\n          type: \"interact\"\n        },\n        data: {\n          nickname: myNickName,\n          status: \"move\",\n          chairNum: null,\n          x: pX.current,\n          y: pY.current\n        }\n      }),\n      skipContentLengthHeader: true\n    });\n    console.log(pX.current + \" \" + pY.current);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: \"relative\",\n      width: \"100%\",\n      height: \"100%\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => {\n        console.log(pX.current + \" \" + pY.current);\n      },\n      children: \"\\uD655\\uC778\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      id: \"inputTag\",\n      value: \"\\uC900\\uBE44 \\uC911\",\n      type: \"text\",\n      ref: mapFocus,\n      onKeyDown: handleKeyDown,\n      onKeyUp: handleKeyUp,\n      readOnly: true,\n      style: {\n        border: \"none\",\n        cursor: \"default\",\n        margin: \"0\",\n        position: \"absolute\",\n        top: 5,\n        left: 5\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 427,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"map\",\n      onClick: changeFocus,\n      style: {\n        width: mapSize,\n        height: mapSize,\n        background: \"orange\",\n        position: \"relative\",\n        left: 0,\n        top: 0\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"table\",\n        style: {\n          width: table.width,\n          height: table.height,\n          left: table.tbLeft,\n          top: table.tbTop,\n          background: \"green\",\n          position: \"absolute\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 9\n      }, this), chairs.map((e, idx) => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"chair\" + idx,\n          style: {\n            top: e[0],\n            left: e[1],\n            height: chairSize,\n            width: chairSize,\n            background: \"blue\",\n            position: \"absolute\"\n          }\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 13\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"myCharacter\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          position: \"absolute\",\n          color: myColor,\n          display: \"none\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          },\n          children: myNickName !== undefined ? myNickName : \"need login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"char1\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          background: \"red\",\n          position: \"absolute\",\n          display: \"none\",\n          left: startYX.x,\n          top: startYX.y\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"char1Name\",\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"char2\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          background: \"red\",\n          position: \"absolute\",\n          display: \"none\",\n          left: startYX.x,\n          top: startYX.y\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"char2Name\",\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 519,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"char3\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          background: \"red\",\n          position: \"absolute\",\n          display: \"none\",\n          left: startYX.x,\n          top: startYX.y\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"char3Name\",\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 537,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"char4\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          background: \"red\",\n          position: \"absolute\",\n          display: \"none\",\n          left: startYX.x,\n          top: startYX.y\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"char4Name\",\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"char5\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          background: \"red\",\n          position: \"absolute\",\n          display: \"none\",\n          left: startYX.x,\n          top: startYX.y\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"char5Name\",\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 586,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 573,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"char6\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          background: \"red\",\n          position: \"absolute\",\n          display: \"none\",\n          left: startYX.x,\n          top: startYX.y\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"char6Name\",\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 591,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"char7\",\n        style: {\n          margin: `0px`,\n          width: charSize,\n          height: charSize,\n          background: \"red\",\n          position: \"absolute\",\n          display: \"none\",\n          left: startYX.x,\n          top: startYX.y\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"char7Name\",\n          style: {\n            top: -20,\n            width: 200,\n            position: \"absolute\",\n            left: -100 + 25\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 622,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 609,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 413,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PlayMap, \"KH+A+SsPVYN9M8ApcGbQMkUTmJk=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PlayMap;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlayMap\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useSelector","useDispatch","selectColor","selectX","selectY","setColor","setX","setY","selectUser","PlayMap","props","dispatch","startYX","y","x","subGatherRoom","myNickName","nickname","myColor","undefined","Math","round","random","toString","seatNum","seatChange","seatCnt","seatNothing","mapSize","table","tbTop","tbLeft","width","height","chairs","charSize","chairSize","chairSeatState","mapFocus","myChar","document","getElementById","keyPress","pX","pY","speed","console","log","current","otherUserData","remainNum","sockADR","client2","userJoin","publish","destination","headers","body","JSON","stringify","header","type","data","color","skipContentLengthHeader","client","onConnect","frame","onMessageReceived","subscribe","payload","payloadData","parse","i","num","style","left","top","background","display","innerText","userNum","status","chairNum","setLimit","capacity","setMaf","mafia","setDoc","doctor","setCop","police","setTalkTime","talkTime","setVoteTime","voteTime","setNightTime","nightTime","focus","clearInterval","inputCheck","sendMyPos","setInterval","changeFocus","handleKeyDown","e","keyCode","handleKeyUp","position","border","cursor","margin","map","idx"],"sources":["C:/SSAFY/2nd semester/S07P12D106/front/src/components/GatherRoomPageCom/PlayMap.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\n\r\nimport { selectColor, selectX, selectY, setColor, setX, setY } from \"../../redux/slice/CharSlice\";\r\nimport { selectUser } from \"../../redux/slice/UserSlice\";\r\n\r\nexport default function PlayMap(props) {\r\n  //redux 액션 호출\r\n  const dispatch = useDispatch();\r\n\r\n  //시작 지점\r\n  let startYX = { y: 600, x: 300 };\r\n\r\n  //소켓 연결 시 구독한 주소 반환 저장\r\n  let subGatherRoom = null;\r\n\r\n  //내 아이디\r\n  const myNickName = useSelector(selectUser).nickname;\r\n\r\n  //처음 랜더링될 때 내 색을 지정\r\n\r\n  let myColor = useSelector(selectColor);\r\n  if (myColor == undefined) {\r\n    myColor = \"#\" + Math.round(Math.random() * 0xffffff).toString(16);\r\n    dispatch(setColor(myColor));\r\n  }\r\n\r\n  let seatNum, seatChange, seatCnt, seatNothing;\r\n\r\n  //게임 맵 크기\r\n  const mapSize = 700;\r\n\r\n  //맵 출력 테이블 위치, 사이즈\r\n  const table = {\r\n    tbTop: 100,\r\n    tbLeft: 200,\r\n    width: 300,\r\n    height: 300,\r\n  };\r\n\r\n  //맵에 출력할 의자 위치 (top, left)\r\n  const chairs = [\r\n    [40, 300],\r\n    [40, 400],\r\n    [160, 100],\r\n    [300, 100],\r\n    [450, 300],\r\n    [450, 400],\r\n    [160, 550],\r\n    [300, 550],\r\n  ];\r\n  const charSize = 50;\r\n  const chairSize = 20;\r\n  let chairSeatState = { 1: false, 2: false, 3: false, 4: false, 5: false, 6: false, 7: false };\r\n  //포커싱 지정을 위한 변수\r\n  const mapFocus = useRef();\r\n\r\n  //div태그를 아바타 객체로 지정\r\n  const myChar = useRef(document.getElementById(\"myCharacter\"));\r\n\r\n  //키 입력 시 값 저장 배열, 움직였을 때 위치 저장, 속도\r\n  let keyPress = {},\r\n    pX = useRef(useSelector(selectX)),\r\n    pY = useRef(useSelector(selectY)),\r\n    speed = 5;\r\n  console.log(pX.current);\r\n  console.log(pY.current);\r\n\r\n  //타 유저의 데이터 저장\r\n  let otherUserData = {},\r\n    //현재 몇번에 유저가 저장되어있는지 확인\r\n    remainNum = { 1: false, 2: false, 3: false, 4: false, 5: false, 6: false, 7: false };\r\n\r\n  const sockADR = props.sockADR;\r\n  const client2 = props.client2;\r\n\r\n  const userJoin = () => {\r\n    console.log(\"userJoin start\");\r\n    if (document.getElementById(\"myCharacter\") == null) return;\r\n\r\n    client2.publish({\r\n      destination: sockADR,\r\n      headers: { \"content-type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        header: {\r\n          type: \"join\",\r\n        },\r\n        data: {\r\n          nickname: myNickName,\r\n          color: myColor,\r\n          x: pX.current,\r\n          y: pY.current,\r\n        },\r\n      }),\r\n      skipContentLengthHeader: true,\r\n    });\r\n    console.log(\"userJoin end\");\r\n  };\r\n\r\n  //**************************************** */\r\n  //** 소켓으로 정보를 받았을 때 처리 함수 **\r\n  //**************************************** */\r\n  props.client.onConnect = (frame) => {\r\n    console.log(\"2. run onConnect in PlayMap\");\r\n    //구독 및 연결 시 join 소켓 전송\r\n    console.log(\"onMessageReceived: \", onMessageReceived);\r\n    subGatherRoom = props.client.subscribe(\"/sub/room/0\", onMessageReceived);\r\n    //userJoin()\r\n    console.log(\"ended onConnect\");\r\n  };\r\n\r\n  const onMessageReceived = (payload) => {\r\n    console.log(\"payload: \", payload);\r\n\r\n    var payloadData = JSON.parse(payload.body);\r\n    console.log(payloadData);\r\n    //내가 송신한 정보는 처리 X\r\n    if (payloadData.data.nickname === myNickName) return;\r\n\r\n    //타 유저 정보 처리\r\n    //방 접속 신호 수신\r\n    if (payloadData.header.type === \"join\") {\r\n      console.log(payloadData);\r\n      //이미 방에 접속해있는 유저인 경우 처리해주지 않음\r\n      if (otherUserData[payloadData.data.nickname]) return;\r\n\r\n      //새로 들어왔으면 해당 유저에게 자신의 정보를 반환\r\n      client2.publish({\r\n        destination: sockADR,\r\n        headers: { \"content-type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          header: {\r\n            type: \"list\",\r\n          },\r\n          data: {\r\n            nickname: myNickName,\r\n            color: myColor,\r\n            x: pX.current,\r\n            y: pY.current,\r\n          },\r\n        }),\r\n        skipContentLengthHeader: true,\r\n      });\r\n\r\n      //새로 접속해온 경우 남아있는 자리를 확인\r\n      for (let i in remainNum) {\r\n        //빈 자리에 넣기\r\n        if (!remainNum[i]) {\r\n          remainNum[i] = true;\r\n          //색변경 => 보이기\r\n          otherUserData[payloadData.data.nickname] = { color: payloadData.data.color, num: i };\r\n          document.getElementById(`char${i}`).style.left = startYX.x;\r\n          document.getElementById(`char${i}`).style.top = startYX.y;\r\n          document.getElementById(`char${i}`).style.background = payloadData.data.color;\r\n          document.getElementById(`char${i}`).style.display = \"block\";\r\n          document.getElementById(`char${i}Name`).innerText = payloadData.data.nickname;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    //join 정보에\r\n    else if (payloadData.header.type === \"list\") {\r\n      console.log(\"list: \", payloadData);\r\n      if (otherUserData[payloadData.data.nickname]) return;\r\n\r\n      //새로 접속해온 경우 남아있는 자리를 확인\r\n      for (let i in remainNum) {\r\n        //빈 자리에 넣기\r\n        if (!remainNum[i]) {\r\n          remainNum[i] = true;\r\n          //색변경 => 보이기\r\n          otherUserData[payloadData.data.nickname] = { color: payloadData.data.color, num: i };\r\n          document.getElementById(`char${i}`).style.left = payloadData.data.x + \"px\";\r\n          document.getElementById(`char${i}`).style.top = payloadData.data.y + \"px\";\r\n          document.getElementById(`char${i}`).style.background = payloadData.data.color;\r\n          document.getElementById(`char${i}`).style.display = \"block\";\r\n          document.getElementById(`char${i}Name`).innerText = payloadData.data.nickname;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    //방을 떠나는 신호 수신\r\n    else if (payloadData.header.type === \"leave\") {\r\n      console.log(\"type: \", payloadData.header.type + \", body: \" + payloadData.body);\r\n      let userNum = otherUserData[payloadData.data.nickname].num;\r\n      remainNum[userNum] = false;\r\n      otherUserData[payloadData.data.nickname] = undefined;\r\n      document.getElementById(`char${userNum}`).style.display = \"none\";\r\n      document.getElementById(`char${userNum}Name`).innerText = \"\";\r\n    }\r\n    //캐릭터 움직일 때\r\n    else if (payloadData.header.type === \"interact\") {\r\n      if (otherUserData[payloadData.data.nickname] === undefined) {\r\n        console.log(\"undefined error, otherUserData: \", otherUserData);\r\n      }\r\n      //위치 변경\r\n      document.getElementById(`char${otherUserData[payloadData.data.nickname].num}`).style.left =\r\n        payloadData.data.x + \"px\";\r\n      document.getElementById(`char${otherUserData[payloadData.data.nickname].num}`).style.top =\r\n        payloadData.data.y + \"px\";\r\n      otherUserData[payloadData.data.nickname][\"y\"] = payloadData.data.y;\r\n      otherUserData[payloadData.data.nickname][\"x\"] = payloadData.data.x;\r\n\r\n      //의자에 앉았을 때 해당 의자 비활성화\r\n      if (payloadData.data.status === \"ready\") {\r\n        console.log(\r\n          \"레디 신호 수신, 이름 의자번호: \" +\r\n            payloadData.data.nickname +\r\n            \" \" +\r\n            payloadData.data.chairNum\r\n        );\r\n      }\r\n      //의자 일어섰을 때 해당 의자 활성화\r\n      else if (payloadData.data.status === \"stand\") {\r\n      }\r\n    } else if (payloadData.header.type === \"start\") {\r\n      console.log(payloadData.data);\r\n    }\r\n    //게임 설정 변경 데이터 수신\r\n    else if (payloadData.header.type === \"setting\") {\r\n      console.log(\"type: \", payloadData.header.type + \", body: \" + payloadData.body);\r\n      //방 제목 변경 추후\r\n      dispatch(setLimit(payloadData.data.capacity));\r\n      dispatch(setMaf(payloadData.data.mafia));\r\n      dispatch(setDoc(payloadData.data.doctor));\r\n      dispatch(setCop(payloadData.data.police));\r\n      dispatch(setMaf(payloadData.data.mafia));\r\n      dispatch(setTalkTime(payloadData.data.talkTime));\r\n      dispatch(setVoteTime(payloadData.data.voteTime));\r\n      dispatch(setNightTime(payloadData.data.nightTime));\r\n    }\r\n    //해당 되지 않는 타입 출력\r\n    else {\r\n      console.log(\"else: \", payloadData);\r\n    }\r\n  };\r\n\r\n  //첫 렌더링될 때만 입력받는 input태그로 focus\r\n  useEffect(() => {\r\n    myChar.current = document.getElementById(\"myCharacter\");\r\n    myChar.current.style.background = myColor;\r\n    myChar.current.style.display = \"block\";\r\n    console.log(\"myColor: \", myColor);\r\n    console.log(\"myChar: \", myChar.current);\r\n    mapFocus.current.focus();\r\n\r\n    //랜더링 종료 시 인터벌 종료\r\n    return () => {\r\n      console.log(\"render return\");\r\n\r\n      //랜더링 종료될 때 leave 신호 전송\r\n      clearInterval(inputCheck);\r\n      clearInterval(sendMyPos);\r\n      dispatch(setX(pX.current));\r\n      dispatch(setY(pY.current));\r\n      // props.subGatherRoom.unsubscribed();\r\n    };\r\n  }, []);\r\n\r\n  //약 60fps로 위치 정보 전송, 움직일 때만 전송\r\n  const sendMyPos = setInterval(() => {\r\n    if (client2) {\r\n      if (keyPress[87] || keyPress[83] || keyPress[65] || keyPress[68]) {\r\n        client2.publish({\r\n          destination: sockADR,\r\n          headers: { \"content-type\": \"application/json\" },\r\n          body: JSON.stringify({\r\n            header: {\r\n              type: \"interact\",\r\n            },\r\n            data: {\r\n              nickname: myNickName,\r\n              status: \"move\",\r\n              chairNum: null,\r\n              x: pX.current,\r\n              y: pY.current,\r\n            },\r\n          }),\r\n          skipContentLengthHeader: true,\r\n        });\r\n      }\r\n    }\r\n  }, 2000);\r\n\r\n  //부드러운 움직임을 위한 변수 선언\r\n  //일정 초마다 키 입력 확인\r\n  const inputCheck = setInterval(() => {\r\n    if (keyPress[87]) pY.current -= speed;\r\n    if (keyPress[83]) pY.current += speed; // down - s\r\n    if (keyPress[65]) pX.current -= speed; // left - a\r\n    if (keyPress[68]) pX.current += speed;\r\n\r\n    //테이블 충돌 감지\r\n    if (\r\n      pX.current < table.tbLeft + table.width &&\r\n      pX.current + charSize > table.tbLeft &&\r\n      pY.current < table.tbTop + table.height &&\r\n      charSize + pY.current > table.tbTop\r\n    ) {\r\n      if (keyPress[87]) pY.current += speed;\r\n      if (keyPress[83]) pY.current -= speed; // down - s\r\n      if (keyPress[65]) pX.current += speed; // left - a\r\n      if (keyPress[68]) pX.current -= speed;\r\n    }\r\n\r\n    seatNum = -1;\r\n    //의자 충돌 감지\r\n    for (let i = 0; i < 8; i++) {\r\n      if (\r\n        chairs[i][1] < pX.current + charSize &&\r\n        chairs[i][1] + chairSize > pX.current &&\r\n        chairs[i][0] < charSize + pY.current &&\r\n        chairs[i][0] + chairSize > pY.current\r\n      ) {\r\n        seatNum = i;\r\n        //자리에 앉았을 시 소켓으로 준비 완료 전송\r\n        if (seatNum !== seatChange) {\r\n          seatNothing = true;\r\n          console.log(\"SeatNum: \", seatNum);\r\n          console.log(\"send ready\");\r\n          seatChange = i;\r\n\r\n          client2.publish({\r\n            destination: \"/sub/room/0\",\r\n            headers: { \"content-type\": \"application/json\" },\r\n            body: JSON.stringify({\r\n              header: {\r\n                type: \"interact\",\r\n              },\r\n              data: {\r\n                nickname: myNickName,\r\n                status: \"ready\",\r\n                chairNum: seatChange,\r\n                y: pY.current,\r\n                x: pX.current,\r\n              },\r\n            }),\r\n            skipContentLengthHeader: true,\r\n          });\r\n        }\r\n        //자리와 이전 자리가 같을 시\r\n      }\r\n    }\r\n    //자리에서 벗어났을 시 소켓으로 준비 완료 해제 전송\r\n    if (seatNum === -1 && seatNothing === true) {\r\n      console.log(\"send not ready\");\r\n      seatCnt = 0;\r\n      seatNothing = false;\r\n\r\n      client2.publish({\r\n        destination: \"/sub/room/0\",\r\n        headers: { \"content-type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          header: {\r\n            type: \"interact\",\r\n          },\r\n          data: {\r\n            nickname: myNickName,\r\n            status: \"stand\",\r\n            chairNum: -1,\r\n            y: pY.current,\r\n            x: pX.current,\r\n          },\r\n        }),\r\n        skipContentLengthHeader: true,\r\n      });\r\n    }\r\n    //외부 벽 충돌 감지\r\n    if (pY.current < 0) pY.current = 0;\r\n    if (pY.current >= mapSize - charSize) pY.current = mapSize - charSize;\r\n    if (pX.current < 0) pX.current = 0;\r\n    if (pX.current >= mapSize - charSize) pX.current = mapSize - charSize;\r\n\r\n    //캐릭터 좌표 최신화\r\n    myChar.current.style.left = pX.current + \"px\";\r\n    myChar.current.style.top = pY.current + \"px\";\r\n  }, 2000);\r\n\r\n  //맵 클릭 시 입력 포커싱 지정\r\n  const changeFocus = () => {\r\n    mapFocus.current.focus();\r\n  };\r\n\r\n  //키 눌렀을 때 해당 값 true로 변환\r\n  const handleKeyDown = (e) => {\r\n    keyPress[e.keyCode.toString()] = true;\r\n  };\r\n  //키 땠을 때 해당 값 false로 변환\r\n  const handleKeyUp = (e) => {\r\n    keyPress[e.keyCode.toString()] = false;\r\n    client2.publish({\r\n      destination: sockADR,\r\n      headers: { \"content-type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        header: {\r\n          type: \"interact\",\r\n        },\r\n        data: {\r\n          nickname: myNickName,\r\n          status: \"move\",\r\n          chairNum: null,\r\n          x: pX.current,\r\n          y: pY.current,\r\n        },\r\n      }),\r\n      skipContentLengthHeader: true,\r\n    });\r\n\r\n    console.log(pX.current + \" \" + pY.current);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: \"relative\",\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n      }}\r\n    >\r\n      <button\r\n        onClick={() => {\r\n          console.log(pX.current + \" \" + pY.current);\r\n        }}\r\n      >\r\n        확인\r\n      </button>\r\n      <input\r\n        id='inputTag'\r\n        value='준비 중'\r\n        type='text'\r\n        ref={mapFocus}\r\n        onKeyDown={handleKeyDown}\r\n        onKeyUp={handleKeyUp}\r\n        readOnly\r\n        style={{\r\n          border: \"none\",\r\n          cursor: \"default\",\r\n          margin: \"0\",\r\n          position: \"absolute\",\r\n          top: 5,\r\n          left: 5,\r\n        }}\r\n      />\r\n      <div\r\n        id='map'\r\n        onClick={changeFocus}\r\n        style={{\r\n          width: mapSize,\r\n          height: mapSize,\r\n          background: \"orange\",\r\n          position: \"relative\",\r\n          left: 0,\r\n          top: 0,\r\n        }}\r\n      >\r\n        <div\r\n          id='table'\r\n          style={{\r\n            width: table.width,\r\n            height: table.height,\r\n            left: table.tbLeft,\r\n            top: table.tbTop,\r\n            background: \"green\",\r\n            position: \"absolute\",\r\n          }}\r\n        ></div>\r\n\r\n        {chairs.map((e, idx) => {\r\n          return (\r\n            <div\r\n              key={idx}\r\n              id={\"chair\" + idx}\r\n              style={{\r\n                top: e[0],\r\n                left: e[1],\r\n                height: chairSize,\r\n                width: chairSize,\r\n                background: \"blue\",\r\n                position: \"absolute\",\r\n              }}\r\n            ></div>\r\n          );\r\n        })}\r\n        <div\r\n          id='myCharacter'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            position: \"absolute\",\r\n            color: myColor,\r\n            display: \"none\",\r\n          }}\r\n        >\r\n          <div style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}>\r\n            {myNickName !== undefined ? myNickName : \"need login\"}\r\n          </div>\r\n        </div>\r\n        {/* 다른 유저의 캐릭터 */}\r\n\r\n        <div\r\n          id='char1'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char1Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char2'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char2Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char3'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char3Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char4'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char4Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char5'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char5Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char6'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char6Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n        <div\r\n          id='char7'\r\n          style={{\r\n            margin: `0px`,\r\n            width: charSize,\r\n            height: charSize,\r\n            background: \"red\",\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            left: startYX.x,\r\n            top: startYX.y,\r\n          }}\r\n        >\r\n          <div\r\n            id='char7Name'\r\n            style={{ top: -20, width: 200, position: \"absolute\", left: -100 + 25 }}\r\n          ></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,SAAxB,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AAEA,SAASC,WAAT,EAAsBC,OAAtB,EAA+BC,OAA/B,EAAwCC,QAAxC,EAAkDC,IAAlD,EAAwDC,IAAxD,QAAoE,6BAApE;AACA,SAASC,UAAT,QAA2B,6BAA3B;;AAEA,eAAe,SAASC,OAAT,CAAiBC,KAAjB,EAAwB;EAAA;;EACrC;EACA,MAAMC,QAAQ,GAAGV,WAAW,EAA5B,CAFqC,CAIrC;;EACA,IAAIW,OAAO,GAAG;IAAEC,CAAC,EAAE,GAAL;IAAUC,CAAC,EAAE;EAAb,CAAd,CALqC,CAOrC;;EACA,IAAIC,aAAa,GAAG,IAApB,CARqC,CAUrC;;EACA,MAAMC,UAAU,GAAGhB,WAAW,CAACQ,UAAD,CAAX,CAAwBS,QAA3C,CAXqC,CAarC;;EAEA,IAAIC,OAAO,GAAGlB,WAAW,CAACE,WAAD,CAAzB;;EACA,IAAIgB,OAAO,IAAIC,SAAf,EAA0B;IACxBD,OAAO,GAAG,MAAME,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,QAA3B,EAAqCC,QAArC,CAA8C,EAA9C,CAAhB;IACAZ,QAAQ,CAACN,QAAQ,CAACa,OAAD,CAAT,CAAR;EACD;;EAED,IAAIM,OAAJ,EAAaC,UAAb,EAAyBC,OAAzB,EAAkCC,WAAlC,CArBqC,CAuBrC;;EACA,MAAMC,OAAO,GAAG,GAAhB,CAxBqC,CA0BrC;;EACA,MAAMC,KAAK,GAAG;IACZC,KAAK,EAAE,GADK;IAEZC,MAAM,EAAE,GAFI;IAGZC,KAAK,EAAE,GAHK;IAIZC,MAAM,EAAE;EAJI,CAAd,CA3BqC,CAkCrC;;EACA,MAAMC,MAAM,GAAG,CACb,CAAC,EAAD,EAAK,GAAL,CADa,EAEb,CAAC,EAAD,EAAK,GAAL,CAFa,EAGb,CAAC,GAAD,EAAM,GAAN,CAHa,EAIb,CAAC,GAAD,EAAM,GAAN,CAJa,EAKb,CAAC,GAAD,EAAM,GAAN,CALa,EAMb,CAAC,GAAD,EAAM,GAAN,CANa,EAOb,CAAC,GAAD,EAAM,GAAN,CAPa,EAQb,CAAC,GAAD,EAAM,GAAN,CARa,CAAf;EAUA,MAAMC,QAAQ,GAAG,EAAjB;EACA,MAAMC,SAAS,GAAG,EAAlB;EACA,IAAIC,cAAc,GAAG;IAAE,GAAG,KAAL;IAAY,GAAG,KAAf;IAAsB,GAAG,KAAzB;IAAgC,GAAG,KAAnC;IAA0C,GAAG,KAA7C;IAAoD,GAAG,KAAvD;IAA8D,GAAG;EAAjE,CAArB,CA/CqC,CAgDrC;;EACA,MAAMC,QAAQ,GAAGzC,MAAM,EAAvB,CAjDqC,CAmDrC;;EACA,MAAM0C,MAAM,GAAG1C,MAAM,CAAC2C,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAD,CAArB,CApDqC,CAsDrC;;EACA,IAAIC,QAAQ,GAAG,EAAf;EAAA,IACEC,EAAE,GAAG9C,MAAM,CAACG,WAAW,CAACG,OAAD,CAAZ,CADb;EAAA,IAEEyC,EAAE,GAAG/C,MAAM,CAACG,WAAW,CAACI,OAAD,CAAZ,CAFb;EAAA,IAGEyC,KAAK,GAAG,CAHV;EAIAC,OAAO,CAACC,GAAR,CAAYJ,EAAE,CAACK,OAAf;EACAF,OAAO,CAACC,GAAR,CAAYH,EAAE,CAACI,OAAf,EA5DqC,CA8DrC;;EACA,IAAIC,aAAa,GAAG,EAApB;EAAA,IACE;EACAC,SAAS,GAAG;IAAE,GAAG,KAAL;IAAY,GAAG,KAAf;IAAsB,GAAG,KAAzB;IAAgC,GAAG,KAAnC;IAA0C,GAAG,KAA7C;IAAoD,GAAG,KAAvD;IAA8D,GAAG;EAAjE,CAFd;EAIA,MAAMC,OAAO,GAAGzC,KAAK,CAACyC,OAAtB;EACA,MAAMC,OAAO,GAAG1C,KAAK,CAAC0C,OAAtB;;EAEA,MAAMC,QAAQ,GAAG,MAAM;IACrBP,OAAO,CAACC,GAAR,CAAY,gBAAZ;IACA,IAAIP,QAAQ,CAACC,cAAT,CAAwB,aAAxB,KAA0C,IAA9C,EAAoD;IAEpDW,OAAO,CAACE,OAAR,CAAgB;MACdC,WAAW,EAAEJ,OADC;MAEdK,OAAO,EAAE;QAAE,gBAAgB;MAAlB,CAFK;MAGdC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;QACnBC,MAAM,EAAE;UACNC,IAAI,EAAE;QADA,CADW;QAInBC,IAAI,EAAE;UACJ7C,QAAQ,EAAED,UADN;UAEJ+C,KAAK,EAAE7C,OAFH;UAGJJ,CAAC,EAAE6B,EAAE,CAACK,OAHF;UAIJnC,CAAC,EAAE+B,EAAE,CAACI;QAJF;MAJa,CAAf,CAHQ;MAcdgB,uBAAuB,EAAE;IAdX,CAAhB;IAgBAlB,OAAO,CAACC,GAAR,CAAY,cAAZ;EACD,CArBD,CAtEqC,CA6FrC;EACA;EACA;;;EACArC,KAAK,CAACuD,MAAN,CAAaC,SAAb,GAA0BC,KAAD,IAAW;IAClCrB,OAAO,CAACC,GAAR,CAAY,6BAAZ,EADkC,CAElC;;IACAD,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCqB,iBAAnC;IACArD,aAAa,GAAGL,KAAK,CAACuD,MAAN,CAAaI,SAAb,CAAuB,aAAvB,EAAsCD,iBAAtC,CAAhB,CAJkC,CAKlC;;IACAtB,OAAO,CAACC,GAAR,CAAY,iBAAZ;EACD,CAPD;;EASA,MAAMqB,iBAAiB,GAAIE,OAAD,IAAa;IACrCxB,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBuB,OAAzB;IAEA,IAAIC,WAAW,GAAGb,IAAI,CAACc,KAAL,CAAWF,OAAO,CAACb,IAAnB,CAAlB;IACAX,OAAO,CAACC,GAAR,CAAYwB,WAAZ,EAJqC,CAKrC;;IACA,IAAIA,WAAW,CAACT,IAAZ,CAAiB7C,QAAjB,KAA8BD,UAAlC,EAA8C,OANT,CAQrC;IACA;;IACA,IAAIuD,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,KAA4B,MAAhC,EAAwC;MACtCf,OAAO,CAACC,GAAR,CAAYwB,WAAZ,EADsC,CAEtC;;MACA,IAAItB,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAjB,EAA8C,OAHR,CAKtC;;MACAmC,OAAO,CAACE,OAAR,CAAgB;QACdC,WAAW,EAAEJ,OADC;QAEdK,OAAO,EAAE;UAAE,gBAAgB;QAAlB,CAFK;QAGdC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;UACnBC,MAAM,EAAE;YACNC,IAAI,EAAE;UADA,CADW;UAInBC,IAAI,EAAE;YACJ7C,QAAQ,EAAED,UADN;YAEJ+C,KAAK,EAAE7C,OAFH;YAGJJ,CAAC,EAAE6B,EAAE,CAACK,OAHF;YAIJnC,CAAC,EAAE+B,EAAE,CAACI;UAJF;QAJa,CAAf,CAHQ;QAcdgB,uBAAuB,EAAE;MAdX,CAAhB,EANsC,CAuBtC;;MACA,KAAK,IAAIS,CAAT,IAAcvB,SAAd,EAAyB;QACvB;QACA,IAAI,CAACA,SAAS,CAACuB,CAAD,CAAd,EAAmB;UACjBvB,SAAS,CAACuB,CAAD,CAAT,GAAe,IAAf,CADiB,CAEjB;;UACAxB,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,GAA2C;YAAE8C,KAAK,EAAEQ,WAAW,CAACT,IAAZ,CAAiBC,KAA1B;YAAiCW,GAAG,EAAED;UAAtC,CAA3C;UACAjC,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CC,IAA1C,GAAiDhE,OAAO,CAACE,CAAzD;UACA0B,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CE,GAA1C,GAAgDjE,OAAO,CAACC,CAAxD;UACA2B,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CG,UAA1C,GAAuDP,WAAW,CAACT,IAAZ,CAAiBC,KAAxE;UACAvB,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CI,OAA1C,GAAoD,OAApD;UACAvC,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,MAAjC,EAAwCO,SAAxC,GAAoDT,WAAW,CAACT,IAAZ,CAAiB7C,QAArE;UACA;QACD;MACF;IACF,CAtCD,CAuCA;IAvCA,KAwCK,IAAIsD,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,KAA4B,MAAhC,EAAwC;MAC3Cf,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBwB,WAAtB;MACA,IAAItB,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAjB,EAA8C,OAFH,CAI3C;;MACA,KAAK,IAAIwD,CAAT,IAAcvB,SAAd,EAAyB;QACvB;QACA,IAAI,CAACA,SAAS,CAACuB,CAAD,CAAd,EAAmB;UACjBvB,SAAS,CAACuB,CAAD,CAAT,GAAe,IAAf,CADiB,CAEjB;;UACAxB,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,GAA2C;YAAE8C,KAAK,EAAEQ,WAAW,CAACT,IAAZ,CAAiBC,KAA1B;YAAiCW,GAAG,EAAED;UAAtC,CAA3C;UACAjC,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CC,IAA1C,GAAiDL,WAAW,CAACT,IAAZ,CAAiBhD,CAAjB,GAAqB,IAAtE;UACA0B,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CE,GAA1C,GAAgDN,WAAW,CAACT,IAAZ,CAAiBjD,CAAjB,GAAqB,IAArE;UACA2B,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CG,UAA1C,GAAuDP,WAAW,CAACT,IAAZ,CAAiBC,KAAxE;UACAvB,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,EAAjC,EAAoCE,KAApC,CAA0CI,OAA1C,GAAoD,OAApD;UACAvC,QAAQ,CAACC,cAAT,CAAyB,OAAMgC,CAAE,MAAjC,EAAwCO,SAAxC,GAAoDT,WAAW,CAACT,IAAZ,CAAiB7C,QAArE;UACA;QACD;MACF;IACF,CAnBI,CAoBL;IApBK,KAqBA,IAAIsD,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,KAA4B,OAAhC,EAAyC;MAC5Cf,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBwB,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,GAA0B,UAA1B,GAAuCU,WAAW,CAACd,IAAzE;MACA,IAAIwB,OAAO,GAAGhC,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,CAAyCyD,GAAvD;MACAxB,SAAS,CAAC+B,OAAD,CAAT,GAAqB,KAArB;MACAhC,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,GAA2CE,SAA3C;MACAqB,QAAQ,CAACC,cAAT,CAAyB,OAAMwC,OAAQ,EAAvC,EAA0CN,KAA1C,CAAgDI,OAAhD,GAA0D,MAA1D;MACAvC,QAAQ,CAACC,cAAT,CAAyB,OAAMwC,OAAQ,MAAvC,EAA8CD,SAA9C,GAA0D,EAA1D;IACD,CAPI,CAQL;IARK,KASA,IAAIT,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,KAA4B,UAAhC,EAA4C;MAC/C,IAAIZ,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,KAA6CE,SAAjD,EAA4D;QAC1D2B,OAAO,CAACC,GAAR,CAAY,kCAAZ,EAAgDE,aAAhD;MACD,CAH8C,CAI/C;;;MACAT,QAAQ,CAACC,cAAT,CAAyB,OAAMQ,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,CAAyCyD,GAAI,EAA5E,EAA+EC,KAA/E,CAAqFC,IAArF,GACEL,WAAW,CAACT,IAAZ,CAAiBhD,CAAjB,GAAqB,IADvB;MAEA0B,QAAQ,CAACC,cAAT,CAAyB,OAAMQ,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,CAAyCyD,GAAI,EAA5E,EAA+EC,KAA/E,CAAqFE,GAArF,GACEN,WAAW,CAACT,IAAZ,CAAiBjD,CAAjB,GAAqB,IADvB;MAEAoC,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,CAAyC,GAAzC,IAAgDsD,WAAW,CAACT,IAAZ,CAAiBjD,CAAjE;MACAoC,aAAa,CAACsB,WAAW,CAACT,IAAZ,CAAiB7C,QAAlB,CAAb,CAAyC,GAAzC,IAAgDsD,WAAW,CAACT,IAAZ,CAAiBhD,CAAjE,CAV+C,CAY/C;;MACA,IAAIyD,WAAW,CAACT,IAAZ,CAAiBoB,MAAjB,KAA4B,OAAhC,EAAyC;QACvCpC,OAAO,CAACC,GAAR,CACE,wBACEwB,WAAW,CAACT,IAAZ,CAAiB7C,QADnB,GAEE,GAFF,GAGEsD,WAAW,CAACT,IAAZ,CAAiBqB,QAJrB;MAMD,CAPD,CAQA;MARA,KASK,IAAIZ,WAAW,CAACT,IAAZ,CAAiBoB,MAAjB,KAA4B,OAAhC,EAAyC,CAC7C;IACF,CAxBI,MAwBE,IAAIX,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,KAA4B,OAAhC,EAAyC;MAC9Cf,OAAO,CAACC,GAAR,CAAYwB,WAAW,CAACT,IAAxB;IACD,CAFM,CAGP;IAHO,KAIF,IAAIS,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,KAA4B,SAAhC,EAA2C;MAC9Cf,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBwB,WAAW,CAACX,MAAZ,CAAmBC,IAAnB,GAA0B,UAA1B,GAAuCU,WAAW,CAACd,IAAzE,EAD8C,CAE9C;;MACA9C,QAAQ,CAACyE,QAAQ,CAACb,WAAW,CAACT,IAAZ,CAAiBuB,QAAlB,CAAT,CAAR;MACA1E,QAAQ,CAAC2E,MAAM,CAACf,WAAW,CAACT,IAAZ,CAAiByB,KAAlB,CAAP,CAAR;MACA5E,QAAQ,CAAC6E,MAAM,CAACjB,WAAW,CAACT,IAAZ,CAAiB2B,MAAlB,CAAP,CAAR;MACA9E,QAAQ,CAAC+E,MAAM,CAACnB,WAAW,CAACT,IAAZ,CAAiB6B,MAAlB,CAAP,CAAR;MACAhF,QAAQ,CAAC2E,MAAM,CAACf,WAAW,CAACT,IAAZ,CAAiByB,KAAlB,CAAP,CAAR;MACA5E,QAAQ,CAACiF,WAAW,CAACrB,WAAW,CAACT,IAAZ,CAAiB+B,QAAlB,CAAZ,CAAR;MACAlF,QAAQ,CAACmF,WAAW,CAACvB,WAAW,CAACT,IAAZ,CAAiBiC,QAAlB,CAAZ,CAAR;MACApF,QAAQ,CAACqF,YAAY,CAACzB,WAAW,CAACT,IAAZ,CAAiBmC,SAAlB,CAAb,CAAR;IACD,CAXI,CAYL;IAZK,KAaA;MACHnD,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBwB,WAAtB;IACD;EACF,CA5HD,CAzGqC,CAuOrC;;;EACAzE,SAAS,CAAC,MAAM;IACdyC,MAAM,CAACS,OAAP,GAAiBR,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAjB;IACAF,MAAM,CAACS,OAAP,CAAe2B,KAAf,CAAqBG,UAArB,GAAkC5D,OAAlC;IACAqB,MAAM,CAACS,OAAP,CAAe2B,KAAf,CAAqBI,OAArB,GAA+B,OAA/B;IACAjC,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB7B,OAAzB;IACA4B,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBR,MAAM,CAACS,OAA/B;IACAV,QAAQ,CAACU,OAAT,CAAiBkD,KAAjB,GANc,CAQd;;IACA,OAAO,MAAM;MACXpD,OAAO,CAACC,GAAR,CAAY,eAAZ,EADW,CAGX;;MACAoD,aAAa,CAACC,UAAD,CAAb;MACAD,aAAa,CAACE,SAAD,CAAb;MACA1F,QAAQ,CAACL,IAAI,CAACqC,EAAE,CAACK,OAAJ,CAAL,CAAR;MACArC,QAAQ,CAACJ,IAAI,CAACqC,EAAE,CAACI,OAAJ,CAAL,CAAR,CAPW,CAQX;IACD,CATD;EAUD,CAnBQ,EAmBN,EAnBM,CAAT,CAxOqC,CA6PrC;;EACA,MAAMqD,SAAS,GAAGC,WAAW,CAAC,MAAM;IAClC,IAAIlD,OAAJ,EAAa;MACX,IAAIV,QAAQ,CAAC,EAAD,CAAR,IAAgBA,QAAQ,CAAC,EAAD,CAAxB,IAAgCA,QAAQ,CAAC,EAAD,CAAxC,IAAgDA,QAAQ,CAAC,EAAD,CAA5D,EAAkE;QAChEU,OAAO,CAACE,OAAR,CAAgB;UACdC,WAAW,EAAEJ,OADC;UAEdK,OAAO,EAAE;YAAE,gBAAgB;UAAlB,CAFK;UAGdC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;YACnBC,MAAM,EAAE;cACNC,IAAI,EAAE;YADA,CADW;YAInBC,IAAI,EAAE;cACJ7C,QAAQ,EAAED,UADN;cAEJkE,MAAM,EAAE,MAFJ;cAGJC,QAAQ,EAAE,IAHN;cAIJrE,CAAC,EAAE6B,EAAE,CAACK,OAJF;cAKJnC,CAAC,EAAE+B,EAAE,CAACI;YALF;UAJa,CAAf,CAHQ;UAedgB,uBAAuB,EAAE;QAfX,CAAhB;MAiBD;IACF;EACF,CAtB4B,EAsB1B,IAtB0B,CAA7B,CA9PqC,CAsRrC;EACA;;EACA,MAAMoC,UAAU,GAAGE,WAAW,CAAC,MAAM;IACnC,IAAI5D,QAAQ,CAAC,EAAD,CAAZ,EAAkBE,EAAE,CAACI,OAAH,IAAcH,KAAd;IAClB,IAAIH,QAAQ,CAAC,EAAD,CAAZ,EAAkBE,EAAE,CAACI,OAAH,IAAcH,KAAd,CAFiB,CAEI;;IACvC,IAAIH,QAAQ,CAAC,EAAD,CAAZ,EAAkBC,EAAE,CAACK,OAAH,IAAcH,KAAd,CAHiB,CAGI;;IACvC,IAAIH,QAAQ,CAAC,EAAD,CAAZ,EAAkBC,EAAE,CAACK,OAAH,IAAcH,KAAd,CAJiB,CAMnC;;IACA,IACEF,EAAE,CAACK,OAAH,GAAanB,KAAK,CAACE,MAAN,GAAeF,KAAK,CAACG,KAAlC,IACAW,EAAE,CAACK,OAAH,GAAab,QAAb,GAAwBN,KAAK,CAACE,MAD9B,IAEAa,EAAE,CAACI,OAAH,GAAanB,KAAK,CAACC,KAAN,GAAcD,KAAK,CAACI,MAFjC,IAGAE,QAAQ,GAAGS,EAAE,CAACI,OAAd,GAAwBnB,KAAK,CAACC,KAJhC,EAKE;MACA,IAAIY,QAAQ,CAAC,EAAD,CAAZ,EAAkBE,EAAE,CAACI,OAAH,IAAcH,KAAd;MAClB,IAAIH,QAAQ,CAAC,EAAD,CAAZ,EAAkBE,EAAE,CAACI,OAAH,IAAcH,KAAd,CAFlB,CAEuC;;MACvC,IAAIH,QAAQ,CAAC,EAAD,CAAZ,EAAkBC,EAAE,CAACK,OAAH,IAAcH,KAAd,CAHlB,CAGuC;;MACvC,IAAIH,QAAQ,CAAC,EAAD,CAAZ,EAAkBC,EAAE,CAACK,OAAH,IAAcH,KAAd;IACnB;;IAEDrB,OAAO,GAAG,CAAC,CAAX,CAnBmC,CAoBnC;;IACA,KAAK,IAAIiD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;MAC1B,IACEvC,MAAM,CAACuC,CAAD,CAAN,CAAU,CAAV,IAAe9B,EAAE,CAACK,OAAH,GAAab,QAA5B,IACAD,MAAM,CAACuC,CAAD,CAAN,CAAU,CAAV,IAAerC,SAAf,GAA2BO,EAAE,CAACK,OAD9B,IAEAd,MAAM,CAACuC,CAAD,CAAN,CAAU,CAAV,IAAetC,QAAQ,GAAGS,EAAE,CAACI,OAF7B,IAGAd,MAAM,CAACuC,CAAD,CAAN,CAAU,CAAV,IAAerC,SAAf,GAA2BQ,EAAE,CAACI,OAJhC,EAKE;QACAxB,OAAO,GAAGiD,CAAV,CADA,CAEA;;QACA,IAAIjD,OAAO,KAAKC,UAAhB,EAA4B;UAC1BE,WAAW,GAAG,IAAd;UACAmB,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBvB,OAAzB;UACAsB,OAAO,CAACC,GAAR,CAAY,YAAZ;UACAtB,UAAU,GAAGgD,CAAb;UAEArB,OAAO,CAACE,OAAR,CAAgB;YACdC,WAAW,EAAE,aADC;YAEdC,OAAO,EAAE;cAAE,gBAAgB;YAAlB,CAFK;YAGdC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;cACnBC,MAAM,EAAE;gBACNC,IAAI,EAAE;cADA,CADW;cAInBC,IAAI,EAAE;gBACJ7C,QAAQ,EAAED,UADN;gBAEJkE,MAAM,EAAE,OAFJ;gBAGJC,QAAQ,EAAE1D,UAHN;gBAIJZ,CAAC,EAAE+B,EAAE,CAACI,OAJF;gBAKJlC,CAAC,EAAE6B,EAAE,CAACK;cALF;YAJa,CAAf,CAHQ;YAedgB,uBAAuB,EAAE;UAfX,CAAhB;QAiBD,CA1BD,CA2BA;;MACD;IACF,CAxDkC,CAyDnC;;;IACA,IAAIxC,OAAO,KAAK,CAAC,CAAb,IAAkBG,WAAW,KAAK,IAAtC,EAA4C;MAC1CmB,OAAO,CAACC,GAAR,CAAY,gBAAZ;MACArB,OAAO,GAAG,CAAV;MACAC,WAAW,GAAG,KAAd;MAEAyB,OAAO,CAACE,OAAR,CAAgB;QACdC,WAAW,EAAE,aADC;QAEdC,OAAO,EAAE;UAAE,gBAAgB;QAAlB,CAFK;QAGdC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;UACnBC,MAAM,EAAE;YACNC,IAAI,EAAE;UADA,CADW;UAInBC,IAAI,EAAE;YACJ7C,QAAQ,EAAED,UADN;YAEJkE,MAAM,EAAE,OAFJ;YAGJC,QAAQ,EAAE,CAAC,CAHP;YAIJtE,CAAC,EAAE+B,EAAE,CAACI,OAJF;YAKJlC,CAAC,EAAE6B,EAAE,CAACK;UALF;QAJa,CAAf,CAHQ;QAedgB,uBAAuB,EAAE;MAfX,CAAhB;IAiBD,CAhFkC,CAiFnC;;;IACA,IAAIpB,EAAE,CAACI,OAAH,GAAa,CAAjB,EAAoBJ,EAAE,CAACI,OAAH,GAAa,CAAb;IACpB,IAAIJ,EAAE,CAACI,OAAH,IAAcpB,OAAO,GAAGO,QAA5B,EAAsCS,EAAE,CAACI,OAAH,GAAapB,OAAO,GAAGO,QAAvB;IACtC,IAAIQ,EAAE,CAACK,OAAH,GAAa,CAAjB,EAAoBL,EAAE,CAACK,OAAH,GAAa,CAAb;IACpB,IAAIL,EAAE,CAACK,OAAH,IAAcpB,OAAO,GAAGO,QAA5B,EAAsCQ,EAAE,CAACK,OAAH,GAAapB,OAAO,GAAGO,QAAvB,CArFH,CAuFnC;;IACAI,MAAM,CAACS,OAAP,CAAe2B,KAAf,CAAqBC,IAArB,GAA4BjC,EAAE,CAACK,OAAH,GAAa,IAAzC;IACAT,MAAM,CAACS,OAAP,CAAe2B,KAAf,CAAqBE,GAArB,GAA2BjC,EAAE,CAACI,OAAH,GAAa,IAAxC;EACD,CA1F6B,EA0F3B,IA1F2B,CAA9B,CAxRqC,CAoXrC;;EACA,MAAMuD,WAAW,GAAG,MAAM;IACxBjE,QAAQ,CAACU,OAAT,CAAiBkD,KAAjB;EACD,CAFD,CArXqC,CAyXrC;;;EACA,MAAMM,aAAa,GAAIC,CAAD,IAAO;IAC3B/D,QAAQ,CAAC+D,CAAC,CAACC,OAAF,CAAUnF,QAAV,EAAD,CAAR,GAAiC,IAAjC;EACD,CAFD,CA1XqC,CA6XrC;;;EACA,MAAMoF,WAAW,GAAIF,CAAD,IAAO;IACzB/D,QAAQ,CAAC+D,CAAC,CAACC,OAAF,CAAUnF,QAAV,EAAD,CAAR,GAAiC,KAAjC;IACA6B,OAAO,CAACE,OAAR,CAAgB;MACdC,WAAW,EAAEJ,OADC;MAEdK,OAAO,EAAE;QAAE,gBAAgB;MAAlB,CAFK;MAGdC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;QACnBC,MAAM,EAAE;UACNC,IAAI,EAAE;QADA,CADW;QAInBC,IAAI,EAAE;UACJ7C,QAAQ,EAAED,UADN;UAEJkE,MAAM,EAAE,MAFJ;UAGJC,QAAQ,EAAE,IAHN;UAIJrE,CAAC,EAAE6B,EAAE,CAACK,OAJF;UAKJnC,CAAC,EAAE+B,EAAE,CAACI;QALF;MAJa,CAAf,CAHQ;MAedgB,uBAAuB,EAAE;IAfX,CAAhB;IAkBAlB,OAAO,CAACC,GAAR,CAAYJ,EAAE,CAACK,OAAH,GAAa,GAAb,GAAmBJ,EAAE,CAACI,OAAlC;EACD,CArBD;;EAuBA,oBACE;IACE,KAAK,EAAE;MACL4D,QAAQ,EAAE,UADL;MAEL5E,KAAK,EAAE,MAFF;MAGLC,MAAM,EAAE;IAHH,CADT;IAAA,wBAOE;MACE,OAAO,EAAE,MAAM;QACba,OAAO,CAACC,GAAR,CAAYJ,EAAE,CAACK,OAAH,GAAa,GAAb,GAAmBJ,EAAE,CAACI,OAAlC;MACD,CAHH;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAPF,eAcE;MACE,EAAE,EAAC,UADL;MAEE,KAAK,EAAC,qBAFR;MAGE,IAAI,EAAC,MAHP;MAIE,GAAG,EAAEV,QAJP;MAKE,SAAS,EAAEkE,aALb;MAME,OAAO,EAAEG,WANX;MAOE,QAAQ,MAPV;MAQE,KAAK,EAAE;QACLE,MAAM,EAAE,MADH;QAELC,MAAM,EAAE,SAFH;QAGLC,MAAM,EAAE,GAHH;QAILH,QAAQ,EAAE,UAJL;QAKL/B,GAAG,EAAE,CALA;QAMLD,IAAI,EAAE;MAND;IART;MAAA;MAAA;MAAA;IAAA,QAdF,eA+BE;MACE,EAAE,EAAC,KADL;MAEE,OAAO,EAAE2B,WAFX;MAGE,KAAK,EAAE;QACLvE,KAAK,EAAEJ,OADF;QAELK,MAAM,EAAEL,OAFH;QAGLkD,UAAU,EAAE,QAHP;QAIL8B,QAAQ,EAAE,UAJL;QAKLhC,IAAI,EAAE,CALD;QAMLC,GAAG,EAAE;MANA,CAHT;MAAA,wBAYE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACL7C,KAAK,EAAEH,KAAK,CAACG,KADR;UAELC,MAAM,EAAEJ,KAAK,CAACI,MAFT;UAGL2C,IAAI,EAAE/C,KAAK,CAACE,MAHP;UAIL8C,GAAG,EAAEhD,KAAK,CAACC,KAJN;UAKLgD,UAAU,EAAE,OALP;UAML8B,QAAQ,EAAE;QANL;MAFT;QAAA;QAAA;QAAA;MAAA,QAZF,EAwBG1E,MAAM,CAAC8E,GAAP,CAAW,CAACP,CAAD,EAAIQ,GAAJ,KAAY;QACtB,oBACE;UAEE,EAAE,EAAE,UAAUA,GAFhB;UAGE,KAAK,EAAE;YACLpC,GAAG,EAAE4B,CAAC,CAAC,CAAD,CADD;YAEL7B,IAAI,EAAE6B,CAAC,CAAC,CAAD,CAFF;YAGLxE,MAAM,EAAEG,SAHH;YAILJ,KAAK,EAAEI,SAJF;YAKL0C,UAAU,EAAE,MALP;YAML8B,QAAQ,EAAE;UANL;QAHT,GACOK,GADP;UAAA;UAAA;UAAA;QAAA,QADF;MAcD,CAfA,CAxBH,eAwCE;QACE,EAAE,EAAC,aADL;QAEE,KAAK,EAAE;UACLF,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAILyE,QAAQ,EAAE,UAJL;UAKL7C,KAAK,EAAE7C,OALF;UAML6D,OAAO,EAAE;QANJ,CAFT;QAAA,uBAWE;UAAK,KAAK,EAAE;YAAEF,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D,CAAZ;UAAA,UACG5D,UAAU,KAAKG,SAAf,GAA2BH,UAA3B,GAAwC;QAD3C;UAAA;UAAA;UAAA;QAAA;MAXF;QAAA;QAAA;QAAA;MAAA,QAxCF,eAyDE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACL+F,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAIL2C,UAAU,EAAE,KAJP;UAKL8B,QAAQ,EAAE,UALL;UAML7B,OAAO,EAAE,MANJ;UAOLH,IAAI,EAAEhE,OAAO,CAACE,CAPT;UAQL+D,GAAG,EAAEjE,OAAO,CAACC;QARR,CAFT;QAAA,uBAaE;UACE,EAAE,EAAC,WADL;UAEE,KAAK,EAAE;YAAEgE,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D;QAFT;UAAA;UAAA;UAAA;QAAA;MAbF;QAAA;QAAA;QAAA;MAAA,QAzDF,eA2EE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACLmC,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAIL2C,UAAU,EAAE,KAJP;UAKL8B,QAAQ,EAAE,UALL;UAML7B,OAAO,EAAE,MANJ;UAOLH,IAAI,EAAEhE,OAAO,CAACE,CAPT;UAQL+D,GAAG,EAAEjE,OAAO,CAACC;QARR,CAFT;QAAA,uBAaE;UACE,EAAE,EAAC,WADL;UAEE,KAAK,EAAE;YAAEgE,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D;QAFT;UAAA;UAAA;UAAA;QAAA;MAbF;QAAA;QAAA;QAAA;MAAA,QA3EF,eA6FE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACLmC,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAIL2C,UAAU,EAAE,KAJP;UAKL8B,QAAQ,EAAE,UALL;UAML7B,OAAO,EAAE,MANJ;UAOLH,IAAI,EAAEhE,OAAO,CAACE,CAPT;UAQL+D,GAAG,EAAEjE,OAAO,CAACC;QARR,CAFT;QAAA,uBAaE;UACE,EAAE,EAAC,WADL;UAEE,KAAK,EAAE;YAAEgE,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D;QAFT;UAAA;UAAA;UAAA;QAAA;MAbF;QAAA;QAAA;QAAA;MAAA,QA7FF,eA+GE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACLmC,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAIL2C,UAAU,EAAE,KAJP;UAKL8B,QAAQ,EAAE,UALL;UAML7B,OAAO,EAAE,MANJ;UAOLH,IAAI,EAAEhE,OAAO,CAACE,CAPT;UAQL+D,GAAG,EAAEjE,OAAO,CAACC;QARR,CAFT;QAAA,uBAaE;UACE,EAAE,EAAC,WADL;UAEE,KAAK,EAAE;YAAEgE,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D;QAFT;UAAA;UAAA;UAAA;QAAA;MAbF;QAAA;QAAA;QAAA;MAAA,QA/GF,eAiIE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACLmC,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAIL2C,UAAU,EAAE,KAJP;UAKL8B,QAAQ,EAAE,UALL;UAML7B,OAAO,EAAE,MANJ;UAOLH,IAAI,EAAEhE,OAAO,CAACE,CAPT;UAQL+D,GAAG,EAAEjE,OAAO,CAACC;QARR,CAFT;QAAA,uBAaE;UACE,EAAE,EAAC,WADL;UAEE,KAAK,EAAE;YAAEgE,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D;QAFT;UAAA;UAAA;UAAA;QAAA;MAbF;QAAA;QAAA;QAAA;MAAA,QAjIF,eAmJE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACLmC,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAIL2C,UAAU,EAAE,KAJP;UAKL8B,QAAQ,EAAE,UALL;UAML7B,OAAO,EAAE,MANJ;UAOLH,IAAI,EAAEhE,OAAO,CAACE,CAPT;UAQL+D,GAAG,EAAEjE,OAAO,CAACC;QARR,CAFT;QAAA,uBAaE;UACE,EAAE,EAAC,WADL;UAEE,KAAK,EAAE;YAAEgE,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D;QAFT;UAAA;UAAA;UAAA;QAAA;MAbF;QAAA;QAAA;QAAA;MAAA,QAnJF,eAqKE;QACE,EAAE,EAAC,OADL;QAEE,KAAK,EAAE;UACLmC,MAAM,EAAG,KADJ;UAEL/E,KAAK,EAAEG,QAFF;UAGLF,MAAM,EAAEE,QAHH;UAIL2C,UAAU,EAAE,KAJP;UAKL8B,QAAQ,EAAE,UALL;UAML7B,OAAO,EAAE,MANJ;UAOLH,IAAI,EAAEhE,OAAO,CAACE,CAPT;UAQL+D,GAAG,EAAEjE,OAAO,CAACC;QARR,CAFT;QAAA,uBAaE;UACE,EAAE,EAAC,WADL;UAEE,KAAK,EAAE;YAAEgE,GAAG,EAAE,CAAC,EAAR;YAAY7C,KAAK,EAAE,GAAnB;YAAwB4E,QAAQ,EAAE,UAAlC;YAA8ChC,IAAI,EAAE,CAAC,GAAD,GAAO;UAA3D;QAFT;UAAA;UAAA;UAAA;QAAA;MAbF;QAAA;QAAA;QAAA;MAAA,QArKF;IAAA;MAAA;MAAA;MAAA;IAAA,QA/BF;EAAA;IAAA;IAAA;IAAA;EAAA,QADF;AA0ND;;GA/mBuBnE,O;UAELR,W,EASED,W,EAILA,W,EAyCAA,W,EACAA,W;;;KAzDQS,O"},"metadata":{},"sourceType":"module"}