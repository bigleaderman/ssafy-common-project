{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"C:\\\\SSAFY\\\\2nd semester\\\\S07P12D106\\\\front\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nrequire(\"./VideoRoomComponent.css\");\n\nvar _openviduBrowser = require(\"openvidu-browser\");\n\nvar _StreamComponent = _interopRequireDefault(require(\"./stream/StreamComponent\"));\n\nvar _DialogExtension = _interopRequireDefault(require(\"./dialog-extension/DialogExtension\"));\n\nvar _ChatComponent = _interopRequireDefault(require(\"./chat/ChatComponent\"));\n\nvar _openviduLayout = _interopRequireDefault(require(\"../layout/openvidu-layout\"));\n\nvar _userModel = _interopRequireDefault(require(\"../models/user-model\"));\n\nvar _ToolbarComponent = _interopRequireDefault(require(\"./toolbar/ToolbarComponent\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar localUser = new _userModel[\"default\"]();\n\nvar VideoRoomComponent = /*#__PURE__*/function (_Component) {\n  _inherits(VideoRoomComponent, _Component);\n\n  var _super = _createSuper(VideoRoomComponent);\n\n  function VideoRoomComponent(props) {\n    var _this;\n\n    _classCallCheck(this, VideoRoomComponent);\n\n    _this = _super.call(this, props);\n    _this.OPENVIDU_SERVER_URL = _this.props.openviduServerUrl ? _this.props.openviduServerUrl : 'https://' + window.location.hostname + ':4443';\n    _this.OPENVIDU_SERVER_SECRET = _this.props.openviduSecret ? _this.props.openviduSecret : 'MY_SECRET';\n    _this.hasBeenUpdated = false;\n    _this.layout = new _openviduLayout[\"default\"]();\n    var sessionName = _this.props.sessionName ? _this.props.sessionName : 'SessionA';\n    var userName = _this.props.user ? _this.props.user : 'OpenVidu_User' + Math.floor(Math.random() * 100);\n    _this.remotes = [];\n    _this.localUserAccessAllowed = false;\n    _this.state = {\n      mySessionId: sessionName,\n      myUserName: userName,\n      session: undefined,\n      localUser: undefined,\n      subscribers: [],\n      chatDisplay: 'none',\n      currentVideoDevice: undefined\n    };\n    _this.joinSession = _this.joinSession.bind(_assertThisInitialized(_this));\n    _this.leaveSession = _this.leaveSession.bind(_assertThisInitialized(_this));\n    _this.onbeforeunload = _this.onbeforeunload.bind(_assertThisInitialized(_this));\n    _this.updateLayout = _this.updateLayout.bind(_assertThisInitialized(_this));\n    _this.camStatusChanged = _this.camStatusChanged.bind(_assertThisInitialized(_this));\n    _this.micStatusChanged = _this.micStatusChanged.bind(_assertThisInitialized(_this));\n    _this.nicknameChanged = _this.nicknameChanged.bind(_assertThisInitialized(_this));\n    _this.toggleFullscreen = _this.toggleFullscreen.bind(_assertThisInitialized(_this));\n    _this.switchCamera = _this.switchCamera.bind(_assertThisInitialized(_this));\n    _this.screenShare = _this.screenShare.bind(_assertThisInitialized(_this));\n    _this.stopScreenShare = _this.stopScreenShare.bind(_assertThisInitialized(_this));\n    _this.closeDialogExtension = _this.closeDialogExtension.bind(_assertThisInitialized(_this));\n    _this.toggleChat = _this.toggleChat.bind(_assertThisInitialized(_this));\n    _this.checkNotification = _this.checkNotification.bind(_assertThisInitialized(_this));\n    _this.checkSize = _this.checkSize.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(VideoRoomComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var openViduLayoutOptions = {\n        maxRatio: 3 / 2,\n        // The narrowest ratio that will be used (default 2x3)\n        minRatio: 9 / 16,\n        // The widest ratio that will be used (default 16x9)\n        fixedRatio: false,\n        // If this is true then the aspect ratio of the video is maintained and minRatio and maxRatio are ignored (default false)\n        bigClass: 'OV_big',\n        // The class to add to elements that should be sized bigger\n        bigPercentage: 0.8,\n        // The maximum percentage of space the big ones should take up\n        bigFixedRatio: false,\n        // fixedRatio for the big ones\n        bigMaxRatio: 3 / 2,\n        // The narrowest ratio to use for the big elements (default 2x3)\n        bigMinRatio: 9 / 16,\n        // The widest ratio to use for the big elements (default 16x9)\n        bigFirst: true,\n        // Whether to place the big one in the top left (true) or bottom right\n        animate: true // Whether you want to animate the transitions\n\n      };\n      this.layout.initLayoutContainer(document.getElementById('layout'), openViduLayoutOptions);\n      window.addEventListener('beforeunload', this.onbeforeunload);\n      window.addEventListener('resize', this.updateLayout);\n      window.addEventListener('resize', this.checkSize);\n      this.joinSession();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('beforeunload', this.onbeforeunload);\n      window.removeEventListener('resize', this.updateLayout);\n      window.removeEventListener('resize', this.checkSize);\n      this.leaveSession();\n    }\n  }, {\n    key: \"onbeforeunload\",\n    value: function onbeforeunload(event) {\n      this.leaveSession();\n    }\n  }, {\n    key: \"joinSession\",\n    value: function joinSession() {\n      var _this2 = this;\n\n      this.OV = new _openviduBrowser.OpenVidu();\n      this.setState({\n        session: this.OV.initSession()\n      }, function () {\n        _this2.subscribeToStreamCreated();\n\n        _this2.connectToSession();\n      });\n    }\n  }, {\n    key: \"connectToSession\",\n    value: function connectToSession() {\n      var _this3 = this;\n\n      if (this.props.token !== undefined) {\n        console.log('token received: ', this.props.token);\n        this.connect(this.props.token);\n      } else {\n        this.getToken().then(function (token) {\n          console.log(token);\n\n          _this3.connect(token);\n        })[\"catch\"](function (error) {\n          if (_this3.props.error) {\n            _this3.props.error({\n              error: error.error,\n              messgae: error.message,\n              code: error.code,\n              status: error.status\n            });\n          }\n\n          console.log('There was an error getting the token:', error.code, error.message);\n          alert('There was an error getting the token:', error.message);\n        });\n      }\n    }\n  }, {\n    key: \"connect\",\n    value: function connect(token) {\n      var _this4 = this;\n\n      this.state.session.connect(token, {\n        clientData: this.state.myUserName\n      }).then(function () {\n        _this4.connectWebCam();\n      })[\"catch\"](function (error) {\n        if (_this4.props.error) {\n          _this4.props.error({\n            error: error.error,\n            messgae: error.message,\n            code: error.code,\n            status: error.status\n          });\n        }\n\n        alert('There was an error connecting to the session:', error.message);\n        console.log('There was an error connecting to the session:', error.code, error.message);\n      });\n    }\n  }, {\n    key: \"connectWebCam\",\n    value: function () {\n      var _connectWebCam = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this5 = this;\n\n        var devices, videoDevices, publisher;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.OV.getDevices();\n\n              case 2:\n                devices = _context.sent;\n                videoDevices = devices.filter(function (device) {\n                  return device.kind === 'videoinput';\n                });\n                publisher = this.OV.initPublisher(undefined, {\n                  audioSource: undefined,\n                  videoSource: videoDevices[0].deviceId,\n                  publishAudio: localUser.isAudioActive(),\n                  publishVideo: localUser.isVideoActive(),\n                  resolution: '640x480',\n                  frameRate: 30,\n                  insertMode: 'APPEND'\n                });\n\n                if (this.state.session.capabilities.publish) {\n                  publisher.on('accessAllowed', function () {\n                    _this5.state.session.publish(publisher).then(function () {\n                      _this5.updateSubscribers();\n\n                      _this5.localUserAccessAllowed = true;\n\n                      if (_this5.props.joinSession) {\n                        _this5.props.joinSession();\n                      }\n                    });\n                  });\n                }\n\n                localUser.setNickname(this.state.myUserName);\n                localUser.setConnectionId(this.state.session.connection.connectionId);\n                localUser.setScreenShareActive(false);\n                localUser.setStreamManager(publisher);\n                this.subscribeToUserChanged();\n                this.subscribeToStreamDestroyed();\n                this.sendSignalUserChanged({\n                  isScreenShareActive: localUser.isScreenShareActive()\n                });\n                this.setState({\n                  currentVideoDevice: videoDevices[0],\n                  localUser: localUser\n                }, function () {\n                  _this5.state.localUser.getStreamManager().on('streamPlaying', function (e) {\n                    _this5.updateLayout();\n\n                    publisher.videos[0].video.parentElement.classList.remove('custom-class');\n                  });\n                });\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function connectWebCam() {\n        return _connectWebCam.apply(this, arguments);\n      }\n\n      return connectWebCam;\n    }()\n  }, {\n    key: \"updateSubscribers\",\n    value: function updateSubscribers() {\n      var _this6 = this;\n\n      var subscribers = this.remotes;\n      this.setState({\n        subscribers: subscribers\n      }, function () {\n        if (_this6.state.localUser) {\n          _this6.sendSignalUserChanged({\n            isAudioActive: _this6.state.localUser.isAudioActive(),\n            isVideoActive: _this6.state.localUser.isVideoActive(),\n            nickname: _this6.state.localUser.getNickname(),\n            isScreenShareActive: _this6.state.localUser.isScreenShareActive()\n          });\n        }\n\n        _this6.updateLayout();\n      });\n    }\n  }, {\n    key: \"leaveSession\",\n    value: function leaveSession() {\n      var mySession = this.state.session;\n\n      if (mySession) {\n        mySession.disconnect();\n      } // Empty all properties...\n\n\n      this.OV = null;\n      this.setState({\n        session: undefined,\n        subscribers: [],\n        mySessionId: 'SessionA',\n        myUserName: 'OpenVidu_User' + Math.floor(Math.random() * 100),\n        localUser: undefined\n      });\n\n      if (this.props.leaveSession) {\n        this.props.leaveSession();\n      }\n    }\n  }, {\n    key: \"camStatusChanged\",\n    value: function camStatusChanged() {\n      localUser.setVideoActive(!localUser.isVideoActive());\n      localUser.getStreamManager().publishVideo(localUser.isVideoActive());\n      this.sendSignalUserChanged({\n        isVideoActive: localUser.isVideoActive()\n      });\n      this.setState({\n        localUser: localUser\n      });\n    }\n  }, {\n    key: \"micStatusChanged\",\n    value: function micStatusChanged() {\n      localUser.setAudioActive(!localUser.isAudioActive());\n      localUser.getStreamManager().publishAudio(localUser.isAudioActive());\n      this.sendSignalUserChanged({\n        isAudioActive: localUser.isAudioActive()\n      });\n      this.setState({\n        localUser: localUser\n      });\n    }\n  }, {\n    key: \"nicknameChanged\",\n    value: function nicknameChanged(nickname) {\n      var localUser = this.state.localUser;\n      localUser.setNickname(nickname);\n      this.setState({\n        localUser: localUser\n      });\n      this.sendSignalUserChanged({\n        nickname: this.state.localUser.getNickname()\n      });\n    }\n  }, {\n    key: \"deleteSubscriber\",\n    value: function deleteSubscriber(stream) {\n      var remoteUsers = this.state.subscribers;\n      var userStream = remoteUsers.filter(function (user) {\n        return user.getStreamManager().stream === stream;\n      })[0];\n      var index = remoteUsers.indexOf(userStream, 0);\n\n      if (index > -1) {\n        remoteUsers.splice(index, 1);\n        this.setState({\n          subscribers: remoteUsers\n        });\n      }\n    }\n  }, {\n    key: \"subscribeToStreamCreated\",\n    value: function subscribeToStreamCreated() {\n      var _this7 = this;\n\n      this.state.session.on('streamCreated', function (event) {\n        var subscriber = _this7.state.session.subscribe(event.stream, undefined); // var subscribers = this.state.subscribers;\n\n\n        subscriber.on('streamPlaying', function (e) {\n          _this7.checkSomeoneShareScreen();\n\n          subscriber.videos[0].video.parentElement.classList.remove('custom-class');\n        });\n        var newUser = new _userModel[\"default\"]();\n        newUser.setStreamManager(subscriber);\n        newUser.setConnectionId(event.stream.connection.connectionId);\n        newUser.setType('remote');\n        var nickname = event.stream.connection.data.split('%')[0];\n        newUser.setNickname(JSON.parse(nickname).clientData);\n\n        _this7.remotes.push(newUser);\n\n        if (_this7.localUserAccessAllowed) {\n          _this7.updateSubscribers();\n        }\n      });\n    }\n  }, {\n    key: \"subscribeToStreamDestroyed\",\n    value: function subscribeToStreamDestroyed() {\n      var _this8 = this; // On every Stream destroyed...\n\n\n      this.state.session.on('streamDestroyed', function (event) {\n        // Remove the stream from 'subscribers' array\n        _this8.deleteSubscriber(event.stream);\n\n        setTimeout(function () {\n          _this8.checkSomeoneShareScreen();\n        }, 20);\n        event.preventDefault();\n\n        _this8.updateLayout();\n      });\n    }\n  }, {\n    key: \"subscribeToUserChanged\",\n    value: function subscribeToUserChanged() {\n      var _this9 = this;\n\n      this.state.session.on('signal:userChanged', function (event) {\n        var remoteUsers = _this9.state.subscribers;\n        remoteUsers.forEach(function (user) {\n          if (user.getConnectionId() === event.from.connectionId) {\n            var data = JSON.parse(event.data);\n            console.log('EVENTO REMOTE: ', event.data);\n\n            if (data.isAudioActive !== undefined) {\n              user.setAudioActive(data.isAudioActive);\n            }\n\n            if (data.isVideoActive !== undefined) {\n              user.setVideoActive(data.isVideoActive);\n            }\n\n            if (data.nickname !== undefined) {\n              user.setNickname(data.nickname);\n            }\n\n            if (data.isScreenShareActive !== undefined) {\n              user.setScreenShareActive(data.isScreenShareActive);\n            }\n          }\n        });\n\n        _this9.setState({\n          subscribers: remoteUsers\n        }, function () {\n          return _this9.checkSomeoneShareScreen();\n        });\n      });\n    }\n  }, {\n    key: \"updateLayout\",\n    value: function updateLayout() {\n      var _this10 = this;\n\n      setTimeout(function () {\n        _this10.layout.updateLayout();\n      }, 20);\n    }\n  }, {\n    key: \"sendSignalUserChanged\",\n    value: function sendSignalUserChanged(data) {\n      var signalOptions = {\n        data: JSON.stringify(data),\n        type: 'userChanged'\n      };\n      this.state.session.signal(signalOptions);\n    }\n  }, {\n    key: \"toggleFullscreen\",\n    value: function toggleFullscreen() {\n      var document = window.document;\n      var fs = document.getElementById('container');\n\n      if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {\n        if (fs.requestFullscreen) {\n          fs.requestFullscreen();\n        } else if (fs.msRequestFullscreen) {\n          fs.msRequestFullscreen();\n        } else if (fs.mozRequestFullScreen) {\n          fs.mozRequestFullScreen();\n        } else if (fs.webkitRequestFullscreen) {\n          fs.webkitRequestFullscreen();\n        }\n      } else {\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    }\n  }, {\n    key: \"switchCamera\",\n    value: function () {\n      var _switchCamera = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _this11 = this;\n\n        var devices, videoDevices, newVideoDevice, newPublisher;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return this.OV.getDevices();\n\n              case 3:\n                devices = _context2.sent;\n                videoDevices = devices.filter(function (device) {\n                  return device.kind === 'videoinput';\n                });\n\n                if (!(videoDevices && videoDevices.length > 1)) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                newVideoDevice = videoDevices.filter(function (device) {\n                  return device.deviceId !== _this11.state.currentVideoDevice.deviceId;\n                });\n\n                if (!(newVideoDevice.length > 0)) {\n                  _context2.next = 15;\n                  break;\n                } // Creating a new publisher with specific videoSource\n                // In mobile devices the default and first camera is the front one\n\n\n                newPublisher = this.OV.initPublisher(undefined, {\n                  audioSource: undefined,\n                  videoSource: newVideoDevice[0].deviceId,\n                  publishAudio: localUser.isAudioActive(),\n                  publishVideo: localUser.isVideoActive(),\n                  mirror: true\n                }); //newPublisher.once(\"accessAllowed\", () => {\n\n                _context2.next = 11;\n                return this.state.session.unpublish(this.state.localUser.getStreamManager());\n\n              case 11:\n                _context2.next = 13;\n                return this.state.session.publish(newPublisher);\n\n              case 13:\n                this.state.localUser.setStreamManager(newPublisher);\n                this.setState({\n                  currentVideoDevice: newVideoDevice,\n                  localUser: localUser\n                });\n\n              case 15:\n                _context2.next = 20;\n                break;\n\n              case 17:\n                _context2.prev = 17;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.error(_context2.t0);\n\n              case 20:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 17]]);\n      }));\n\n      function switchCamera() {\n        return _switchCamera.apply(this, arguments);\n      }\n\n      return switchCamera;\n    }()\n  }, {\n    key: \"screenShare\",\n    value: function screenShare() {\n      var _this12 = this;\n\n      var videoSource = navigator.userAgent.indexOf('Firefox') !== -1 ? 'window' : 'screen';\n      var publisher = this.OV.initPublisher(undefined, {\n        videoSource: videoSource,\n        publishAudio: localUser.isAudioActive(),\n        publishVideo: localUser.isVideoActive(),\n        mirror: false\n      }, function (error) {\n        if (error && error.name === 'SCREEN_EXTENSION_NOT_INSTALLED') {\n          _this12.setState({\n            showExtensionDialog: true\n          });\n        } else if (error && error.name === 'SCREEN_SHARING_NOT_SUPPORTED') {\n          alert('Your browser does not support screen sharing');\n        } else if (error && error.name === 'SCREEN_EXTENSION_DISABLED') {\n          alert('You need to enable screen sharing extension');\n        } else if (error && error.name === 'SCREEN_CAPTURE_DENIED') {\n          alert('You need to choose a window or application to share');\n        }\n      });\n      publisher.once('accessAllowed', function () {\n        _this12.state.session.unpublish(localUser.getStreamManager());\n\n        localUser.setStreamManager(publisher);\n\n        _this12.state.session.publish(localUser.getStreamManager()).then(function () {\n          localUser.setScreenShareActive(true);\n\n          _this12.setState({\n            localUser: localUser\n          }, function () {\n            _this12.sendSignalUserChanged({\n              isScreenShareActive: localUser.isScreenShareActive()\n            });\n          });\n        });\n      });\n      publisher.on('streamPlaying', function () {\n        _this12.updateLayout();\n\n        publisher.videos[0].video.parentElement.classList.remove('custom-class');\n      });\n    }\n  }, {\n    key: \"closeDialogExtension\",\n    value: function closeDialogExtension() {\n      this.setState({\n        showExtensionDialog: false\n      });\n    }\n  }, {\n    key: \"stopScreenShare\",\n    value: function stopScreenShare() {\n      this.state.session.unpublish(localUser.getStreamManager());\n      this.connectWebCam();\n    }\n  }, {\n    key: \"checkSomeoneShareScreen\",\n    value: function checkSomeoneShareScreen() {\n      var isScreenShared; // return true if at least one passes the test\n\n      isScreenShared = this.state.subscribers.some(function (user) {\n        return user.isScreenShareActive();\n      }) || localUser.isScreenShareActive();\n      var openviduLayoutOptions = {\n        maxRatio: 3 / 2,\n        minRatio: 9 / 16,\n        fixedRatio: isScreenShared,\n        bigClass: 'OV_big',\n        bigPercentage: 0.8,\n        bigFixedRatio: false,\n        bigMaxRatio: 3 / 2,\n        bigMinRatio: 9 / 16,\n        bigFirst: true,\n        animate: true\n      };\n      this.layout.setLayoutOptions(openviduLayoutOptions);\n      this.updateLayout();\n    }\n  }, {\n    key: \"toggleChat\",\n    value: function toggleChat(property) {\n      var display = property;\n\n      if (display === undefined) {\n        display = this.state.chatDisplay === 'none' ? 'block' : 'none';\n      }\n\n      if (display === 'block') {\n        this.setState({\n          chatDisplay: display,\n          messageReceived: false\n        });\n      } else {\n        console.log('chat', display);\n        this.setState({\n          chatDisplay: display\n        });\n      }\n\n      this.updateLayout();\n    }\n  }, {\n    key: \"checkNotification\",\n    value: function checkNotification(event) {\n      this.setState({\n        messageReceived: this.state.chatDisplay === 'none'\n      });\n    }\n  }, {\n    key: \"checkSize\",\n    value: function checkSize() {\n      if (document.getElementById('layout').offsetWidth <= 700 && !this.hasBeenUpdated) {\n        this.toggleChat('none');\n        this.hasBeenUpdated = true;\n      }\n\n      if (document.getElementById('layout').offsetWidth > 700 && this.hasBeenUpdated) {\n        this.hasBeenUpdated = false;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var mySessionId = this.state.mySessionId;\n      var localUser = this.state.localUser;\n      var chatDisplay = {\n        display: this.state.chatDisplay\n      };\n      return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: \"container\",\n        id: \"container\"\n      }, /*#__PURE__*/_react[\"default\"].createElement(_ToolbarComponent[\"default\"], {\n        sessionId: mySessionId,\n        user: localUser,\n        showNotification: this.state.messageReceived,\n        camStatusChanged: this.camStatusChanged,\n        micStatusChanged: this.micStatusChanged,\n        screenShare: this.screenShare,\n        stopScreenShare: this.stopScreenShare,\n        toggleFullscreen: this.toggleFullscreen,\n        switchCamera: this.switchCamera,\n        leaveSession: this.leaveSession,\n        toggleChat: this.toggleChat\n      }), /*#__PURE__*/_react[\"default\"].createElement(_DialogExtension[\"default\"], {\n        showDialog: this.state.showExtensionDialog,\n        cancelClicked: this.closeDialogExtension\n      }), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        id: \"layout\",\n        className: \"bounds\"\n      }, localUser !== undefined && localUser.getStreamManager() !== undefined && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: \"OT_root OT_publisher custom-class\",\n        id: \"localUser\"\n      }, /*#__PURE__*/_react[\"default\"].createElement(_StreamComponent[\"default\"], {\n        user: localUser,\n        handleNickname: this.nicknameChanged\n      })), this.state.subscribers.map(function (sub, i) {\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          key: i,\n          className: \"OT_root OT_publisher custom-class\",\n          id: \"remoteUsers\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_StreamComponent[\"default\"], {\n          user: sub,\n          streamId: sub.streamManager.stream.streamId\n        }));\n      }), localUser !== undefined && localUser.getStreamManager() !== undefined && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: \"OT_root OT_publisher custom-class\",\n        style: chatDisplay\n      }, /*#__PURE__*/_react[\"default\"].createElement(_ChatComponent[\"default\"], {\n        user: localUser,\n        chatDisplay: this.state.chatDisplay,\n        close: this.toggleChat,\n        messageReceived: this.checkNotification\n      }))));\n    }\n    /**\n     * --------------------------\n     * SERVER-SIDE RESPONSIBILITY\n     * --------------------------\n     * These methods retrieve the mandatory user token from OpenVidu Server.\n     * This behaviour MUST BE IN YOUR SERVER-SIDE IN PRODUCTION (by using\n     * the API REST, openvidu-java-client or openvidu-node-client):\n     *   1) Initialize a session in OpenVidu Server\t(POST /api/sessions)\n     *   2) Generate a token in OpenVidu Server\t\t(POST /api/tokens)\n     *   3) The token must be consumed in Session.connect() method\n     */\n\n  }, {\n    key: \"getToken\",\n    value: function getToken() {\n      var _this13 = this;\n\n      return this.createSession(this.state.mySessionId).then(function (sessionId) {\n        return _this13.createToken(sessionId);\n      });\n    }\n  }, {\n    key: \"createSession\",\n    value: function createSession(sessionId) {\n      var _this14 = this;\n\n      return new Promise(function (resolve, reject) {\n        var data = JSON.stringify({\n          customSessionId: sessionId\n        });\n\n        _axios[\"default\"].post(_this14.OPENVIDU_SERVER_URL + '/openvidu/api/sessions', data, {\n          headers: {\n            Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this14.OPENVIDU_SERVER_SECRET),\n            'Content-Type': 'application/json'\n          }\n        }).then(function (response) {\n          console.log('CREATE SESION', response);\n          resolve(response.data.id);\n        })[\"catch\"](function (response) {\n          var error = Object.assign({}, response);\n\n          if (error.response && error.response.status === 409) {\n            resolve(sessionId);\n          } else {\n            console.log(error);\n            console.warn('No connection to OpenVidu Server. This may be a certificate error at ' + _this14.OPENVIDU_SERVER_URL);\n\n            if (window.confirm('No connection to OpenVidu Server. This may be a certificate error at \"' + _this14.OPENVIDU_SERVER_URL + '\"\\n\\nClick OK to navigate and accept it. ' + 'If no certificate warning is shown, then check that your OpenVidu Server is up and running at \"' + _this14.OPENVIDU_SERVER_URL + '\"')) {\n              window.location.assign(_this14.OPENVIDU_SERVER_URL + '/accept-certificate');\n            }\n          }\n        });\n      });\n    }\n  }, {\n    key: \"createToken\",\n    value: function createToken(sessionId) {\n      var _this15 = this;\n\n      return new Promise(function (resolve, reject) {\n        var data = JSON.stringify({});\n\n        _axios[\"default\"].post(_this15.OPENVIDU_SERVER_URL + '/openvidu/api/sessions/' + sessionId + '/connection', data, {\n          headers: {\n            Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this15.OPENVIDU_SERVER_SECRET),\n            'Content-Type': 'application/json'\n          }\n        }).then(function (response) {\n          console.log('TOKEN', response);\n          resolve(response.data.token);\n        })[\"catch\"](function (error) {\n          return reject(error);\n        });\n      });\n    }\n  }]);\n\n  return VideoRoomComponent;\n}(_react.Component);\n\nvar _default = VideoRoomComponent;\nexports[\"default\"] = _default;","map":{"version":3,"names":["Object","defineProperty","exports","value","_react","_interopRequireWildcard","require","_axios","_interopRequireDefault","_openviduBrowser","_StreamComponent","_DialogExtension","_ChatComponent","_openviduLayout","_userModel","_ToolbarComponent","obj","__esModule","_getRequireWildcardCache","WeakMap","cache","_typeof","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","Symbol","iterator","constructor","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","localUser","VideoRoomComponent","_Component","_super","_this","OPENVIDU_SERVER_URL","openviduServerUrl","window","location","hostname","OPENVIDU_SERVER_SECRET","openviduSecret","hasBeenUpdated","layout","sessionName","userName","user","Math","floor","random","remotes","localUserAccessAllowed","state","mySessionId","myUserName","session","subscribers","chatDisplay","currentVideoDevice","joinSession","bind","leaveSession","onbeforeunload","updateLayout","camStatusChanged","micStatusChanged","nicknameChanged","toggleFullscreen","switchCamera","screenShare","stopScreenShare","closeDialogExtension","toggleChat","checkNotification","checkSize","componentDidMount","openViduLayoutOptions","maxRatio","minRatio","fixedRatio","bigClass","bigPercentage","bigFixedRatio","bigMaxRatio","bigMinRatio","bigFirst","animate","initLayoutContainer","document","getElementById","addEventListener","componentWillUnmount","removeEventListener","event","_this2","OV","OpenVidu","setState","initSession","subscribeToStreamCreated","connectToSession","_this3","token","console","log","connect","getToken","messgae","message","code","status","alert","_this4","clientData","connectWebCam","_connectWebCam","mark","_callee","_this5","devices","videoDevices","publisher","wrap","_callee$","_context","prev","next","getDevices","sent","filter","device","kind","initPublisher","audioSource","videoSource","deviceId","publishAudio","isAudioActive","publishVideo","isVideoActive","resolution","frameRate","insertMode","capabilities","publish","on","updateSubscribers","setNickname","setConnectionId","connection","connectionId","setScreenShareActive","setStreamManager","subscribeToUserChanged","subscribeToStreamDestroyed","sendSignalUserChanged","isScreenShareActive","getStreamManager","videos","video","parentElement","classList","remove","stop","_this6","nickname","getNickname","mySession","disconnect","setVideoActive","setAudioActive","deleteSubscriber","stream","remoteUsers","userStream","index","indexOf","splice","_this7","subscriber","subscribe","checkSomeoneShareScreen","newUser","setType","data","split","JSON","parse","push","_this8","setTimeout","preventDefault","_this9","forEach","getConnectionId","from","_this10","signalOptions","stringify","type","signal","fs","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","_switchCamera","_callee2","_this11","newVideoDevice","newPublisher","_callee2$","_context2","mirror","unpublish","t0","_this12","navigator","userAgent","name","showExtensionDialog","once","isScreenShared","some","openviduLayoutOptions","setLayoutOptions","property","display","messageReceived","offsetWidth","render","createElement","className","id","sessionId","showNotification","showDialog","cancelClicked","handleNickname","map","sub","streamId","streamManager","style","close","_this13","createSession","createToken","_this14","customSessionId","post","headers","Authorization","btoa","response","assign","warn","confirm","_this15","Component","_default"],"sources":["C:/SSAFY/2nd semester/S07P12D106/front/node_modules/openvidu-react/dist/components/VideoRoomComponent.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nrequire(\"./VideoRoomComponent.css\");\n\nvar _openviduBrowser = require(\"openvidu-browser\");\n\nvar _StreamComponent = _interopRequireDefault(require(\"./stream/StreamComponent\"));\n\nvar _DialogExtension = _interopRequireDefault(require(\"./dialog-extension/DialogExtension\"));\n\nvar _ChatComponent = _interopRequireDefault(require(\"./chat/ChatComponent\"));\n\nvar _openviduLayout = _interopRequireDefault(require(\"../layout/openvidu-layout\"));\n\nvar _userModel = _interopRequireDefault(require(\"../models/user-model\"));\n\nvar _ToolbarComponent = _interopRequireDefault(require(\"./toolbar/ToolbarComponent\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar localUser = new _userModel[\"default\"]();\n\nvar VideoRoomComponent = /*#__PURE__*/function (_Component) {\n  _inherits(VideoRoomComponent, _Component);\n\n  var _super = _createSuper(VideoRoomComponent);\n\n  function VideoRoomComponent(props) {\n    var _this;\n\n    _classCallCheck(this, VideoRoomComponent);\n\n    _this = _super.call(this, props);\n    _this.OPENVIDU_SERVER_URL = _this.props.openviduServerUrl ? _this.props.openviduServerUrl : 'https://' + window.location.hostname + ':4443';\n    _this.OPENVIDU_SERVER_SECRET = _this.props.openviduSecret ? _this.props.openviduSecret : 'MY_SECRET';\n    _this.hasBeenUpdated = false;\n    _this.layout = new _openviduLayout[\"default\"]();\n    var sessionName = _this.props.sessionName ? _this.props.sessionName : 'SessionA';\n    var userName = _this.props.user ? _this.props.user : 'OpenVidu_User' + Math.floor(Math.random() * 100);\n    _this.remotes = [];\n    _this.localUserAccessAllowed = false;\n    _this.state = {\n      mySessionId: sessionName,\n      myUserName: userName,\n      session: undefined,\n      localUser: undefined,\n      subscribers: [],\n      chatDisplay: 'none',\n      currentVideoDevice: undefined\n    };\n    _this.joinSession = _this.joinSession.bind(_assertThisInitialized(_this));\n    _this.leaveSession = _this.leaveSession.bind(_assertThisInitialized(_this));\n    _this.onbeforeunload = _this.onbeforeunload.bind(_assertThisInitialized(_this));\n    _this.updateLayout = _this.updateLayout.bind(_assertThisInitialized(_this));\n    _this.camStatusChanged = _this.camStatusChanged.bind(_assertThisInitialized(_this));\n    _this.micStatusChanged = _this.micStatusChanged.bind(_assertThisInitialized(_this));\n    _this.nicknameChanged = _this.nicknameChanged.bind(_assertThisInitialized(_this));\n    _this.toggleFullscreen = _this.toggleFullscreen.bind(_assertThisInitialized(_this));\n    _this.switchCamera = _this.switchCamera.bind(_assertThisInitialized(_this));\n    _this.screenShare = _this.screenShare.bind(_assertThisInitialized(_this));\n    _this.stopScreenShare = _this.stopScreenShare.bind(_assertThisInitialized(_this));\n    _this.closeDialogExtension = _this.closeDialogExtension.bind(_assertThisInitialized(_this));\n    _this.toggleChat = _this.toggleChat.bind(_assertThisInitialized(_this));\n    _this.checkNotification = _this.checkNotification.bind(_assertThisInitialized(_this));\n    _this.checkSize = _this.checkSize.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(VideoRoomComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var openViduLayoutOptions = {\n        maxRatio: 3 / 2,\n        // The narrowest ratio that will be used (default 2x3)\n        minRatio: 9 / 16,\n        // The widest ratio that will be used (default 16x9)\n        fixedRatio: false,\n        // If this is true then the aspect ratio of the video is maintained and minRatio and maxRatio are ignored (default false)\n        bigClass: 'OV_big',\n        // The class to add to elements that should be sized bigger\n        bigPercentage: 0.8,\n        // The maximum percentage of space the big ones should take up\n        bigFixedRatio: false,\n        // fixedRatio for the big ones\n        bigMaxRatio: 3 / 2,\n        // The narrowest ratio to use for the big elements (default 2x3)\n        bigMinRatio: 9 / 16,\n        // The widest ratio to use for the big elements (default 16x9)\n        bigFirst: true,\n        // Whether to place the big one in the top left (true) or bottom right\n        animate: true // Whether you want to animate the transitions\n\n      };\n      this.layout.initLayoutContainer(document.getElementById('layout'), openViduLayoutOptions);\n      window.addEventListener('beforeunload', this.onbeforeunload);\n      window.addEventListener('resize', this.updateLayout);\n      window.addEventListener('resize', this.checkSize);\n      this.joinSession();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('beforeunload', this.onbeforeunload);\n      window.removeEventListener('resize', this.updateLayout);\n      window.removeEventListener('resize', this.checkSize);\n      this.leaveSession();\n    }\n  }, {\n    key: \"onbeforeunload\",\n    value: function onbeforeunload(event) {\n      this.leaveSession();\n    }\n  }, {\n    key: \"joinSession\",\n    value: function joinSession() {\n      var _this2 = this;\n\n      this.OV = new _openviduBrowser.OpenVidu();\n      this.setState({\n        session: this.OV.initSession()\n      }, function () {\n        _this2.subscribeToStreamCreated();\n\n        _this2.connectToSession();\n      });\n    }\n  }, {\n    key: \"connectToSession\",\n    value: function connectToSession() {\n      var _this3 = this;\n\n      if (this.props.token !== undefined) {\n        console.log('token received: ', this.props.token);\n        this.connect(this.props.token);\n      } else {\n        this.getToken().then(function (token) {\n          console.log(token);\n\n          _this3.connect(token);\n        })[\"catch\"](function (error) {\n          if (_this3.props.error) {\n            _this3.props.error({\n              error: error.error,\n              messgae: error.message,\n              code: error.code,\n              status: error.status\n            });\n          }\n\n          console.log('There was an error getting the token:', error.code, error.message);\n          alert('There was an error getting the token:', error.message);\n        });\n      }\n    }\n  }, {\n    key: \"connect\",\n    value: function connect(token) {\n      var _this4 = this;\n\n      this.state.session.connect(token, {\n        clientData: this.state.myUserName\n      }).then(function () {\n        _this4.connectWebCam();\n      })[\"catch\"](function (error) {\n        if (_this4.props.error) {\n          _this4.props.error({\n            error: error.error,\n            messgae: error.message,\n            code: error.code,\n            status: error.status\n          });\n        }\n\n        alert('There was an error connecting to the session:', error.message);\n        console.log('There was an error connecting to the session:', error.code, error.message);\n      });\n    }\n  }, {\n    key: \"connectWebCam\",\n    value: function () {\n      var _connectWebCam = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this5 = this;\n\n        var devices, videoDevices, publisher;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.OV.getDevices();\n\n              case 2:\n                devices = _context.sent;\n                videoDevices = devices.filter(function (device) {\n                  return device.kind === 'videoinput';\n                });\n                publisher = this.OV.initPublisher(undefined, {\n                  audioSource: undefined,\n                  videoSource: videoDevices[0].deviceId,\n                  publishAudio: localUser.isAudioActive(),\n                  publishVideo: localUser.isVideoActive(),\n                  resolution: '640x480',\n                  frameRate: 30,\n                  insertMode: 'APPEND'\n                });\n\n                if (this.state.session.capabilities.publish) {\n                  publisher.on('accessAllowed', function () {\n                    _this5.state.session.publish(publisher).then(function () {\n                      _this5.updateSubscribers();\n\n                      _this5.localUserAccessAllowed = true;\n\n                      if (_this5.props.joinSession) {\n                        _this5.props.joinSession();\n                      }\n                    });\n                  });\n                }\n\n                localUser.setNickname(this.state.myUserName);\n                localUser.setConnectionId(this.state.session.connection.connectionId);\n                localUser.setScreenShareActive(false);\n                localUser.setStreamManager(publisher);\n                this.subscribeToUserChanged();\n                this.subscribeToStreamDestroyed();\n                this.sendSignalUserChanged({\n                  isScreenShareActive: localUser.isScreenShareActive()\n                });\n                this.setState({\n                  currentVideoDevice: videoDevices[0],\n                  localUser: localUser\n                }, function () {\n                  _this5.state.localUser.getStreamManager().on('streamPlaying', function (e) {\n                    _this5.updateLayout();\n\n                    publisher.videos[0].video.parentElement.classList.remove('custom-class');\n                  });\n                });\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function connectWebCam() {\n        return _connectWebCam.apply(this, arguments);\n      }\n\n      return connectWebCam;\n    }()\n  }, {\n    key: \"updateSubscribers\",\n    value: function updateSubscribers() {\n      var _this6 = this;\n\n      var subscribers = this.remotes;\n      this.setState({\n        subscribers: subscribers\n      }, function () {\n        if (_this6.state.localUser) {\n          _this6.sendSignalUserChanged({\n            isAudioActive: _this6.state.localUser.isAudioActive(),\n            isVideoActive: _this6.state.localUser.isVideoActive(),\n            nickname: _this6.state.localUser.getNickname(),\n            isScreenShareActive: _this6.state.localUser.isScreenShareActive()\n          });\n        }\n\n        _this6.updateLayout();\n      });\n    }\n  }, {\n    key: \"leaveSession\",\n    value: function leaveSession() {\n      var mySession = this.state.session;\n\n      if (mySession) {\n        mySession.disconnect();\n      } // Empty all properties...\n\n\n      this.OV = null;\n      this.setState({\n        session: undefined,\n        subscribers: [],\n        mySessionId: 'SessionA',\n        myUserName: 'OpenVidu_User' + Math.floor(Math.random() * 100),\n        localUser: undefined\n      });\n\n      if (this.props.leaveSession) {\n        this.props.leaveSession();\n      }\n    }\n  }, {\n    key: \"camStatusChanged\",\n    value: function camStatusChanged() {\n      localUser.setVideoActive(!localUser.isVideoActive());\n      localUser.getStreamManager().publishVideo(localUser.isVideoActive());\n      this.sendSignalUserChanged({\n        isVideoActive: localUser.isVideoActive()\n      });\n      this.setState({\n        localUser: localUser\n      });\n    }\n  }, {\n    key: \"micStatusChanged\",\n    value: function micStatusChanged() {\n      localUser.setAudioActive(!localUser.isAudioActive());\n      localUser.getStreamManager().publishAudio(localUser.isAudioActive());\n      this.sendSignalUserChanged({\n        isAudioActive: localUser.isAudioActive()\n      });\n      this.setState({\n        localUser: localUser\n      });\n    }\n  }, {\n    key: \"nicknameChanged\",\n    value: function nicknameChanged(nickname) {\n      var localUser = this.state.localUser;\n      localUser.setNickname(nickname);\n      this.setState({\n        localUser: localUser\n      });\n      this.sendSignalUserChanged({\n        nickname: this.state.localUser.getNickname()\n      });\n    }\n  }, {\n    key: \"deleteSubscriber\",\n    value: function deleteSubscriber(stream) {\n      var remoteUsers = this.state.subscribers;\n      var userStream = remoteUsers.filter(function (user) {\n        return user.getStreamManager().stream === stream;\n      })[0];\n      var index = remoteUsers.indexOf(userStream, 0);\n\n      if (index > -1) {\n        remoteUsers.splice(index, 1);\n        this.setState({\n          subscribers: remoteUsers\n        });\n      }\n    }\n  }, {\n    key: \"subscribeToStreamCreated\",\n    value: function subscribeToStreamCreated() {\n      var _this7 = this;\n\n      this.state.session.on('streamCreated', function (event) {\n        var subscriber = _this7.state.session.subscribe(event.stream, undefined); // var subscribers = this.state.subscribers;\n\n\n        subscriber.on('streamPlaying', function (e) {\n          _this7.checkSomeoneShareScreen();\n\n          subscriber.videos[0].video.parentElement.classList.remove('custom-class');\n        });\n        var newUser = new _userModel[\"default\"]();\n        newUser.setStreamManager(subscriber);\n        newUser.setConnectionId(event.stream.connection.connectionId);\n        newUser.setType('remote');\n        var nickname = event.stream.connection.data.split('%')[0];\n        newUser.setNickname(JSON.parse(nickname).clientData);\n\n        _this7.remotes.push(newUser);\n\n        if (_this7.localUserAccessAllowed) {\n          _this7.updateSubscribers();\n        }\n      });\n    }\n  }, {\n    key: \"subscribeToStreamDestroyed\",\n    value: function subscribeToStreamDestroyed() {\n      var _this8 = this;\n\n      // On every Stream destroyed...\n      this.state.session.on('streamDestroyed', function (event) {\n        // Remove the stream from 'subscribers' array\n        _this8.deleteSubscriber(event.stream);\n\n        setTimeout(function () {\n          _this8.checkSomeoneShareScreen();\n        }, 20);\n        event.preventDefault();\n\n        _this8.updateLayout();\n      });\n    }\n  }, {\n    key: \"subscribeToUserChanged\",\n    value: function subscribeToUserChanged() {\n      var _this9 = this;\n\n      this.state.session.on('signal:userChanged', function (event) {\n        var remoteUsers = _this9.state.subscribers;\n        remoteUsers.forEach(function (user) {\n          if (user.getConnectionId() === event.from.connectionId) {\n            var data = JSON.parse(event.data);\n            console.log('EVENTO REMOTE: ', event.data);\n\n            if (data.isAudioActive !== undefined) {\n              user.setAudioActive(data.isAudioActive);\n            }\n\n            if (data.isVideoActive !== undefined) {\n              user.setVideoActive(data.isVideoActive);\n            }\n\n            if (data.nickname !== undefined) {\n              user.setNickname(data.nickname);\n            }\n\n            if (data.isScreenShareActive !== undefined) {\n              user.setScreenShareActive(data.isScreenShareActive);\n            }\n          }\n        });\n\n        _this9.setState({\n          subscribers: remoteUsers\n        }, function () {\n          return _this9.checkSomeoneShareScreen();\n        });\n      });\n    }\n  }, {\n    key: \"updateLayout\",\n    value: function updateLayout() {\n      var _this10 = this;\n\n      setTimeout(function () {\n        _this10.layout.updateLayout();\n      }, 20);\n    }\n  }, {\n    key: \"sendSignalUserChanged\",\n    value: function sendSignalUserChanged(data) {\n      var signalOptions = {\n        data: JSON.stringify(data),\n        type: 'userChanged'\n      };\n      this.state.session.signal(signalOptions);\n    }\n  }, {\n    key: \"toggleFullscreen\",\n    value: function toggleFullscreen() {\n      var document = window.document;\n      var fs = document.getElementById('container');\n\n      if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {\n        if (fs.requestFullscreen) {\n          fs.requestFullscreen();\n        } else if (fs.msRequestFullscreen) {\n          fs.msRequestFullscreen();\n        } else if (fs.mozRequestFullScreen) {\n          fs.mozRequestFullScreen();\n        } else if (fs.webkitRequestFullscreen) {\n          fs.webkitRequestFullscreen();\n        }\n      } else {\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    }\n  }, {\n    key: \"switchCamera\",\n    value: function () {\n      var _switchCamera = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _this11 = this;\n\n        var devices, videoDevices, newVideoDevice, newPublisher;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return this.OV.getDevices();\n\n              case 3:\n                devices = _context2.sent;\n                videoDevices = devices.filter(function (device) {\n                  return device.kind === 'videoinput';\n                });\n\n                if (!(videoDevices && videoDevices.length > 1)) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                newVideoDevice = videoDevices.filter(function (device) {\n                  return device.deviceId !== _this11.state.currentVideoDevice.deviceId;\n                });\n\n                if (!(newVideoDevice.length > 0)) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                // Creating a new publisher with specific videoSource\n                // In mobile devices the default and first camera is the front one\n                newPublisher = this.OV.initPublisher(undefined, {\n                  audioSource: undefined,\n                  videoSource: newVideoDevice[0].deviceId,\n                  publishAudio: localUser.isAudioActive(),\n                  publishVideo: localUser.isVideoActive(),\n                  mirror: true\n                }); //newPublisher.once(\"accessAllowed\", () => {\n\n                _context2.next = 11;\n                return this.state.session.unpublish(this.state.localUser.getStreamManager());\n\n              case 11:\n                _context2.next = 13;\n                return this.state.session.publish(newPublisher);\n\n              case 13:\n                this.state.localUser.setStreamManager(newPublisher);\n                this.setState({\n                  currentVideoDevice: newVideoDevice,\n                  localUser: localUser\n                });\n\n              case 15:\n                _context2.next = 20;\n                break;\n\n              case 17:\n                _context2.prev = 17;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.error(_context2.t0);\n\n              case 20:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 17]]);\n      }));\n\n      function switchCamera() {\n        return _switchCamera.apply(this, arguments);\n      }\n\n      return switchCamera;\n    }()\n  }, {\n    key: \"screenShare\",\n    value: function screenShare() {\n      var _this12 = this;\n\n      var videoSource = navigator.userAgent.indexOf('Firefox') !== -1 ? 'window' : 'screen';\n      var publisher = this.OV.initPublisher(undefined, {\n        videoSource: videoSource,\n        publishAudio: localUser.isAudioActive(),\n        publishVideo: localUser.isVideoActive(),\n        mirror: false\n      }, function (error) {\n        if (error && error.name === 'SCREEN_EXTENSION_NOT_INSTALLED') {\n          _this12.setState({\n            showExtensionDialog: true\n          });\n        } else if (error && error.name === 'SCREEN_SHARING_NOT_SUPPORTED') {\n          alert('Your browser does not support screen sharing');\n        } else if (error && error.name === 'SCREEN_EXTENSION_DISABLED') {\n          alert('You need to enable screen sharing extension');\n        } else if (error && error.name === 'SCREEN_CAPTURE_DENIED') {\n          alert('You need to choose a window or application to share');\n        }\n      });\n      publisher.once('accessAllowed', function () {\n        _this12.state.session.unpublish(localUser.getStreamManager());\n\n        localUser.setStreamManager(publisher);\n\n        _this12.state.session.publish(localUser.getStreamManager()).then(function () {\n          localUser.setScreenShareActive(true);\n\n          _this12.setState({\n            localUser: localUser\n          }, function () {\n            _this12.sendSignalUserChanged({\n              isScreenShareActive: localUser.isScreenShareActive()\n            });\n          });\n        });\n      });\n      publisher.on('streamPlaying', function () {\n        _this12.updateLayout();\n\n        publisher.videos[0].video.parentElement.classList.remove('custom-class');\n      });\n    }\n  }, {\n    key: \"closeDialogExtension\",\n    value: function closeDialogExtension() {\n      this.setState({\n        showExtensionDialog: false\n      });\n    }\n  }, {\n    key: \"stopScreenShare\",\n    value: function stopScreenShare() {\n      this.state.session.unpublish(localUser.getStreamManager());\n      this.connectWebCam();\n    }\n  }, {\n    key: \"checkSomeoneShareScreen\",\n    value: function checkSomeoneShareScreen() {\n      var isScreenShared; // return true if at least one passes the test\n\n      isScreenShared = this.state.subscribers.some(function (user) {\n        return user.isScreenShareActive();\n      }) || localUser.isScreenShareActive();\n      var openviduLayoutOptions = {\n        maxRatio: 3 / 2,\n        minRatio: 9 / 16,\n        fixedRatio: isScreenShared,\n        bigClass: 'OV_big',\n        bigPercentage: 0.8,\n        bigFixedRatio: false,\n        bigMaxRatio: 3 / 2,\n        bigMinRatio: 9 / 16,\n        bigFirst: true,\n        animate: true\n      };\n      this.layout.setLayoutOptions(openviduLayoutOptions);\n      this.updateLayout();\n    }\n  }, {\n    key: \"toggleChat\",\n    value: function toggleChat(property) {\n      var display = property;\n\n      if (display === undefined) {\n        display = this.state.chatDisplay === 'none' ? 'block' : 'none';\n      }\n\n      if (display === 'block') {\n        this.setState({\n          chatDisplay: display,\n          messageReceived: false\n        });\n      } else {\n        console.log('chat', display);\n        this.setState({\n          chatDisplay: display\n        });\n      }\n\n      this.updateLayout();\n    }\n  }, {\n    key: \"checkNotification\",\n    value: function checkNotification(event) {\n      this.setState({\n        messageReceived: this.state.chatDisplay === 'none'\n      });\n    }\n  }, {\n    key: \"checkSize\",\n    value: function checkSize() {\n      if (document.getElementById('layout').offsetWidth <= 700 && !this.hasBeenUpdated) {\n        this.toggleChat('none');\n        this.hasBeenUpdated = true;\n      }\n\n      if (document.getElementById('layout').offsetWidth > 700 && this.hasBeenUpdated) {\n        this.hasBeenUpdated = false;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var mySessionId = this.state.mySessionId;\n      var localUser = this.state.localUser;\n      var chatDisplay = {\n        display: this.state.chatDisplay\n      };\n      return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: \"container\",\n        id: \"container\"\n      }, /*#__PURE__*/_react[\"default\"].createElement(_ToolbarComponent[\"default\"], {\n        sessionId: mySessionId,\n        user: localUser,\n        showNotification: this.state.messageReceived,\n        camStatusChanged: this.camStatusChanged,\n        micStatusChanged: this.micStatusChanged,\n        screenShare: this.screenShare,\n        stopScreenShare: this.stopScreenShare,\n        toggleFullscreen: this.toggleFullscreen,\n        switchCamera: this.switchCamera,\n        leaveSession: this.leaveSession,\n        toggleChat: this.toggleChat\n      }), /*#__PURE__*/_react[\"default\"].createElement(_DialogExtension[\"default\"], {\n        showDialog: this.state.showExtensionDialog,\n        cancelClicked: this.closeDialogExtension\n      }), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        id: \"layout\",\n        className: \"bounds\"\n      }, localUser !== undefined && localUser.getStreamManager() !== undefined && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: \"OT_root OT_publisher custom-class\",\n        id: \"localUser\"\n      }, /*#__PURE__*/_react[\"default\"].createElement(_StreamComponent[\"default\"], {\n        user: localUser,\n        handleNickname: this.nicknameChanged\n      })), this.state.subscribers.map(function (sub, i) {\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          key: i,\n          className: \"OT_root OT_publisher custom-class\",\n          id: \"remoteUsers\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_StreamComponent[\"default\"], {\n          user: sub,\n          streamId: sub.streamManager.stream.streamId\n        }));\n      }), localUser !== undefined && localUser.getStreamManager() !== undefined && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: \"OT_root OT_publisher custom-class\",\n        style: chatDisplay\n      }, /*#__PURE__*/_react[\"default\"].createElement(_ChatComponent[\"default\"], {\n        user: localUser,\n        chatDisplay: this.state.chatDisplay,\n        close: this.toggleChat,\n        messageReceived: this.checkNotification\n      }))));\n    }\n    /**\n     * --------------------------\n     * SERVER-SIDE RESPONSIBILITY\n     * --------------------------\n     * These methods retrieve the mandatory user token from OpenVidu Server.\n     * This behaviour MUST BE IN YOUR SERVER-SIDE IN PRODUCTION (by using\n     * the API REST, openvidu-java-client or openvidu-node-client):\n     *   1) Initialize a session in OpenVidu Server\t(POST /api/sessions)\n     *   2) Generate a token in OpenVidu Server\t\t(POST /api/tokens)\n     *   3) The token must be consumed in Session.connect() method\n     */\n\n  }, {\n    key: \"getToken\",\n    value: function getToken() {\n      var _this13 = this;\n\n      return this.createSession(this.state.mySessionId).then(function (sessionId) {\n        return _this13.createToken(sessionId);\n      });\n    }\n  }, {\n    key: \"createSession\",\n    value: function createSession(sessionId) {\n      var _this14 = this;\n\n      return new Promise(function (resolve, reject) {\n        var data = JSON.stringify({\n          customSessionId: sessionId\n        });\n\n        _axios[\"default\"].post(_this14.OPENVIDU_SERVER_URL + '/openvidu/api/sessions', data, {\n          headers: {\n            Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this14.OPENVIDU_SERVER_SECRET),\n            'Content-Type': 'application/json'\n          }\n        }).then(function (response) {\n          console.log('CREATE SESION', response);\n          resolve(response.data.id);\n        })[\"catch\"](function (response) {\n          var error = Object.assign({}, response);\n\n          if (error.response && error.response.status === 409) {\n            resolve(sessionId);\n          } else {\n            console.log(error);\n            console.warn('No connection to OpenVidu Server. This may be a certificate error at ' + _this14.OPENVIDU_SERVER_URL);\n\n            if (window.confirm('No connection to OpenVidu Server. This may be a certificate error at \"' + _this14.OPENVIDU_SERVER_URL + '\"\\n\\nClick OK to navigate and accept it. ' + 'If no certificate warning is shown, then check that your OpenVidu Server is up and running at \"' + _this14.OPENVIDU_SERVER_URL + '\"')) {\n              window.location.assign(_this14.OPENVIDU_SERVER_URL + '/accept-certificate');\n            }\n          }\n        });\n      });\n    }\n  }, {\n    key: \"createToken\",\n    value: function createToken(sessionId) {\n      var _this15 = this;\n\n      return new Promise(function (resolve, reject) {\n        var data = JSON.stringify({});\n\n        _axios[\"default\"].post(_this15.OPENVIDU_SERVER_URL + '/openvidu/api/sessions/' + sessionId + '/connection', data, {\n          headers: {\n            Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this15.OPENVIDU_SERVER_SECRET),\n            'Content-Type': 'application/json'\n          }\n        }).then(function (response) {\n          console.log('TOKEN', response);\n          resolve(response.data.token);\n        })[\"catch\"](function (error) {\n          return reject(error);\n        });\n      });\n    }\n  }]);\n\n  return VideoRoomComponent;\n}(_react.Component);\n\nvar _default = VideoRoomComponent;\nexports[\"default\"] = _default;"],"mappings":"AAAA;;;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAC3CC,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAAC,SAAD,CAAP,GAAqB,KAAK,CAA1B;;AAEA,IAAIE,MAAM,GAAGC,uBAAuB,CAACC,OAAO,CAAC,OAAD,CAAR,CAApC;;AAEA,IAAIC,MAAM,GAAGC,sBAAsB,CAACF,OAAO,CAAC,OAAD,CAAR,CAAnC;;AAEAA,OAAO,CAAC,0BAAD,CAAP;;AAEA,IAAIG,gBAAgB,GAAGH,OAAO,CAAC,kBAAD,CAA9B;;AAEA,IAAII,gBAAgB,GAAGF,sBAAsB,CAACF,OAAO,CAAC,0BAAD,CAAR,CAA7C;;AAEA,IAAIK,gBAAgB,GAAGH,sBAAsB,CAACF,OAAO,CAAC,oCAAD,CAAR,CAA7C;;AAEA,IAAIM,cAAc,GAAGJ,sBAAsB,CAACF,OAAO,CAAC,sBAAD,CAAR,CAA3C;;AAEA,IAAIO,eAAe,GAAGL,sBAAsB,CAACF,OAAO,CAAC,2BAAD,CAAR,CAA5C;;AAEA,IAAIQ,UAAU,GAAGN,sBAAsB,CAACF,OAAO,CAAC,sBAAD,CAAR,CAAvC;;AAEA,IAAIS,iBAAiB,GAAGP,sBAAsB,CAACF,OAAO,CAAC,4BAAD,CAAR,CAA9C;;AAEA,SAASE,sBAAT,CAAgCQ,GAAhC,EAAqC;EAAE,OAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;IAAE,WAAWA;EAAb,CAArC;AAA0D;;AAEjG,SAASE,wBAAT,GAAoC;EAAE,IAAI,OAAOC,OAAP,KAAmB,UAAvB,EAAmC,OAAO,IAAP;EAAa,IAAIC,KAAK,GAAG,IAAID,OAAJ,EAAZ;;EAA2BD,wBAAwB,GAAG,SAASA,wBAAT,GAAoC;IAAE,OAAOE,KAAP;EAAe,CAAhF;;EAAkF,OAAOA,KAAP;AAAe;;AAElN,SAASf,uBAAT,CAAiCW,GAAjC,EAAsC;EAAE,IAAIA,GAAG,IAAIA,GAAG,CAACC,UAAf,EAA2B;IAAE,OAAOD,GAAP;EAAa;;EAAC,IAAIA,GAAG,KAAK,IAAR,IAAgBK,OAAO,CAACL,GAAD,CAAP,KAAiB,QAAjB,IAA6B,OAAOA,GAAP,KAAe,UAAhE,EAA4E;IAAE,OAAO;MAAE,WAAWA;IAAb,CAAP;EAA4B;;EAAC,IAAII,KAAK,GAAGF,wBAAwB,EAApC;;EAAwC,IAAIE,KAAK,IAAIA,KAAK,CAACE,GAAN,CAAUN,GAAV,CAAb,EAA6B;IAAE,OAAOI,KAAK,CAACG,GAAN,CAAUP,GAAV,CAAP;EAAwB;;EAAC,IAAIQ,MAAM,GAAG,EAAb;EAAiB,IAAIC,qBAAqB,GAAGzB,MAAM,CAACC,cAAP,IAAyBD,MAAM,CAAC0B,wBAA5D;;EAAsF,KAAK,IAAIC,GAAT,IAAgBX,GAAhB,EAAqB;IAAE,IAAIhB,MAAM,CAAC4B,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCd,GAArC,EAA0CW,GAA1C,CAAJ,EAAoD;MAAE,IAAII,IAAI,GAAGN,qBAAqB,GAAGzB,MAAM,CAAC0B,wBAAP,CAAgCV,GAAhC,EAAqCW,GAArC,CAAH,GAA+C,IAA/E;;MAAqF,IAAII,IAAI,KAAKA,IAAI,CAACR,GAAL,IAAYQ,IAAI,CAACC,GAAtB,CAAR,EAAoC;QAAEhC,MAAM,CAACC,cAAP,CAAsBuB,MAAtB,EAA8BG,GAA9B,EAAmCI,IAAnC;MAA2C,CAAjF,MAAuF;QAAEP,MAAM,CAACG,GAAD,CAAN,GAAcX,GAAG,CAACW,GAAD,CAAjB;MAAyB;IAAE;EAAE;;EAACH,MAAM,CAAC,SAAD,CAAN,GAAoBR,GAApB;;EAAyB,IAAII,KAAJ,EAAW;IAAEA,KAAK,CAACY,GAAN,CAAUhB,GAAV,EAAeQ,MAAf;EAAyB;;EAAC,OAAOA,MAAP;AAAgB;;AAE9uB,SAASH,OAAT,CAAiBL,GAAjB,EAAsB;EAAE;;EAA2B,IAAI,OAAOiB,MAAP,KAAkB,UAAlB,IAAgC,OAAOA,MAAM,CAACC,QAAd,KAA2B,QAA/D,EAAyE;IAAEb,OAAO,GAAG,SAASA,OAAT,CAAiBL,GAAjB,EAAsB;MAAE,OAAO,OAAOA,GAAd;IAAoB,CAAtD;EAAyD,CAApI,MAA0I;IAAEK,OAAO,GAAG,SAASA,OAAT,CAAiBL,GAAjB,EAAsB;MAAE,OAAOA,GAAG,IAAI,OAAOiB,MAAP,KAAkB,UAAzB,IAAuCjB,GAAG,CAACmB,WAAJ,KAAoBF,MAA3D,IAAqEjB,GAAG,KAAKiB,MAAM,CAACL,SAApF,GAAgG,QAAhG,GAA2G,OAAOZ,GAAzH;IAA+H,CAAjK;EAAoK;;EAAC,OAAOK,OAAO,CAACL,GAAD,CAAd;AAAsB;;AAE1X,SAASoB,kBAAT,CAA4BC,GAA5B,EAAiCC,OAAjC,EAA0CC,MAA1C,EAAkDC,KAAlD,EAAyDC,MAAzD,EAAiEd,GAAjE,EAAsEe,GAAtE,EAA2E;EAAE,IAAI;IAAE,IAAIC,IAAI,GAAGN,GAAG,CAACV,GAAD,CAAH,CAASe,GAAT,CAAX;IAA0B,IAAIvC,KAAK,GAAGwC,IAAI,CAACxC,KAAjB;EAAyB,CAAzD,CAA0D,OAAOyC,KAAP,EAAc;IAAEL,MAAM,CAACK,KAAD,CAAN;IAAe;EAAS;;EAAC,IAAID,IAAI,CAACE,IAAT,EAAe;IAAEP,OAAO,CAACnC,KAAD,CAAP;EAAiB,CAAlC,MAAwC;IAAE2C,OAAO,CAACR,OAAR,CAAgBnC,KAAhB,EAAuB4C,IAAvB,CAA4BP,KAA5B,EAAmCC,MAAnC;EAA6C;AAAE;;AAEzQ,SAASO,iBAAT,CAA2BC,EAA3B,EAA+B;EAAE,OAAO,YAAY;IAAE,IAAIC,IAAI,GAAG,IAAX;IAAA,IAAiBC,IAAI,GAAGC,SAAxB;IAAmC,OAAO,IAAIN,OAAJ,CAAY,UAAUR,OAAV,EAAmBC,MAAnB,EAA2B;MAAE,IAAIF,GAAG,GAAGY,EAAE,CAACI,KAAH,CAASH,IAAT,EAAeC,IAAf,CAAV;;MAAgC,SAASX,KAAT,CAAerC,KAAf,EAAsB;QAAEiC,kBAAkB,CAACC,GAAD,EAAMC,OAAN,EAAeC,MAAf,EAAuBC,KAAvB,EAA8BC,MAA9B,EAAsC,MAAtC,EAA8CtC,KAA9C,CAAlB;MAAyE;;MAAC,SAASsC,MAAT,CAAgBa,GAAhB,EAAqB;QAAElB,kBAAkB,CAACC,GAAD,EAAMC,OAAN,EAAeC,MAAf,EAAuBC,KAAvB,EAA8BC,MAA9B,EAAsC,OAAtC,EAA+Ca,GAA/C,CAAlB;MAAwE;;MAACd,KAAK,CAACe,SAAD,CAAL;IAAmB,CAA9R,CAAP;EAAyS,CAAjW;AAAoW;;AAErY,SAASC,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;EAAE,IAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;IAAE,MAAM,IAAIC,SAAJ,CAAc,mCAAd,CAAN;EAA2D;AAAE;;AAEzJ,SAASC,iBAAT,CAA2BC,MAA3B,EAAmCC,KAAnC,EAA0C;EAAE,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAAK,CAACE,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;IAAE,IAAIE,UAAU,GAAGH,KAAK,CAACC,CAAD,CAAtB;IAA2BE,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;IAAwDD,UAAU,CAACE,YAAX,GAA0B,IAA1B;IAAgC,IAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;IAA4BpE,MAAM,CAACC,cAAP,CAAsB4D,MAAtB,EAA8BI,UAAU,CAACtC,GAAzC,EAA8CsC,UAA9C;EAA4D;AAAE;;AAE7T,SAASI,YAAT,CAAsBX,WAAtB,EAAmCY,UAAnC,EAA+CC,WAA/C,EAA4D;EAAE,IAAID,UAAJ,EAAgBV,iBAAiB,CAACF,WAAW,CAAC9B,SAAb,EAAwB0C,UAAxB,CAAjB;EAAsD,IAAIC,WAAJ,EAAiBX,iBAAiB,CAACF,WAAD,EAAca,WAAd,CAAjB;EAA6C,OAAOb,WAAP;AAAqB;;AAEvN,SAASc,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;EAAE,IAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;IAAE,MAAM,IAAIf,SAAJ,CAAc,oDAAd,CAAN;EAA4E;;EAACc,QAAQ,CAAC7C,SAAT,GAAqB5B,MAAM,CAAC2E,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAAC9C,SAAvC,EAAkD;IAAEO,WAAW,EAAE;MAAEhC,KAAK,EAAEsE,QAAT;MAAmBL,QAAQ,EAAE,IAA7B;MAAmCD,YAAY,EAAE;IAAjD;EAAf,CAAlD,CAArB;EAAkJ,IAAIO,UAAJ,EAAgBE,eAAe,CAACH,QAAD,EAAWC,UAAX,CAAf;AAAwC;;AAEjY,SAASE,eAAT,CAAyBC,CAAzB,EAA4BC,CAA5B,EAA+B;EAAEF,eAAe,GAAG5E,MAAM,CAAC+E,cAAP,IAAyB,SAASH,eAAT,CAAyBC,CAAzB,EAA4BC,CAA5B,EAA+B;IAAED,CAAC,CAACG,SAAF,GAAcF,CAAd;IAAiB,OAAOD,CAAP;EAAW,CAAxG;;EAA0G,OAAOD,eAAe,CAACC,CAAD,EAAIC,CAAJ,CAAtB;AAA+B;;AAE1K,SAASG,YAAT,CAAsBC,OAAtB,EAA+B;EAAE,IAAIC,yBAAyB,GAAGC,yBAAyB,EAAzD;;EAA6D,OAAO,SAASC,oBAAT,GAAgC;IAAE,IAAIC,KAAK,GAAGC,eAAe,CAACL,OAAD,CAA3B;IAAA,IAAsCM,MAAtC;;IAA8C,IAAIL,yBAAJ,EAA+B;MAAE,IAAIM,SAAS,GAAGF,eAAe,CAAC,IAAD,CAAf,CAAsBpD,WAAtC;;MAAmDqD,MAAM,GAAGE,OAAO,CAACC,SAAR,CAAkBL,KAAlB,EAAyBlC,SAAzB,EAAoCqC,SAApC,CAAT;IAA0D,CAA9I,MAAoJ;MAAED,MAAM,GAAGF,KAAK,CAACjC,KAAN,CAAY,IAAZ,EAAkBD,SAAlB,CAAT;IAAwC;;IAAC,OAAOwC,0BAA0B,CAAC,IAAD,EAAOJ,MAAP,CAAjC;EAAkD,CAAxU;AAA2U;;AAEza,SAASI,0BAAT,CAAoC1C,IAApC,EAA0CpB,IAA1C,EAAgD;EAAE,IAAIA,IAAI,KAAKT,OAAO,CAACS,IAAD,CAAP,KAAkB,QAAlB,IAA8B,OAAOA,IAAP,KAAgB,UAAnD,CAAR,EAAwE;IAAE,OAAOA,IAAP;EAAc;;EAAC,OAAO+D,sBAAsB,CAAC3C,IAAD,CAA7B;AAAsC;;AAEjL,SAAS2C,sBAAT,CAAgC3C,IAAhC,EAAsC;EAAE,IAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;IAAE,MAAM,IAAI4C,cAAJ,CAAmB,2DAAnB,CAAN;EAAwF;;EAAC,OAAO5C,IAAP;AAAc;;AAEtK,SAASkC,yBAAT,GAAqC;EAAE,IAAI,OAAOM,OAAP,KAAmB,WAAnB,IAAkC,CAACA,OAAO,CAACC,SAA/C,EAA0D,OAAO,KAAP;EAAc,IAAID,OAAO,CAACC,SAAR,CAAkBI,IAAtB,EAA4B,OAAO,KAAP;EAAc,IAAI,OAAOC,KAAP,KAAiB,UAArB,EAAiC,OAAO,IAAP;;EAAa,IAAI;IAAEC,IAAI,CAACrE,SAAL,CAAesE,QAAf,CAAwBpE,IAAxB,CAA6B4D,OAAO,CAACC,SAAR,CAAkBM,IAAlB,EAAwB,EAAxB,EAA4B,YAAY,CAAE,CAA1C,CAA7B;IAA2E,OAAO,IAAP;EAAc,CAA/F,CAAgG,OAAOE,CAAP,EAAU;IAAE,OAAO,KAAP;EAAe;AAAE;;AAEpU,SAASZ,eAAT,CAAyBV,CAAzB,EAA4B;EAAEU,eAAe,GAAGvF,MAAM,CAAC+E,cAAP,GAAwB/E,MAAM,CAACoG,cAA/B,GAAgD,SAASb,eAAT,CAAyBV,CAAzB,EAA4B;IAAE,OAAOA,CAAC,CAACG,SAAF,IAAehF,MAAM,CAACoG,cAAP,CAAsBvB,CAAtB,CAAtB;EAAiD,CAAjJ;EAAmJ,OAAOU,eAAe,CAACV,CAAD,CAAtB;AAA4B;;AAE7M,IAAIwB,SAAS,GAAG,IAAIvF,UAAU,CAAC,SAAD,CAAd,EAAhB;;AAEA,IAAIwF,kBAAkB,GAAG,aAAa,UAAUC,UAAV,EAAsB;EAC1D/B,SAAS,CAAC8B,kBAAD,EAAqBC,UAArB,CAAT;;EAEA,IAAIC,MAAM,GAAGvB,YAAY,CAACqB,kBAAD,CAAzB;;EAEA,SAASA,kBAAT,CAA4BxC,KAA5B,EAAmC;IACjC,IAAI2C,KAAJ;;IAEAjD,eAAe,CAAC,IAAD,EAAO8C,kBAAP,CAAf;;IAEAG,KAAK,GAAGD,MAAM,CAAC1E,IAAP,CAAY,IAAZ,EAAkBgC,KAAlB,CAAR;IACA2C,KAAK,CAACC,mBAAN,GAA4BD,KAAK,CAAC3C,KAAN,CAAY6C,iBAAZ,GAAgCF,KAAK,CAAC3C,KAAN,CAAY6C,iBAA5C,GAAgE,aAAaC,MAAM,CAACC,QAAP,CAAgBC,QAA7B,GAAwC,OAApI;IACAL,KAAK,CAACM,sBAAN,GAA+BN,KAAK,CAAC3C,KAAN,CAAYkD,cAAZ,GAA6BP,KAAK,CAAC3C,KAAN,CAAYkD,cAAzC,GAA0D,WAAzF;IACAP,KAAK,CAACQ,cAAN,GAAuB,KAAvB;IACAR,KAAK,CAACS,MAAN,GAAe,IAAIrG,eAAe,CAAC,SAAD,CAAnB,EAAf;IACA,IAAIsG,WAAW,GAAGV,KAAK,CAAC3C,KAAN,CAAYqD,WAAZ,GAA0BV,KAAK,CAAC3C,KAAN,CAAYqD,WAAtC,GAAoD,UAAtE;IACA,IAAIC,QAAQ,GAAGX,KAAK,CAAC3C,KAAN,CAAYuD,IAAZ,GAAmBZ,KAAK,CAAC3C,KAAN,CAAYuD,IAA/B,GAAsC,kBAAkBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAvE;IACAf,KAAK,CAACgB,OAAN,GAAgB,EAAhB;IACAhB,KAAK,CAACiB,sBAAN,GAA+B,KAA/B;IACAjB,KAAK,CAACkB,KAAN,GAAc;MACZC,WAAW,EAAET,WADD;MAEZU,UAAU,EAAET,QAFA;MAGZU,OAAO,EAAEvE,SAHG;MAIZ8C,SAAS,EAAE9C,SAJC;MAKZwE,WAAW,EAAE,EALD;MAMZC,WAAW,EAAE,MAND;MAOZC,kBAAkB,EAAE1E;IAPR,CAAd;IASAkD,KAAK,CAACyB,WAAN,GAAoBzB,KAAK,CAACyB,WAAN,CAAkBC,IAAlB,CAAuBtC,sBAAsB,CAACY,KAAD,CAA7C,CAApB;IACAA,KAAK,CAAC2B,YAAN,GAAqB3B,KAAK,CAAC2B,YAAN,CAAmBD,IAAnB,CAAwBtC,sBAAsB,CAACY,KAAD,CAA9C,CAArB;IACAA,KAAK,CAAC4B,cAAN,GAAuB5B,KAAK,CAAC4B,cAAN,CAAqBF,IAArB,CAA0BtC,sBAAsB,CAACY,KAAD,CAAhD,CAAvB;IACAA,KAAK,CAAC6B,YAAN,GAAqB7B,KAAK,CAAC6B,YAAN,CAAmBH,IAAnB,CAAwBtC,sBAAsB,CAACY,KAAD,CAA9C,CAArB;IACAA,KAAK,CAAC8B,gBAAN,GAAyB9B,KAAK,CAAC8B,gBAAN,CAAuBJ,IAAvB,CAA4BtC,sBAAsB,CAACY,KAAD,CAAlD,CAAzB;IACAA,KAAK,CAAC+B,gBAAN,GAAyB/B,KAAK,CAAC+B,gBAAN,CAAuBL,IAAvB,CAA4BtC,sBAAsB,CAACY,KAAD,CAAlD,CAAzB;IACAA,KAAK,CAACgC,eAAN,GAAwBhC,KAAK,CAACgC,eAAN,CAAsBN,IAAtB,CAA2BtC,sBAAsB,CAACY,KAAD,CAAjD,CAAxB;IACAA,KAAK,CAACiC,gBAAN,GAAyBjC,KAAK,CAACiC,gBAAN,CAAuBP,IAAvB,CAA4BtC,sBAAsB,CAACY,KAAD,CAAlD,CAAzB;IACAA,KAAK,CAACkC,YAAN,GAAqBlC,KAAK,CAACkC,YAAN,CAAmBR,IAAnB,CAAwBtC,sBAAsB,CAACY,KAAD,CAA9C,CAArB;IACAA,KAAK,CAACmC,WAAN,GAAoBnC,KAAK,CAACmC,WAAN,CAAkBT,IAAlB,CAAuBtC,sBAAsB,CAACY,KAAD,CAA7C,CAApB;IACAA,KAAK,CAACoC,eAAN,GAAwBpC,KAAK,CAACoC,eAAN,CAAsBV,IAAtB,CAA2BtC,sBAAsB,CAACY,KAAD,CAAjD,CAAxB;IACAA,KAAK,CAACqC,oBAAN,GAA6BrC,KAAK,CAACqC,oBAAN,CAA2BX,IAA3B,CAAgCtC,sBAAsB,CAACY,KAAD,CAAtD,CAA7B;IACAA,KAAK,CAACsC,UAAN,GAAmBtC,KAAK,CAACsC,UAAN,CAAiBZ,IAAjB,CAAsBtC,sBAAsB,CAACY,KAAD,CAA5C,CAAnB;IACAA,KAAK,CAACuC,iBAAN,GAA0BvC,KAAK,CAACuC,iBAAN,CAAwBb,IAAxB,CAA6BtC,sBAAsB,CAACY,KAAD,CAAnD,CAA1B;IACAA,KAAK,CAACwC,SAAN,GAAkBxC,KAAK,CAACwC,SAAN,CAAgBd,IAAhB,CAAqBtC,sBAAsB,CAACY,KAAD,CAA3C,CAAlB;IACA,OAAOA,KAAP;EACD;;EAEDpC,YAAY,CAACiC,kBAAD,EAAqB,CAAC;IAChC3E,GAAG,EAAE,mBAD2B;IAEhCxB,KAAK,EAAE,SAAS+I,iBAAT,GAA6B;MAClC,IAAIC,qBAAqB,GAAG;QAC1BC,QAAQ,EAAE,IAAI,CADY;QAE1B;QACAC,QAAQ,EAAE,IAAI,EAHY;QAI1B;QACAC,UAAU,EAAE,KALc;QAM1B;QACAC,QAAQ,EAAE,QAPgB;QAQ1B;QACAC,aAAa,EAAE,GATW;QAU1B;QACAC,aAAa,EAAE,KAXW;QAY1B;QACAC,WAAW,EAAE,IAAI,CAbS;QAc1B;QACAC,WAAW,EAAE,IAAI,EAfS;QAgB1B;QACAC,QAAQ,EAAE,IAjBgB;QAkB1B;QACAC,OAAO,EAAE,IAnBiB,CAmBZ;;MAnBY,CAA5B;MAsBA,KAAK3C,MAAL,CAAY4C,mBAAZ,CAAgCC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,CAAhC,EAAmEb,qBAAnE;MACAvC,MAAM,CAACqD,gBAAP,CAAwB,cAAxB,EAAwC,KAAK5B,cAA7C;MACAzB,MAAM,CAACqD,gBAAP,CAAwB,QAAxB,EAAkC,KAAK3B,YAAvC;MACA1B,MAAM,CAACqD,gBAAP,CAAwB,QAAxB,EAAkC,KAAKhB,SAAvC;MACA,KAAKf,WAAL;IACD;EA9B+B,CAAD,EA+B9B;IACDvG,GAAG,EAAE,sBADJ;IAEDxB,KAAK,EAAE,SAAS+J,oBAAT,GAAgC;MACrCtD,MAAM,CAACuD,mBAAP,CAA2B,cAA3B,EAA2C,KAAK9B,cAAhD;MACAzB,MAAM,CAACuD,mBAAP,CAA2B,QAA3B,EAAqC,KAAK7B,YAA1C;MACA1B,MAAM,CAACuD,mBAAP,CAA2B,QAA3B,EAAqC,KAAKlB,SAA1C;MACA,KAAKb,YAAL;IACD;EAPA,CA/B8B,EAuC9B;IACDzG,GAAG,EAAE,gBADJ;IAEDxB,KAAK,EAAE,SAASkI,cAAT,CAAwB+B,KAAxB,EAA+B;MACpC,KAAKhC,YAAL;IACD;EAJA,CAvC8B,EA4C9B;IACDzG,GAAG,EAAE,aADJ;IAEDxB,KAAK,EAAE,SAAS+H,WAAT,GAAuB;MAC5B,IAAImC,MAAM,GAAG,IAAb;;MAEA,KAAKC,EAAL,GAAU,IAAI7J,gBAAgB,CAAC8J,QAArB,EAAV;MACA,KAAKC,QAAL,CAAc;QACZ1C,OAAO,EAAE,KAAKwC,EAAL,CAAQG,WAAR;MADG,CAAd,EAEG,YAAY;QACbJ,MAAM,CAACK,wBAAP;;QAEAL,MAAM,CAACM,gBAAP;MACD,CAND;IAOD;EAbA,CA5C8B,EA0D9B;IACDhJ,GAAG,EAAE,kBADJ;IAEDxB,KAAK,EAAE,SAASwK,gBAAT,GAA4B;MACjC,IAAIC,MAAM,GAAG,IAAb;;MAEA,IAAI,KAAK9G,KAAL,CAAW+G,KAAX,KAAqBtH,SAAzB,EAAoC;QAClCuH,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC,KAAKjH,KAAL,CAAW+G,KAA3C;QACA,KAAKG,OAAL,CAAa,KAAKlH,KAAL,CAAW+G,KAAxB;MACD,CAHD,MAGO;QACL,KAAKI,QAAL,GAAgBlI,IAAhB,CAAqB,UAAU8H,KAAV,EAAiB;UACpCC,OAAO,CAACC,GAAR,CAAYF,KAAZ;;UAEAD,MAAM,CAACI,OAAP,CAAeH,KAAf;QACD,CAJD,EAIG,OAJH,EAIY,UAAUjI,KAAV,EAAiB;UAC3B,IAAIgI,MAAM,CAAC9G,KAAP,CAAalB,KAAjB,EAAwB;YACtBgI,MAAM,CAAC9G,KAAP,CAAalB,KAAb,CAAmB;cACjBA,KAAK,EAAEA,KAAK,CAACA,KADI;cAEjBsI,OAAO,EAAEtI,KAAK,CAACuI,OAFE;cAGjBC,IAAI,EAAExI,KAAK,CAACwI,IAHK;cAIjBC,MAAM,EAAEzI,KAAK,CAACyI;YAJG,CAAnB;UAMD;;UAEDP,OAAO,CAACC,GAAR,CAAY,uCAAZ,EAAqDnI,KAAK,CAACwI,IAA3D,EAAiExI,KAAK,CAACuI,OAAvE;UACAG,KAAK,CAAC,uCAAD,EAA0C1I,KAAK,CAACuI,OAAhD,CAAL;QACD,CAhBD;MAiBD;IACF;EA3BA,CA1D8B,EAsF9B;IACDxJ,GAAG,EAAE,SADJ;IAEDxB,KAAK,EAAE,SAAS6K,OAAT,CAAiBH,KAAjB,EAAwB;MAC7B,IAAIU,MAAM,GAAG,IAAb;;MAEA,KAAK5D,KAAL,CAAWG,OAAX,CAAmBkD,OAAnB,CAA2BH,KAA3B,EAAkC;QAChCW,UAAU,EAAE,KAAK7D,KAAL,CAAWE;MADS,CAAlC,EAEG9E,IAFH,CAEQ,YAAY;QAClBwI,MAAM,CAACE,aAAP;MACD,CAJD,EAIG,OAJH,EAIY,UAAU7I,KAAV,EAAiB;QAC3B,IAAI2I,MAAM,CAACzH,KAAP,CAAalB,KAAjB,EAAwB;UACtB2I,MAAM,CAACzH,KAAP,CAAalB,KAAb,CAAmB;YACjBA,KAAK,EAAEA,KAAK,CAACA,KADI;YAEjBsI,OAAO,EAAEtI,KAAK,CAACuI,OAFE;YAGjBC,IAAI,EAAExI,KAAK,CAACwI,IAHK;YAIjBC,MAAM,EAAEzI,KAAK,CAACyI;UAJG,CAAnB;QAMD;;QAEDC,KAAK,CAAC,+CAAD,EAAkD1I,KAAK,CAACuI,OAAxD,CAAL;QACAL,OAAO,CAACC,GAAR,CAAY,+CAAZ,EAA6DnI,KAAK,CAACwI,IAAnE,EAAyExI,KAAK,CAACuI,OAA/E;MACD,CAhBD;IAiBD;EAtBA,CAtF8B,EA6G9B;IACDxJ,GAAG,EAAE,eADJ;IAEDxB,KAAK,EAAE,YAAY;MACjB,IAAIuL,cAAc,GAAG1I,iBAAiB,EAAE,aAAa,oBAAmB2I,IAAnB,CAAwB,SAASC,OAAT,GAAmB;QAC9F,IAAIC,MAAM,GAAG,IAAb;;QAEA,IAAIC,OAAJ,EAAaC,YAAb,EAA2BC,SAA3B;QACA,OAAO,oBAAmBC,IAAnB,CAAwB,SAASC,QAAT,CAAkBC,QAAlB,EAA4B;UACzD,OAAO,CAAP,EAAU;YACR,QAAQA,QAAQ,CAACC,IAAT,GAAgBD,QAAQ,CAACE,IAAjC;cACE,KAAK,CAAL;gBACEF,QAAQ,CAACE,IAAT,GAAgB,CAAhB;gBACA,OAAO,KAAK/B,EAAL,CAAQgC,UAAR,EAAP;;cAEF,KAAK,CAAL;gBACER,OAAO,GAAGK,QAAQ,CAACI,IAAnB;gBACAR,YAAY,GAAGD,OAAO,CAACU,MAAR,CAAe,UAAUC,MAAV,EAAkB;kBAC9C,OAAOA,MAAM,CAACC,IAAP,KAAgB,YAAvB;gBACD,CAFc,CAAf;gBAGAV,SAAS,GAAG,KAAK1B,EAAL,CAAQqC,aAAR,CAAsBpJ,SAAtB,EAAiC;kBAC3CqJ,WAAW,EAAErJ,SAD8B;kBAE3CsJ,WAAW,EAAEd,YAAY,CAAC,CAAD,CAAZ,CAAgBe,QAFc;kBAG3CC,YAAY,EAAE1G,SAAS,CAAC2G,aAAV,EAH6B;kBAI3CC,YAAY,EAAE5G,SAAS,CAAC6G,aAAV,EAJ6B;kBAK3CC,UAAU,EAAE,SAL+B;kBAM3CC,SAAS,EAAE,EANgC;kBAO3CC,UAAU,EAAE;gBAP+B,CAAjC,CAAZ;;gBAUA,IAAI,KAAK1F,KAAL,CAAWG,OAAX,CAAmBwF,YAAnB,CAAgCC,OAApC,EAA6C;kBAC3CvB,SAAS,CAACwB,EAAV,CAAa,eAAb,EAA8B,YAAY;oBACxC3B,MAAM,CAAClE,KAAP,CAAaG,OAAb,CAAqByF,OAArB,CAA6BvB,SAA7B,EAAwCjJ,IAAxC,CAA6C,YAAY;sBACvD8I,MAAM,CAAC4B,iBAAP;;sBAEA5B,MAAM,CAACnE,sBAAP,GAAgC,IAAhC;;sBAEA,IAAImE,MAAM,CAAC/H,KAAP,CAAaoE,WAAjB,EAA8B;wBAC5B2D,MAAM,CAAC/H,KAAP,CAAaoE,WAAb;sBACD;oBACF,CARD;kBASD,CAVD;gBAWD;;gBAED7B,SAAS,CAACqH,WAAV,CAAsB,KAAK/F,KAAL,CAAWE,UAAjC;gBACAxB,SAAS,CAACsH,eAAV,CAA0B,KAAKhG,KAAL,CAAWG,OAAX,CAAmB8F,UAAnB,CAA8BC,YAAxD;gBACAxH,SAAS,CAACyH,oBAAV,CAA+B,KAA/B;gBACAzH,SAAS,CAAC0H,gBAAV,CAA2B/B,SAA3B;gBACA,KAAKgC,sBAAL;gBACA,KAAKC,0BAAL;gBACA,KAAKC,qBAAL,CAA2B;kBACzBC,mBAAmB,EAAE9H,SAAS,CAAC8H,mBAAV;gBADI,CAA3B;gBAGA,KAAK3D,QAAL,CAAc;kBACZvC,kBAAkB,EAAE8D,YAAY,CAAC,CAAD,CADpB;kBAEZ1F,SAAS,EAAEA;gBAFC,CAAd,EAGG,YAAY;kBACbwF,MAAM,CAAClE,KAAP,CAAatB,SAAb,CAAuB+H,gBAAvB,GAA0CZ,EAA1C,CAA6C,eAA7C,EAA8D,UAAUrH,CAAV,EAAa;oBACzE0F,MAAM,CAACvD,YAAP;;oBAEA0D,SAAS,CAACqC,MAAV,CAAiB,CAAjB,EAAoBC,KAApB,CAA0BC,aAA1B,CAAwCC,SAAxC,CAAkDC,MAAlD,CAAyD,cAAzD;kBACD,CAJD;gBAKD,CATD;;cAWF,KAAK,EAAL;cACA,KAAK,KAAL;gBACE,OAAOtC,QAAQ,CAACuC,IAAT,EAAP;YAxDJ;UA0DD;QACF,CA7DM,EA6DJ9C,OA7DI,EA6DK,IA7DL,CAAP;MA8DD,CAlEoD,CAAf,CAAtC;;MAoEA,SAASH,aAAT,GAAyB;QACvB,OAAOC,cAAc,CAACrI,KAAf,CAAqB,IAArB,EAA2BD,SAA3B,CAAP;MACD;;MAED,OAAOqI,aAAP;IACD,CA1EM;EAFN,CA7G8B,EA0L9B;IACD9J,GAAG,EAAE,mBADJ;IAEDxB,KAAK,EAAE,SAASsN,iBAAT,GAA6B;MAClC,IAAIkB,MAAM,GAAG,IAAb;;MAEA,IAAI5G,WAAW,GAAG,KAAKN,OAAvB;MACA,KAAK+C,QAAL,CAAc;QACZzC,WAAW,EAAEA;MADD,CAAd,EAEG,YAAY;QACb,IAAI4G,MAAM,CAAChH,KAAP,CAAatB,SAAjB,EAA4B;UAC1BsI,MAAM,CAACT,qBAAP,CAA6B;YAC3BlB,aAAa,EAAE2B,MAAM,CAAChH,KAAP,CAAatB,SAAb,CAAuB2G,aAAvB,EADY;YAE3BE,aAAa,EAAEyB,MAAM,CAAChH,KAAP,CAAatB,SAAb,CAAuB6G,aAAvB,EAFY;YAG3B0B,QAAQ,EAAED,MAAM,CAAChH,KAAP,CAAatB,SAAb,CAAuBwI,WAAvB,EAHiB;YAI3BV,mBAAmB,EAAEQ,MAAM,CAAChH,KAAP,CAAatB,SAAb,CAAuB8H,mBAAvB;UAJM,CAA7B;QAMD;;QAEDQ,MAAM,CAACrG,YAAP;MACD,CAbD;IAcD;EApBA,CA1L8B,EA+M9B;IACD3G,GAAG,EAAE,cADJ;IAEDxB,KAAK,EAAE,SAASiI,YAAT,GAAwB;MAC7B,IAAI0G,SAAS,GAAG,KAAKnH,KAAL,CAAWG,OAA3B;;MAEA,IAAIgH,SAAJ,EAAe;QACbA,SAAS,CAACC,UAAV;MACD,CAL4B,CAK3B;;;MAGF,KAAKzE,EAAL,GAAU,IAAV;MACA,KAAKE,QAAL,CAAc;QACZ1C,OAAO,EAAEvE,SADG;QAEZwE,WAAW,EAAE,EAFD;QAGZH,WAAW,EAAE,UAHD;QAIZC,UAAU,EAAE,kBAAkBP,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAJlB;QAKZnB,SAAS,EAAE9C;MALC,CAAd;;MAQA,IAAI,KAAKO,KAAL,CAAWsE,YAAf,EAA6B;QAC3B,KAAKtE,KAAL,CAAWsE,YAAX;MACD;IACF;EAtBA,CA/M8B,EAsO9B;IACDzG,GAAG,EAAE,kBADJ;IAEDxB,KAAK,EAAE,SAASoI,gBAAT,GAA4B;MACjClC,SAAS,CAAC2I,cAAV,CAAyB,CAAC3I,SAAS,CAAC6G,aAAV,EAA1B;MACA7G,SAAS,CAAC+H,gBAAV,GAA6BnB,YAA7B,CAA0C5G,SAAS,CAAC6G,aAAV,EAA1C;MACA,KAAKgB,qBAAL,CAA2B;QACzBhB,aAAa,EAAE7G,SAAS,CAAC6G,aAAV;MADU,CAA3B;MAGA,KAAK1C,QAAL,CAAc;QACZnE,SAAS,EAAEA;MADC,CAAd;IAGD;EAXA,CAtO8B,EAkP9B;IACD1E,GAAG,EAAE,kBADJ;IAEDxB,KAAK,EAAE,SAASqI,gBAAT,GAA4B;MACjCnC,SAAS,CAAC4I,cAAV,CAAyB,CAAC5I,SAAS,CAAC2G,aAAV,EAA1B;MACA3G,SAAS,CAAC+H,gBAAV,GAA6BrB,YAA7B,CAA0C1G,SAAS,CAAC2G,aAAV,EAA1C;MACA,KAAKkB,qBAAL,CAA2B;QACzBlB,aAAa,EAAE3G,SAAS,CAAC2G,aAAV;MADU,CAA3B;MAGA,KAAKxC,QAAL,CAAc;QACZnE,SAAS,EAAEA;MADC,CAAd;IAGD;EAXA,CAlP8B,EA8P9B;IACD1E,GAAG,EAAE,iBADJ;IAEDxB,KAAK,EAAE,SAASsI,eAAT,CAAyBmG,QAAzB,EAAmC;MACxC,IAAIvI,SAAS,GAAG,KAAKsB,KAAL,CAAWtB,SAA3B;MACAA,SAAS,CAACqH,WAAV,CAAsBkB,QAAtB;MACA,KAAKpE,QAAL,CAAc;QACZnE,SAAS,EAAEA;MADC,CAAd;MAGA,KAAK6H,qBAAL,CAA2B;QACzBU,QAAQ,EAAE,KAAKjH,KAAL,CAAWtB,SAAX,CAAqBwI,WAArB;MADe,CAA3B;IAGD;EAXA,CA9P8B,EA0Q9B;IACDlN,GAAG,EAAE,kBADJ;IAEDxB,KAAK,EAAE,SAAS+O,gBAAT,CAA0BC,MAA1B,EAAkC;MACvC,IAAIC,WAAW,GAAG,KAAKzH,KAAL,CAAWI,WAA7B;MACA,IAAIsH,UAAU,GAAGD,WAAW,CAAC5C,MAAZ,CAAmB,UAAUnF,IAAV,EAAgB;QAClD,OAAOA,IAAI,CAAC+G,gBAAL,GAAwBe,MAAxB,KAAmCA,MAA1C;MACD,CAFgB,EAEd,CAFc,CAAjB;MAGA,IAAIG,KAAK,GAAGF,WAAW,CAACG,OAAZ,CAAoBF,UAApB,EAAgC,CAAhC,CAAZ;;MAEA,IAAIC,KAAK,GAAG,CAAC,CAAb,EAAgB;QACdF,WAAW,CAACI,MAAZ,CAAmBF,KAAnB,EAA0B,CAA1B;QACA,KAAK9E,QAAL,CAAc;UACZzC,WAAW,EAAEqH;QADD,CAAd;MAGD;IACF;EAfA,CA1Q8B,EA0R9B;IACDzN,GAAG,EAAE,0BADJ;IAEDxB,KAAK,EAAE,SAASuK,wBAAT,GAAoC;MACzC,IAAI+E,MAAM,GAAG,IAAb;;MAEA,KAAK9H,KAAL,CAAWG,OAAX,CAAmB0F,EAAnB,CAAsB,eAAtB,EAAuC,UAAUpD,KAAV,EAAiB;QACtD,IAAIsF,UAAU,GAAGD,MAAM,CAAC9H,KAAP,CAAaG,OAAb,CAAqB6H,SAArB,CAA+BvF,KAAK,CAAC+E,MAArC,EAA6C5L,SAA7C,CAAjB,CADsD,CACoB;;;QAG1EmM,UAAU,CAAClC,EAAX,CAAc,eAAd,EAA+B,UAAUrH,CAAV,EAAa;UAC1CsJ,MAAM,CAACG,uBAAP;;UAEAF,UAAU,CAACrB,MAAX,CAAkB,CAAlB,EAAqBC,KAArB,CAA2BC,aAA3B,CAAyCC,SAAzC,CAAmDC,MAAnD,CAA0D,cAA1D;QACD,CAJD;QAKA,IAAIoB,OAAO,GAAG,IAAI/O,UAAU,CAAC,SAAD,CAAd,EAAd;QACA+O,OAAO,CAAC9B,gBAAR,CAAyB2B,UAAzB;QACAG,OAAO,CAAClC,eAAR,CAAwBvD,KAAK,CAAC+E,MAAN,CAAavB,UAAb,CAAwBC,YAAhD;QACAgC,OAAO,CAACC,OAAR,CAAgB,QAAhB;QACA,IAAIlB,QAAQ,GAAGxE,KAAK,CAAC+E,MAAN,CAAavB,UAAb,CAAwBmC,IAAxB,CAA6BC,KAA7B,CAAmC,GAAnC,EAAwC,CAAxC,CAAf;QACAH,OAAO,CAACnC,WAAR,CAAoBuC,IAAI,CAACC,KAAL,CAAWtB,QAAX,EAAqBpD,UAAzC;;QAEAiE,MAAM,CAAChI,OAAP,CAAe0I,IAAf,CAAoBN,OAApB;;QAEA,IAAIJ,MAAM,CAAC/H,sBAAX,EAAmC;UACjC+H,MAAM,CAAChC,iBAAP;QACD;MACF,CArBD;IAsBD;EA3BA,CA1R8B,EAsT9B;IACD9L,GAAG,EAAE,4BADJ;IAEDxB,KAAK,EAAE,SAAS8N,0BAAT,GAAsC;MAC3C,IAAImC,MAAM,GAAG,IAAb,CAD2C,CAG3C;;;MACA,KAAKzI,KAAL,CAAWG,OAAX,CAAmB0F,EAAnB,CAAsB,iBAAtB,EAAyC,UAAUpD,KAAV,EAAiB;QACxD;QACAgG,MAAM,CAAClB,gBAAP,CAAwB9E,KAAK,CAAC+E,MAA9B;;QAEAkB,UAAU,CAAC,YAAY;UACrBD,MAAM,CAACR,uBAAP;QACD,CAFS,EAEP,EAFO,CAAV;QAGAxF,KAAK,CAACkG,cAAN;;QAEAF,MAAM,CAAC9H,YAAP;MACD,CAVD;IAWD;EAjBA,CAtT8B,EAwU9B;IACD3G,GAAG,EAAE,wBADJ;IAEDxB,KAAK,EAAE,SAAS6N,sBAAT,GAAkC;MACvC,IAAIuC,MAAM,GAAG,IAAb;;MAEA,KAAK5I,KAAL,CAAWG,OAAX,CAAmB0F,EAAnB,CAAsB,oBAAtB,EAA4C,UAAUpD,KAAV,EAAiB;QAC3D,IAAIgF,WAAW,GAAGmB,MAAM,CAAC5I,KAAP,CAAaI,WAA/B;QACAqH,WAAW,CAACoB,OAAZ,CAAoB,UAAUnJ,IAAV,EAAgB;UAClC,IAAIA,IAAI,CAACoJ,eAAL,OAA2BrG,KAAK,CAACsG,IAAN,CAAW7C,YAA1C,EAAwD;YACtD,IAAIkC,IAAI,GAAGE,IAAI,CAACC,KAAL,CAAW9F,KAAK,CAAC2F,IAAjB,CAAX;YACAjF,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BX,KAAK,CAAC2F,IAArC;;YAEA,IAAIA,IAAI,CAAC/C,aAAL,KAAuBzJ,SAA3B,EAAsC;cACpC8D,IAAI,CAAC4H,cAAL,CAAoBc,IAAI,CAAC/C,aAAzB;YACD;;YAED,IAAI+C,IAAI,CAAC7C,aAAL,KAAuB3J,SAA3B,EAAsC;cACpC8D,IAAI,CAAC2H,cAAL,CAAoBe,IAAI,CAAC7C,aAAzB;YACD;;YAED,IAAI6C,IAAI,CAACnB,QAAL,KAAkBrL,SAAtB,EAAiC;cAC/B8D,IAAI,CAACqG,WAAL,CAAiBqC,IAAI,CAACnB,QAAtB;YACD;;YAED,IAAImB,IAAI,CAAC5B,mBAAL,KAA6B5K,SAAjC,EAA4C;cAC1C8D,IAAI,CAACyG,oBAAL,CAA0BiC,IAAI,CAAC5B,mBAA/B;YACD;UACF;QACF,CArBD;;QAuBAoC,MAAM,CAAC/F,QAAP,CAAgB;UACdzC,WAAW,EAAEqH;QADC,CAAhB,EAEG,YAAY;UACb,OAAOmB,MAAM,CAACX,uBAAP,EAAP;QACD,CAJD;MAKD,CA9BD;IA+BD;EApCA,CAxU8B,EA6W9B;IACDjO,GAAG,EAAE,cADJ;IAEDxB,KAAK,EAAE,SAASmI,YAAT,GAAwB;MAC7B,IAAIqI,OAAO,GAAG,IAAd;;MAEAN,UAAU,CAAC,YAAY;QACrBM,OAAO,CAACzJ,MAAR,CAAeoB,YAAf;MACD,CAFS,EAEP,EAFO,CAAV;IAGD;EARA,CA7W8B,EAsX9B;IACD3G,GAAG,EAAE,uBADJ;IAEDxB,KAAK,EAAE,SAAS+N,qBAAT,CAA+B6B,IAA/B,EAAqC;MAC1C,IAAIa,aAAa,GAAG;QAClBb,IAAI,EAAEE,IAAI,CAACY,SAAL,CAAed,IAAf,CADY;QAElBe,IAAI,EAAE;MAFY,CAApB;MAIA,KAAKnJ,KAAL,CAAWG,OAAX,CAAmBiJ,MAAnB,CAA0BH,aAA1B;IACD;EARA,CAtX8B,EA+X9B;IACDjP,GAAG,EAAE,kBADJ;IAEDxB,KAAK,EAAE,SAASuI,gBAAT,GAA4B;MACjC,IAAIqB,QAAQ,GAAGnD,MAAM,CAACmD,QAAtB;MACA,IAAIiH,EAAE,GAAGjH,QAAQ,CAACC,cAAT,CAAwB,WAAxB,CAAT;;MAEA,IAAI,CAACD,QAAQ,CAACkH,iBAAV,IAA+B,CAAClH,QAAQ,CAACmH,oBAAzC,IAAiE,CAACnH,QAAQ,CAACoH,uBAA3E,IAAsG,CAACpH,QAAQ,CAACqH,mBAApH,EAAyI;QACvI,IAAIJ,EAAE,CAACK,iBAAP,EAA0B;UACxBL,EAAE,CAACK,iBAAH;QACD,CAFD,MAEO,IAAIL,EAAE,CAACM,mBAAP,EAA4B;UACjCN,EAAE,CAACM,mBAAH;QACD,CAFM,MAEA,IAAIN,EAAE,CAACO,oBAAP,EAA6B;UAClCP,EAAE,CAACO,oBAAH;QACD,CAFM,MAEA,IAAIP,EAAE,CAACQ,uBAAP,EAAgC;UACrCR,EAAE,CAACQ,uBAAH;QACD;MACF,CAVD,MAUO;QACL,IAAIzH,QAAQ,CAAC0H,cAAb,EAA6B;UAC3B1H,QAAQ,CAAC0H,cAAT;QACD,CAFD,MAEO,IAAI1H,QAAQ,CAAC2H,gBAAb,EAA+B;UACpC3H,QAAQ,CAAC2H,gBAAT;QACD,CAFM,MAEA,IAAI3H,QAAQ,CAAC4H,mBAAb,EAAkC;UACvC5H,QAAQ,CAAC4H,mBAAT;QACD,CAFM,MAEA,IAAI5H,QAAQ,CAAC6H,oBAAb,EAAmC;UACxC7H,QAAQ,CAAC6H,oBAAT;QACD;MACF;IACF;EA3BA,CA/X8B,EA2Z9B;IACDjQ,GAAG,EAAE,cADJ;IAEDxB,KAAK,EAAE,YAAY;MACjB,IAAI0R,aAAa,GAAG7O,iBAAiB,EAAE,aAAa,oBAAmB2I,IAAnB,CAAwB,SAASmG,QAAT,GAAoB;QAC9F,IAAIC,OAAO,GAAG,IAAd;;QAEA,IAAIjG,OAAJ,EAAaC,YAAb,EAA2BiG,cAA3B,EAA2CC,YAA3C;QACA,OAAO,oBAAmBhG,IAAnB,CAAwB,SAASiG,SAAT,CAAmBC,SAAnB,EAA8B;UAC3D,OAAO,CAAP,EAAU;YACR,QAAQA,SAAS,CAAC/F,IAAV,GAAiB+F,SAAS,CAAC9F,IAAnC;cACE,KAAK,CAAL;gBACE8F,SAAS,CAAC/F,IAAV,GAAiB,CAAjB;gBACA+F,SAAS,CAAC9F,IAAV,GAAiB,CAAjB;gBACA,OAAO,KAAK/B,EAAL,CAAQgC,UAAR,EAAP;;cAEF,KAAK,CAAL;gBACER,OAAO,GAAGqG,SAAS,CAAC5F,IAApB;gBACAR,YAAY,GAAGD,OAAO,CAACU,MAAR,CAAe,UAAUC,MAAV,EAAkB;kBAC9C,OAAOA,MAAM,CAACC,IAAP,KAAgB,YAAvB;gBACD,CAFc,CAAf;;gBAIA,IAAI,EAAEX,YAAY,IAAIA,YAAY,CAAC/H,MAAb,GAAsB,CAAxC,CAAJ,EAAgD;kBAC9CmO,SAAS,CAAC9F,IAAV,GAAiB,EAAjB;kBACA;gBACD;;gBAED2F,cAAc,GAAGjG,YAAY,CAACS,MAAb,CAAoB,UAAUC,MAAV,EAAkB;kBACrD,OAAOA,MAAM,CAACK,QAAP,KAAoBiF,OAAO,CAACpK,KAAR,CAAcM,kBAAd,CAAiC6E,QAA5D;gBACD,CAFgB,CAAjB;;gBAIA,IAAI,EAAEkF,cAAc,CAAChO,MAAf,GAAwB,CAA1B,CAAJ,EAAkC;kBAChCmO,SAAS,CAAC9F,IAAV,GAAiB,EAAjB;kBACA;gBACD,CAlBH,CAoBE;gBACA;;;gBACA4F,YAAY,GAAG,KAAK3H,EAAL,CAAQqC,aAAR,CAAsBpJ,SAAtB,EAAiC;kBAC9CqJ,WAAW,EAAErJ,SADiC;kBAE9CsJ,WAAW,EAAEmF,cAAc,CAAC,CAAD,CAAd,CAAkBlF,QAFe;kBAG9CC,YAAY,EAAE1G,SAAS,CAAC2G,aAAV,EAHgC;kBAI9CC,YAAY,EAAE5G,SAAS,CAAC6G,aAAV,EAJgC;kBAK9CkF,MAAM,EAAE;gBALsC,CAAjC,CAAf,CAtBF,CA4BM;;gBAEJD,SAAS,CAAC9F,IAAV,GAAiB,EAAjB;gBACA,OAAO,KAAK1E,KAAL,CAAWG,OAAX,CAAmBuK,SAAnB,CAA6B,KAAK1K,KAAL,CAAWtB,SAAX,CAAqB+H,gBAArB,EAA7B,CAAP;;cAEF,KAAK,EAAL;gBACE+D,SAAS,CAAC9F,IAAV,GAAiB,EAAjB;gBACA,OAAO,KAAK1E,KAAL,CAAWG,OAAX,CAAmByF,OAAnB,CAA2B0E,YAA3B,CAAP;;cAEF,KAAK,EAAL;gBACE,KAAKtK,KAAL,CAAWtB,SAAX,CAAqB0H,gBAArB,CAAsCkE,YAAtC;gBACA,KAAKzH,QAAL,CAAc;kBACZvC,kBAAkB,EAAE+J,cADR;kBAEZ3L,SAAS,EAAEA;gBAFC,CAAd;;cAKF,KAAK,EAAL;gBACE8L,SAAS,CAAC9F,IAAV,GAAiB,EAAjB;gBACA;;cAEF,KAAK,EAAL;gBACE8F,SAAS,CAAC/F,IAAV,GAAiB,EAAjB;gBACA+F,SAAS,CAACG,EAAV,GAAeH,SAAS,CAAC,OAAD,CAAT,CAAmB,CAAnB,CAAf;gBACArH,OAAO,CAAClI,KAAR,CAAcuP,SAAS,CAACG,EAAxB;;cAEF,KAAK,EAAL;cACA,KAAK,KAAL;gBACE,OAAOH,SAAS,CAACzD,IAAV,EAAP;YA7DJ;UA+DD;QACF,CAlEM,EAkEJoD,QAlEI,EAkEM,IAlEN,EAkEY,CAAC,CAAC,CAAD,EAAI,EAAJ,CAAD,CAlEZ,CAAP;MAmED,CAvEmD,CAAf,CAArC;;MAyEA,SAASnJ,YAAT,GAAwB;QACtB,OAAOkJ,aAAa,CAACxO,KAAd,CAAoB,IAApB,EAA0BD,SAA1B,CAAP;MACD;;MAED,OAAOuF,YAAP;IACD,CA/EM;EAFN,CA3Z8B,EA6e9B;IACDhH,GAAG,EAAE,aADJ;IAEDxB,KAAK,EAAE,SAASyI,WAAT,GAAuB;MAC5B,IAAI2J,OAAO,GAAG,IAAd;;MAEA,IAAI1F,WAAW,GAAG2F,SAAS,CAACC,SAAV,CAAoBlD,OAApB,CAA4B,SAA5B,MAA2C,CAAC,CAA5C,GAAgD,QAAhD,GAA2D,QAA7E;MACA,IAAIvD,SAAS,GAAG,KAAK1B,EAAL,CAAQqC,aAAR,CAAsBpJ,SAAtB,EAAiC;QAC/CsJ,WAAW,EAAEA,WADkC;QAE/CE,YAAY,EAAE1G,SAAS,CAAC2G,aAAV,EAFiC;QAG/CC,YAAY,EAAE5G,SAAS,CAAC6G,aAAV,EAHiC;QAI/CkF,MAAM,EAAE;MAJuC,CAAjC,EAKb,UAAUxP,KAAV,EAAiB;QAClB,IAAIA,KAAK,IAAIA,KAAK,CAAC8P,IAAN,KAAe,gCAA5B,EAA8D;UAC5DH,OAAO,CAAC/H,QAAR,CAAiB;YACfmI,mBAAmB,EAAE;UADN,CAAjB;QAGD,CAJD,MAIO,IAAI/P,KAAK,IAAIA,KAAK,CAAC8P,IAAN,KAAe,8BAA5B,EAA4D;UACjEpH,KAAK,CAAC,8CAAD,CAAL;QACD,CAFM,MAEA,IAAI1I,KAAK,IAAIA,KAAK,CAAC8P,IAAN,KAAe,2BAA5B,EAAyD;UAC9DpH,KAAK,CAAC,6CAAD,CAAL;QACD,CAFM,MAEA,IAAI1I,KAAK,IAAIA,KAAK,CAAC8P,IAAN,KAAe,uBAA5B,EAAqD;UAC1DpH,KAAK,CAAC,qDAAD,CAAL;QACD;MACF,CAjBe,CAAhB;MAkBAU,SAAS,CAAC4G,IAAV,CAAe,eAAf,EAAgC,YAAY;QAC1CL,OAAO,CAAC5K,KAAR,CAAcG,OAAd,CAAsBuK,SAAtB,CAAgChM,SAAS,CAAC+H,gBAAV,EAAhC;;QAEA/H,SAAS,CAAC0H,gBAAV,CAA2B/B,SAA3B;;QAEAuG,OAAO,CAAC5K,KAAR,CAAcG,OAAd,CAAsByF,OAAtB,CAA8BlH,SAAS,CAAC+H,gBAAV,EAA9B,EAA4DrL,IAA5D,CAAiE,YAAY;UAC3EsD,SAAS,CAACyH,oBAAV,CAA+B,IAA/B;;UAEAyE,OAAO,CAAC/H,QAAR,CAAiB;YACfnE,SAAS,EAAEA;UADI,CAAjB,EAEG,YAAY;YACbkM,OAAO,CAACrE,qBAAR,CAA8B;cAC5BC,mBAAmB,EAAE9H,SAAS,CAAC8H,mBAAV;YADO,CAA9B;UAGD,CAND;QAOD,CAVD;MAWD,CAhBD;MAiBAnC,SAAS,CAACwB,EAAV,CAAa,eAAb,EAA8B,YAAY;QACxC+E,OAAO,CAACjK,YAAR;;QAEA0D,SAAS,CAACqC,MAAV,CAAiB,CAAjB,EAAoBC,KAApB,CAA0BC,aAA1B,CAAwCC,SAAxC,CAAkDC,MAAlD,CAAyD,cAAzD;MACD,CAJD;IAKD;EA9CA,CA7e8B,EA4hB9B;IACD9M,GAAG,EAAE,sBADJ;IAEDxB,KAAK,EAAE,SAAS2I,oBAAT,GAAgC;MACrC,KAAK0B,QAAL,CAAc;QACZmI,mBAAmB,EAAE;MADT,CAAd;IAGD;EANA,CA5hB8B,EAmiB9B;IACDhR,GAAG,EAAE,iBADJ;IAEDxB,KAAK,EAAE,SAAS0I,eAAT,GAA2B;MAChC,KAAKlB,KAAL,CAAWG,OAAX,CAAmBuK,SAAnB,CAA6BhM,SAAS,CAAC+H,gBAAV,EAA7B;MACA,KAAK3C,aAAL;IACD;EALA,CAniB8B,EAyiB9B;IACD9J,GAAG,EAAE,yBADJ;IAEDxB,KAAK,EAAE,SAASyP,uBAAT,GAAmC;MACxC,IAAIiD,cAAJ,CADwC,CACpB;;MAEpBA,cAAc,GAAG,KAAKlL,KAAL,CAAWI,WAAX,CAAuB+K,IAAvB,CAA4B,UAAUzL,IAAV,EAAgB;QAC3D,OAAOA,IAAI,CAAC8G,mBAAL,EAAP;MACD,CAFgB,KAEX9H,SAAS,CAAC8H,mBAAV,EAFN;MAGA,IAAI4E,qBAAqB,GAAG;QAC1B3J,QAAQ,EAAE,IAAI,CADY;QAE1BC,QAAQ,EAAE,IAAI,EAFY;QAG1BC,UAAU,EAAEuJ,cAHc;QAI1BtJ,QAAQ,EAAE,QAJgB;QAK1BC,aAAa,EAAE,GALW;QAM1BC,aAAa,EAAE,KANW;QAO1BC,WAAW,EAAE,IAAI,CAPS;QAQ1BC,WAAW,EAAE,IAAI,EARS;QAS1BC,QAAQ,EAAE,IATgB;QAU1BC,OAAO,EAAE;MAViB,CAA5B;MAYA,KAAK3C,MAAL,CAAY8L,gBAAZ,CAA6BD,qBAA7B;MACA,KAAKzK,YAAL;IACD;EAtBA,CAziB8B,EAgkB9B;IACD3G,GAAG,EAAE,YADJ;IAEDxB,KAAK,EAAE,SAAS4I,UAAT,CAAoBkK,QAApB,EAA8B;MACnC,IAAIC,OAAO,GAAGD,QAAd;;MAEA,IAAIC,OAAO,KAAK3P,SAAhB,EAA2B;QACzB2P,OAAO,GAAG,KAAKvL,KAAL,CAAWK,WAAX,KAA2B,MAA3B,GAAoC,OAApC,GAA8C,MAAxD;MACD;;MAED,IAAIkL,OAAO,KAAK,OAAhB,EAAyB;QACvB,KAAK1I,QAAL,CAAc;UACZxC,WAAW,EAAEkL,OADD;UAEZC,eAAe,EAAE;QAFL,CAAd;MAID,CALD,MAKO;QACLrI,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBmI,OAApB;QACA,KAAK1I,QAAL,CAAc;UACZxC,WAAW,EAAEkL;QADD,CAAd;MAGD;;MAED,KAAK5K,YAAL;IACD;EAtBA,CAhkB8B,EAulB9B;IACD3G,GAAG,EAAE,mBADJ;IAEDxB,KAAK,EAAE,SAAS6I,iBAAT,CAA2BoB,KAA3B,EAAkC;MACvC,KAAKI,QAAL,CAAc;QACZ2I,eAAe,EAAE,KAAKxL,KAAL,CAAWK,WAAX,KAA2B;MADhC,CAAd;IAGD;EANA,CAvlB8B,EA8lB9B;IACDrG,GAAG,EAAE,WADJ;IAEDxB,KAAK,EAAE,SAAS8I,SAAT,GAAqB;MAC1B,IAAIc,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCoJ,WAAlC,IAAiD,GAAjD,IAAwD,CAAC,KAAKnM,cAAlE,EAAkF;QAChF,KAAK8B,UAAL,CAAgB,MAAhB;QACA,KAAK9B,cAAL,GAAsB,IAAtB;MACD;;MAED,IAAI8C,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCoJ,WAAlC,GAAgD,GAAhD,IAAuD,KAAKnM,cAAhE,EAAgF;QAC9E,KAAKA,cAAL,GAAsB,KAAtB;MACD;IACF;EAXA,CA9lB8B,EA0mB9B;IACDtF,GAAG,EAAE,QADJ;IAEDxB,KAAK,EAAE,SAASkT,MAAT,GAAkB;MACvB,IAAIzL,WAAW,GAAG,KAAKD,KAAL,CAAWC,WAA7B;MACA,IAAIvB,SAAS,GAAG,KAAKsB,KAAL,CAAWtB,SAA3B;MACA,IAAI2B,WAAW,GAAG;QAChBkL,OAAO,EAAE,KAAKvL,KAAL,CAAWK;MADJ,CAAlB;MAGA,OAAO,aAAa5H,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC,KAAhC,EAAuC;QACzDC,SAAS,EAAE,WAD8C;QAEzDC,EAAE,EAAE;MAFqD,CAAvC,EAGjB,aAAapT,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgCvS,iBAAiB,CAAC,SAAD,CAAjD,EAA8D;QAC5E0S,SAAS,EAAE7L,WADiE;QAE5EP,IAAI,EAAEhB,SAFsE;QAG5EqN,gBAAgB,EAAE,KAAK/L,KAAL,CAAWwL,eAH+C;QAI5E5K,gBAAgB,EAAE,KAAKA,gBAJqD;QAK5EC,gBAAgB,EAAE,KAAKA,gBALqD;QAM5EI,WAAW,EAAE,KAAKA,WAN0D;QAO5EC,eAAe,EAAE,KAAKA,eAPsD;QAQ5EH,gBAAgB,EAAE,KAAKA,gBARqD;QAS5EC,YAAY,EAAE,KAAKA,YATyD;QAU5EP,YAAY,EAAE,KAAKA,YAVyD;QAW5EW,UAAU,EAAE,KAAKA;MAX2D,CAA9D,CAHI,EAehB,aAAa3I,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC3S,gBAAgB,CAAC,SAAD,CAAhD,EAA6D;QAC5EgT,UAAU,EAAE,KAAKhM,KAAL,CAAWgL,mBADqD;QAE5EiB,aAAa,EAAE,KAAK9K;MAFwD,CAA7D,CAfG,EAkBhB,aAAa1I,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC,KAAhC,EAAuC;QACtDE,EAAE,EAAE,QADkD;QAEtDD,SAAS,EAAE;MAF2C,CAAvC,EAGdlN,SAAS,KAAK9C,SAAd,IAA2B8C,SAAS,CAAC+H,gBAAV,OAAiC7K,SAA5D,IAAyE,aAAanD,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC,KAAhC,EAAuC;QAC9HC,SAAS,EAAE,mCADmH;QAE9HC,EAAE,EAAE;MAF0H,CAAvC,EAGtF,aAAapT,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC5S,gBAAgB,CAAC,SAAD,CAAhD,EAA6D;QAC3E2G,IAAI,EAAEhB,SADqE;QAE3EwN,cAAc,EAAE,KAAKpL;MAFsD,CAA7D,CAHyE,CAHxE,EASZ,KAAKd,KAAL,CAAWI,WAAX,CAAuB+L,GAAvB,CAA2B,UAAUC,GAAV,EAAehQ,CAAf,EAAkB;QAChD,OAAO,aAAa3D,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC,KAAhC,EAAuC;UACzD3R,GAAG,EAAEoC,CADoD;UAEzDwP,SAAS,EAAE,mCAF8C;UAGzDC,EAAE,EAAE;QAHqD,CAAvC,EAIjB,aAAapT,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC5S,gBAAgB,CAAC,SAAD,CAAhD,EAA6D;UAC3E2G,IAAI,EAAE0M,GADqE;UAE3EC,QAAQ,EAAED,GAAG,CAACE,aAAJ,CAAkB9E,MAAlB,CAAyB6E;QAFwC,CAA7D,CAJI,CAApB;MAQD,CATI,CATY,EAkBb3N,SAAS,KAAK9C,SAAd,IAA2B8C,SAAS,CAAC+H,gBAAV,OAAiC7K,SAA5D,IAAyE,aAAanD,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC,KAAhC,EAAuC;QAC/HC,SAAS,EAAE,mCADoH;QAE/HW,KAAK,EAAElM;MAFwH,CAAvC,EAGvF,aAAa5H,MAAM,CAAC,SAAD,CAAN,CAAkBkT,aAAlB,CAAgC1S,cAAc,CAAC,SAAD,CAA9C,EAA2D;QACzEyG,IAAI,EAAEhB,SADmE;QAEzE2B,WAAW,EAAE,KAAKL,KAAL,CAAWK,WAFiD;QAGzEmM,KAAK,EAAE,KAAKpL,UAH6D;QAIzEoK,eAAe,EAAE,KAAKnK;MAJmD,CAA3D,CAH0E,CAlBzE,CAlBG,CAApB;IA6CD;IACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAhEK,CA1mB8B,EA4qB9B;IACDrH,GAAG,EAAE,UADJ;IAEDxB,KAAK,EAAE,SAAS8K,QAAT,GAAoB;MACzB,IAAImJ,OAAO,GAAG,IAAd;;MAEA,OAAO,KAAKC,aAAL,CAAmB,KAAK1M,KAAL,CAAWC,WAA9B,EAA2C7E,IAA3C,CAAgD,UAAU0Q,SAAV,EAAqB;QAC1E,OAAOW,OAAO,CAACE,WAAR,CAAoBb,SAApB,CAAP;MACD,CAFM,CAAP;IAGD;EARA,CA5qB8B,EAqrB9B;IACD9R,GAAG,EAAE,eADJ;IAEDxB,KAAK,EAAE,SAASkU,aAAT,CAAuBZ,SAAvB,EAAkC;MACvC,IAAIc,OAAO,GAAG,IAAd;;MAEA,OAAO,IAAIzR,OAAJ,CAAY,UAAUR,OAAV,EAAmBC,MAAnB,EAA2B;QAC5C,IAAIwN,IAAI,GAAGE,IAAI,CAACY,SAAL,CAAe;UACxB2D,eAAe,EAAEf;QADO,CAAf,CAAX;;QAIAlT,MAAM,CAAC,SAAD,CAAN,CAAkBkU,IAAlB,CAAuBF,OAAO,CAAC7N,mBAAR,GAA8B,wBAArD,EAA+EqJ,IAA/E,EAAqF;UACnF2E,OAAO,EAAE;YACPC,aAAa,EAAE,WAAWC,IAAI,CAAC,iBAAiBL,OAAO,CAACxN,sBAA1B,CADvB;YAEP,gBAAgB;UAFT;QAD0E,CAArF,EAKGhE,IALH,CAKQ,UAAU8R,QAAV,EAAoB;UAC1B/J,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6B8J,QAA7B;UACAvS,OAAO,CAACuS,QAAQ,CAAC9E,IAAT,CAAcyD,EAAf,CAAP;QACD,CARD,EAQG,OARH,EAQY,UAAUqB,QAAV,EAAoB;UAC9B,IAAIjS,KAAK,GAAG5C,MAAM,CAAC8U,MAAP,CAAc,EAAd,EAAkBD,QAAlB,CAAZ;;UAEA,IAAIjS,KAAK,CAACiS,QAAN,IAAkBjS,KAAK,CAACiS,QAAN,CAAexJ,MAAf,KAA0B,GAAhD,EAAqD;YACnD/I,OAAO,CAACmR,SAAD,CAAP;UACD,CAFD,MAEO;YACL3I,OAAO,CAACC,GAAR,CAAYnI,KAAZ;YACAkI,OAAO,CAACiK,IAAR,CAAa,0EAA0ER,OAAO,CAAC7N,mBAA/F;;YAEA,IAAIE,MAAM,CAACoO,OAAP,CAAe,2EAA2ET,OAAO,CAAC7N,mBAAnF,GAAyG,2CAAzG,GAAuJ,iGAAvJ,GAA2P6N,OAAO,CAAC7N,mBAAnQ,GAAyR,GAAxS,CAAJ,EAAkT;cAChTE,MAAM,CAACC,QAAP,CAAgBiO,MAAhB,CAAuBP,OAAO,CAAC7N,mBAAR,GAA8B,qBAArD;YACD;UACF;QACF,CArBD;MAsBD,CA3BM,CAAP;IA4BD;EAjCA,CArrB8B,EAutB9B;IACD/E,GAAG,EAAE,aADJ;IAEDxB,KAAK,EAAE,SAASmU,WAAT,CAAqBb,SAArB,EAAgC;MACrC,IAAIwB,OAAO,GAAG,IAAd;;MAEA,OAAO,IAAInS,OAAJ,CAAY,UAAUR,OAAV,EAAmBC,MAAnB,EAA2B;QAC5C,IAAIwN,IAAI,GAAGE,IAAI,CAACY,SAAL,CAAe,EAAf,CAAX;;QAEAtQ,MAAM,CAAC,SAAD,CAAN,CAAkBkU,IAAlB,CAAuBQ,OAAO,CAACvO,mBAAR,GAA8B,yBAA9B,GAA0D+M,SAA1D,GAAsE,aAA7F,EAA4G1D,IAA5G,EAAkH;UAChH2E,OAAO,EAAE;YACPC,aAAa,EAAE,WAAWC,IAAI,CAAC,iBAAiBK,OAAO,CAAClO,sBAA1B,CADvB;YAEP,gBAAgB;UAFT;QADuG,CAAlH,EAKGhE,IALH,CAKQ,UAAU8R,QAAV,EAAoB;UAC1B/J,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB8J,QAArB;UACAvS,OAAO,CAACuS,QAAQ,CAAC9E,IAAT,CAAclF,KAAf,CAAP;QACD,CARD,EAQG,OARH,EAQY,UAAUjI,KAAV,EAAiB;UAC3B,OAAOL,MAAM,CAACK,KAAD,CAAb;QACD,CAVD;MAWD,CAdM,CAAP;IAeD;EApBA,CAvtB8B,CAArB,CAAZ;;EA8uBA,OAAO0D,kBAAP;AACD,CA7xBqC,CA6xBpClG,MAAM,CAAC8U,SA7xB6B,CAAtC;;AA+xBA,IAAIC,QAAQ,GAAG7O,kBAAf;AACApG,OAAO,CAAC,SAAD,CAAP,GAAqBiV,QAArB"},"metadata":{},"sourceType":"script"}