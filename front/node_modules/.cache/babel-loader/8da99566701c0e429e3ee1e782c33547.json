{"ast":null,"code":"var _jsxFileName = \"C:\\\\SSAFY\\\\2nd semester\\\\S07P12D106\\\\front\\\\src\\\\components\\\\GameRoomPageCom\\\\AllCam.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { OpenVidu } from \"openvidu-browser\";\nimport axios from \"axios\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../../redux/slice/UserSlice\";\nimport { Grid } from \"@mui/material\";\nimport UserVideoComponent from \"./UserVideoComponent\"; //게임 방 번호 가져옴\n// import {} from \"../../redux/slice/\";\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AllCam() {\n  _s();\n\n  let OV, session, mySession;\n  let ovToken; // const roomNum = useSelector((state) => state.roomNum).roomNum;\n\n  const roomNum = 125;\n  const currentUser = useSelector(selectUser);\n  console.log(\"currentUser: \", currentUser);\n  const [subscribers, setSubscribers] = useState([]);\n  const [currentVideoDevice, setCurrentVideoDevice] = useState();\n  const [mainStreamManager, setMainStreamManager] = useState();\n  const [publisher, setPublisher] = useState(); // let publisher;\n\n  useEffect(() => {\n    window.addEventListener(\"beforeunload\", onbeforeunload);\n    return () => {\n      window.removeEventListener(\"beforeunload\", onbeforeunload);\n    };\n  }, []);\n\n  const onbeforeunload = event => {\n    leaveSession();\n  }; //메인 비디오 컨트롤\n  // const handleMainVideoStream = (stream) => {\n  //   if (mainStreamManager !== stream) {\n  //     mainStreamManager = stream;\n  //   }\n  // };\n\n\n  const deleteSubscriber = streamManager => {\n    let index = subscribers.indexOf(streamManager, 0);\n\n    if (index > -1) {\n      setSubscribers([...subscribers].splice(index, 1));\n    }\n  };\n\n  const joinSession = async () => {\n    OV = new OpenVidu();\n    session = OV.initSession();\n    mySession = session;\n    mySession.on(\"streamCreated\", event => {\n      // Subscribe to the Stream to receive it. Second parameter is undefined\n      // so OpenVidu doesn't create an HTML video by its own\n      var tmpSubscriber = mySession.subscribe(event.stream, undefined); // Update the state with the new subscribers\n\n      setSubscribers([...subscribers, tmpSubscriber]);\n    });\n    mySession.on(\"streamDestroyed\", event => {\n      // Remove the stream from 'subscribers' array\n      deleteSubscriber(event.stream.streamManager);\n    }); // On every asynchronous exception...\n\n    mySession.on(\"exception\", exception => {\n      console.warn(exception);\n    });\n    await axios({\n      url: `/api/room/${roomNum}/video-token`,\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${currentUser.accessToken}`\n      }\n    }).then(_ref => {\n      let {\n        data\n      } = _ref;\n      console.log(\"data: \" + data);\n      ovToken = data;\n    }).catch(err => {\n      console.log(\"get ovToken fail: \", err);\n    });\n    await mySession.connect(ovToken, {\n      clientData: currentUser.nickname\n    }).then(async () => {\n      console.log(\"success connect\");\n      var devices = await OV.getDevices();\n      console.log(devices);\n      var videoDevices = devices.filter(device => device.kind === \"videoinput\");\n      console.log(\"videoDevices: \", videoDevices); // --- 5) Get your own camera stream ---\n      // Init a publisher passing undefined as targetElement (we don't want OpenVidu to insert a video\n      // element: we will manage it on our own) and with the desired properties\n\n      let tmpPublisher = OV.initPublisher(undefined, {\n        audioSource: undefined,\n        // The source of audio. If undefined default microphone\n        videoSource: videoDevices[0].deviceId,\n        // The source of video. If undefined default webcam\n        publishAudio: true,\n        // Whether you want to start publishing with your audio unmuted or not\n        publishVideo: true,\n        // Whether you want to start publishing with your video enabled or not\n        resolution: \"640x480\",\n        // The resolution of your video\n        frameRate: 30,\n        // The frame rate of your video\n        insertMode: \"APPEND\",\n        // How the video is inserted in the target element 'video-container'\n        mirror: false // Whether to mirror your local video or not\n\n      });\n      console.log(\"tmpPublisher: \", tmpPublisher); // --- 6) Publish your stream ---\n\n      mySession.publish(tmpPublisher); // Set the main video in the page to display our webcam and store our Publisher\n\n      setCurrentVideoDevice(videoDevices[0]);\n      setMainStreamManager(tmpPublisher);\n      setPublisher(tmpPublisher);\n    }).catch(error => {\n      console.log(\"There was an error connecting to the session:\", error.code, error.message);\n    });\n  };\n\n  const leaveSession = () => {\n    if (mySession) mySession.disconnect();\n    OV = null;\n    session = undefined;\n    subscribers = [];\n    setMainStreamManager(undefined);\n    setPublisher(undefined); // publisher = undefined;\n  };\n\n  const switchCamera = async () => {\n    try {\n      const devices = await OV.getDevices();\n      var videoDevices = devices.filter(device => device.kind === \"videoinput\");\n\n      if (videoDevices && videoDevices.length > 1) {\n        var newVideoDevice = videoDevices.filter(device => device.deviceId !== currentVideoDevice.deviceId);\n\n        if (newVideoDevice.length > 0) {\n          // Creating a new publisher with specific videoSource\n          // In mobile devices the default and first camera is the front one\n          var newPublisher = OV.initPublisher(undefined, {\n            videoSource: newVideoDevice[0].deviceId,\n            publishAudio: true,\n            publishVideo: true,\n            mirror: true\n          }); //newPublisher.once(\"accessAllowed\", () => {\n\n          await session.unpublish(mainStreamManager);\n          await session.publish(newPublisher);\n          currentVideoDevice = newVideoDevice;\n          mainStreamManager = newPublisher;\n          publisher = newPublisher;\n        }\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => {\n        joinSession();\n      },\n      children: \"\\uC138\\uC158 \\uC811\\uC18D\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      style: {\n        height: 500\n      },\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 4,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          children: publisher !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: publisher\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 40\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          children: subscribers[2] !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: subscribers[2]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          children: subscribers[4] !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: subscribers[4]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 4,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          children: subscribers[0] !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: subscribers[0]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          children: \"empty\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          children: subscribers[5] !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: subscribers[5]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 4,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          children: subscribers[1] !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: subscribers[1]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          children: subscribers[3] !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: subscribers[3]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          children: subscribers[6] !== undefined ? /*#__PURE__*/_jsxDEV(UserVideoComponent, {\n            streamManager: subscribers[6]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AllCam, \"YKQwJ0/t5UJE9E9N6RnjrGTTzjA=\", false, function () {\n  return [useSelector];\n});\n\n_c = AllCam;\n\nvar _c;\n\n$RefreshReg$(_c, \"AllCam\");","map":{"version":3,"names":["React","useEffect","useState","OpenVidu","axios","useSelector","selectUser","Grid","UserVideoComponent","AllCam","OV","session","mySession","ovToken","roomNum","currentUser","console","log","subscribers","setSubscribers","currentVideoDevice","setCurrentVideoDevice","mainStreamManager","setMainStreamManager","publisher","setPublisher","window","addEventListener","onbeforeunload","removeEventListener","event","leaveSession","deleteSubscriber","streamManager","index","indexOf","splice","joinSession","initSession","on","tmpSubscriber","subscribe","stream","undefined","exception","warn","url","method","headers","Authorization","accessToken","then","data","catch","err","connect","clientData","nickname","devices","getDevices","videoDevices","filter","device","kind","tmpPublisher","initPublisher","audioSource","videoSource","deviceId","publishAudio","publishVideo","resolution","frameRate","insertMode","mirror","publish","error","code","message","disconnect","switchCamera","length","newVideoDevice","newPublisher","unpublish","e","height"],"sources":["C:/SSAFY/2nd semester/S07P12D106/front/src/components/GameRoomPageCom/AllCam.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { OpenVidu } from \"openvidu-browser\";\r\nimport axios from \"axios\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectUser } from \"../../redux/slice/UserSlice\";\r\nimport { Grid } from \"@mui/material\";\r\nimport UserVideoComponent from \"./UserVideoComponent\";\r\n\r\n//게임 방 번호 가져옴\r\n// import {} from \"../../redux/slice/\";\r\n\r\nexport default function AllCam() {\r\n  let OV, session, mySession;\r\n  let ovToken;\r\n  // const roomNum = useSelector((state) => state.roomNum).roomNum;\r\n  const roomNum = 125;\r\n  const currentUser = useSelector(selectUser);\r\n  console.log(\"currentUser: \", currentUser);\r\n\r\n  const [subscribers, setSubscribers] = useState([]);\r\n  const [currentVideoDevice, setCurrentVideoDevice] = useState();\r\n  const [mainStreamManager, setMainStreamManager] = useState();\r\n  const [publisher, setPublisher] = useState();\r\n  // let publisher;\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"beforeunload\", onbeforeunload);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"beforeunload\", onbeforeunload);\r\n    };\r\n  }, []);\r\n\r\n  const onbeforeunload = (event) => {\r\n    leaveSession();\r\n  };\r\n\r\n  //메인 비디오 컨트롤\r\n  // const handleMainVideoStream = (stream) => {\r\n  //   if (mainStreamManager !== stream) {\r\n  //     mainStreamManager = stream;\r\n  //   }\r\n  // };\r\n\r\n  const deleteSubscriber = (streamManager) => {\r\n    let index = subscribers.indexOf(streamManager, 0);\r\n    if (index > -1) {\r\n      setSubscribers([...subscribers].splice(index, 1));\r\n    }\r\n  };\r\n\r\n  const joinSession = async () => {\r\n    OV = new OpenVidu();\r\n    session = OV.initSession();\r\n    mySession = session;\r\n\r\n    mySession.on(\"streamCreated\", (event) => {\r\n      // Subscribe to the Stream to receive it. Second parameter is undefined\r\n      // so OpenVidu doesn't create an HTML video by its own\r\n      var tmpSubscriber = mySession.subscribe(event.stream, undefined);\r\n\r\n      // Update the state with the new subscribers\r\n      setSubscribers([...subscribers, tmpSubscriber]);\r\n    });\r\n\r\n    mySession.on(\"streamDestroyed\", (event) => {\r\n      // Remove the stream from 'subscribers' array\r\n      deleteSubscriber(event.stream.streamManager);\r\n    });\r\n\r\n    // On every asynchronous exception...\r\n    mySession.on(\"exception\", (exception) => {\r\n      console.warn(exception);\r\n    });\r\n\r\n    await axios({\r\n      url: `/api/room/${roomNum}/video-token`,\r\n      method: \"get\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${currentUser.accessToken}`,\r\n      },\r\n    })\r\n      .then(({ data }) => {\r\n        console.log(\"data: \" + data);\r\n        ovToken = data;\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"get ovToken fail: \", err);\r\n      });\r\n\r\n    await mySession\r\n      .connect(ovToken, { clientData: currentUser.nickname })\r\n      .then(async () => {\r\n        console.log(\"success connect\");\r\n        var devices = await OV.getDevices();\r\n        console.log(devices);\r\n        var videoDevices = devices.filter((device) => device.kind === \"videoinput\");\r\n        console.log(\"videoDevices: \", videoDevices);\r\n        // --- 5) Get your own camera stream ---\r\n\r\n        // Init a publisher passing undefined as targetElement (we don't want OpenVidu to insert a video\r\n        // element: we will manage it on our own) and with the desired properties\r\n\r\n        let tmpPublisher = OV.initPublisher(undefined, {\r\n          audioSource: undefined, // The source of audio. If undefined default microphone\r\n          videoSource: videoDevices[0].deviceId, // The source of video. If undefined default webcam\r\n          publishAudio: true, // Whether you want to start publishing with your audio unmuted or not\r\n          publishVideo: true, // Whether you want to start publishing with your video enabled or not\r\n          resolution: \"640x480\", // The resolution of your video\r\n          frameRate: 30, // The frame rate of your video\r\n          insertMode: \"APPEND\", // How the video is inserted in the target element 'video-container'\r\n          mirror: false, // Whether to mirror your local video or not\r\n        });\r\n\r\n        console.log(\"tmpPublisher: \", tmpPublisher);\r\n        // --- 6) Publish your stream ---\r\n        mySession.publish(tmpPublisher);\r\n\r\n        // Set the main video in the page to display our webcam and store our Publisher\r\n\r\n        setCurrentVideoDevice(videoDevices[0]);\r\n        setMainStreamManager(tmpPublisher);\r\n        setPublisher(tmpPublisher);\r\n      })\r\n      .catch((error) => {\r\n        console.log(\"There was an error connecting to the session:\", error.code, error.message);\r\n      });\r\n  };\r\n\r\n  const leaveSession = () => {\r\n    if (mySession) mySession.disconnect();\r\n\r\n    OV = null;\r\n    session = undefined;\r\n    subscribers = [];\r\n    setMainStreamManager(undefined);\r\n    setPublisher(undefined);\r\n    // publisher = undefined;\r\n  };\r\n\r\n  const switchCamera = async () => {\r\n    try {\r\n      const devices = await OV.getDevices();\r\n      var videoDevices = devices.filter((device) => device.kind === \"videoinput\");\r\n\r\n      if (videoDevices && videoDevices.length > 1) {\r\n        var newVideoDevice = videoDevices.filter(\r\n          (device) => device.deviceId !== currentVideoDevice.deviceId\r\n        );\r\n\r\n        if (newVideoDevice.length > 0) {\r\n          // Creating a new publisher with specific videoSource\r\n          // In mobile devices the default and first camera is the front one\r\n          var newPublisher = OV.initPublisher(undefined, {\r\n            videoSource: newVideoDevice[0].deviceId,\r\n            publishAudio: true,\r\n            publishVideo: true,\r\n            mirror: true,\r\n          });\r\n\r\n          //newPublisher.once(\"accessAllowed\", () => {\r\n          await session.unpublish(mainStreamManager);\r\n\r\n          await session.publish(newPublisher);\r\n          currentVideoDevice = newVideoDevice;\r\n          mainStreamManager = newPublisher;\r\n          publisher = newPublisher;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button\r\n        onClick={() => {\r\n          joinSession();\r\n        }}\r\n      >\r\n        세션 접속\r\n      </button>\r\n\r\n      <Grid container spacing={2} style={{ height: 500 }}>\r\n        <Grid item xs={4}>\r\n          <Grid>\r\n            {/* 1번 자리 내 캠 */}\r\n            {publisher !== undefined ? <UserVideoComponent streamManager={publisher} /> : null}\r\n          </Grid>\r\n          <Grid>\r\n            {subscribers[2] !== undefined ? (\r\n              <UserVideoComponent streamManager={subscribers[2]} />\r\n            ) : null}\r\n          </Grid>\r\n          <Grid>\r\n            {subscribers[4] !== undefined ? (\r\n              <UserVideoComponent streamManager={subscribers[4]} />\r\n            ) : null}\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <Grid>\r\n            {subscribers[0] !== undefined ? (\r\n              <UserVideoComponent streamManager={subscribers[0]} />\r\n            ) : null}\r\n          </Grid>\r\n          <Grid>empty</Grid>\r\n          <Grid>\r\n            {subscribers[5] !== undefined ? (\r\n              <UserVideoComponent streamManager={subscribers[5]} />\r\n            ) : null}\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <Grid>\r\n            {subscribers[1] !== undefined ? (\r\n              <UserVideoComponent streamManager={subscribers[1]} />\r\n            ) : null}\r\n          </Grid>\r\n          <Grid>\r\n            {subscribers[3] !== undefined ? (\r\n              <UserVideoComponent streamManager={subscribers[3]} />\r\n            ) : null}\r\n          </Grid>\r\n          <Grid>\r\n            {subscribers[6] !== undefined ? (\r\n              <UserVideoComponent streamManager={subscribers[6]} />\r\n            ) : null}\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}